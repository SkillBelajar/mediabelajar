{"version":3,"sources":["../../node_modules/core-js/internals/global.js","../../node_modules/core-js/internals/fails.js","../../node_modules/core-js/internals/descriptors.js","../../node_modules/core-js/internals/object-property-is-enumerable.js","../../node_modules/core-js/internals/create-property-descriptor.js","../../node_modules/core-js/internals/classof-raw.js","../../node_modules/core-js/internals/indexed-object.js","../../node_modules/core-js/internals/require-object-coercible.js","../../node_modules/core-js/internals/to-indexed-object.js","../../node_modules/core-js/internals/is-object.js","../../node_modules/core-js/internals/to-primitive.js","../../node_modules/core-js/internals/has.js","../../node_modules/core-js/internals/document-create-element.js","../../node_modules/core-js/internals/ie8-dom-define.js","../../node_modules/core-js/internals/object-get-own-property-descriptor.js","../../node_modules/core-js/internals/an-object.js","../../node_modules/core-js/internals/object-define-property.js","../../node_modules/core-js/internals/create-non-enumerable-property.js","../../node_modules/core-js/internals/set-global.js","../../node_modules/core-js/internals/shared-store.js","../../node_modules/core-js/internals/inspect-source.js","../../node_modules/core-js/internals/internal-state.js","../../node_modules/core-js/internals/native-weak-map.js","../../node_modules/core-js/internals/shared.js","../../node_modules/core-js/internals/uid.js","../../node_modules/core-js/internals/shared-key.js","../../node_modules/core-js/internals/hidden-keys.js","../../node_modules/core-js/internals/object-create.js","../../node_modules/core-js/internals/redefine.js","../../node_modules/core-js/internals/path.js","../../node_modules/core-js/internals/get-built-in.js","../../node_modules/core-js/internals/to-integer.js","../../node_modules/core-js/internals/to-length.js","../../node_modules/core-js/internals/to-absolute-index.js","../../node_modules/core-js/internals/array-includes.js","../../node_modules/core-js/internals/object-keys-internal.js","../../node_modules/core-js/internals/enum-bug-keys.js","../../node_modules/core-js/internals/object-get-own-property-names.js","../../node_modules/core-js/internals/object-get-own-property-symbols.js","../../node_modules/core-js/internals/own-keys.js","../../node_modules/core-js/internals/copy-constructor-properties.js","../../node_modules/core-js/internals/is-forced.js","../../node_modules/core-js/internals/export.js","../../node_modules/core-js/internals/native-symbol.js","../../node_modules/core-js/internals/use-symbol-as-uid.js","../../node_modules/core-js/internals/well-known-symbol.js","../../node_modules/core-js/internals/object-keys.js","../../node_modules/core-js/internals/object-define-properties.js","../../node_modules/core-js/internals/html.js","../../node_modules/core-js/internals/add-to-unscopables.js","../../node_modules/core-js/internals/array-method-uses-to-length.js","../../node_modules/core-js/modules/es.array.includes.js","../../node_modules/core-js/internals/to-object.js","../../node_modules/core-js/internals/object-assign.js","../../node_modules/core-js/modules/es.object.assign.js","../../node_modules/core-js/internals/is-regexp.js","../../node_modules/core-js/modules/es.string.ends-with.js","../../node_modules/core-js/internals/not-a-regexp.js","../../node_modules/core-js/internals/correct-is-regexp-logic.js","../../node_modules/core-js/modules/es.string.includes.js","../../node_modules/core-js/modules/es.string.starts-with.js","../../build/js/FormData.js","../../build/js/autosuggest.js","../../build/js/form.js","../../build/js/functions.js","../../build/js/httpform.js","../../build/js/main.js","../../build/js/multipage.js","../../build/js/jquery.js","../../build/js/fields.js","../../build/js/adminlte.js"],"names":["check","it","Math","global_1","globalThis","window","self","global","Function","fails","exec","error","descriptors","Object","defineProperty","get","nativePropertyIsEnumerable","propertyIsEnumerable","getOwnPropertyDescriptor","call","1","V","descriptor","this","enumerable","createPropertyDescriptor","bitmap","value","configurable","writable","toString","classofRaw","slice","split","indexedObject","classof","requireObjectCoercible","undefined","TypeError","toIndexedObject","IndexedObject","isObject","toPrimitive","input","PREFERRED_STRING","fn","val","valueOf","hasOwnProperty","has","key","document","EXISTS","createElement","documentCreateElement","ie8DomDefine","DESCRIPTORS","a","nativeGetOwnPropertyDescriptor","O","P","IE8_DOM_DEFINE","propertyIsEnumerableModule","f","anObject","String","nativeDefineProperty","Attributes","createNonEnumerableProperty","object","definePropertyModule","setGlobal","sharedStore","functionToString","store","inspectSource","set","WeakMap","nativeWeakMap","test","module","exports","push","version","mode","copyright","id","postfix","random","uid","keys","shared","sharedKey","hiddenKeys","NATIVE_WEAK_MAP","wmget","wmhas","wmset","metadata","STATE","objectHas","activeXDocument","internalState","enforce","getterFor","TYPE","state","type","getInternalState","InternalStateModule","enforceInternalState","TEMPLATE","options","unsafe","simple","noTargetGet","source","join","prototype","path","aFunction","variable","getBuiltIn","namespace","method","arguments","length","ceil","floor","toInteger","argument","isNaN","min","toLength","max","createMethod","IS_INCLUDES","$this","el","fromIndex","index","integer","toAbsoluteIndex","arrayIncludes","includes","indexOf","require$$0","objectKeysInternal","names","i","result","enumBugKeys","concat","getOwnPropertyNames","internalObjectKeys","getOwnPropertySymbols","ownKeys","getOwnPropertyNamesModule","getOwnPropertySymbolsModule","copyConstructorProperties","target","getOwnPropertyDescriptorModule","replacement","isForced","feature","detection","data","normalize","POLYFILL","NATIVE","string","replace","toLowerCase","isForced_1","_export","targetProperty","sourceProperty","TARGET","GLOBAL","STATIC","stat","forced","sham","redefine","nativeSymbol","Symbol","useSymbolAsUid","NATIVE_SYMBOL","iterator","WellKnownSymbolsStore","createWellKnownSymbol","USE_SYMBOL_AS_UID","withoutSetter","wellKnownSymbol","name","objectKeys","objectDefineProperties","defineProperties","Properties","html","IE_PROTO","EmptyConstructor","scriptTag","content","LT","NullProtoObject","domain","ActiveXObject","iframeDocument","iframe","write","close","temp","parentWindow","NullProtoObjectViaActiveX","style","display","appendChild","src","contentWindow","open","F","objectCreate","create","UNSCOPABLES","ArrayPrototype","Array","cache","thrower","$includes","$","proto","METHOD_NAME","ACCESSORS","argument0","argument1","arrayMethodUsesToLength","toObject","nativeAssign","assign","objectAssign","b","A","B","symbol","forEach","chr","T","argumentsLength","S","j","MATCH","notARegexp","isRegExp","correctIsRegexpLogic","regexp","e","nativeEndsWith","endsWith","CORRECT_IS_REGEXP_LOGIC","correctIsRegExpLogic","searchString","that","notARegExp","endPosition","len","end","search","nativeStartsWith","startsWith","Blob","FormData","normalizeValue","_ref","filename","File","lastModified","ensureArgs","args","expected","normalizeArgs","each","arr","cb","_FormData","_send","XMLHttpRequest","send","_fetch","Request","fetch","_sendBeacon","navigator","sendBeacon","stringTag","toStringTag","d","c","blob","t","Date","lastModifiedDate","FormDataPolyfill","form","_data","elements","elm","disabled","files","file","append","opt","selected","checked","normalizeLinefeeds","_proto","_normalizeArgs$apply","apply","map","delete","entries","regeneratorRuntime","mark","_iterator","_step","wrap","_context","prev","next","t0","t1","done","_createForOfIteratorHelperLoose","stop","callback","thisArg","_step2","_iterator2","_step2$value","getAll","_iterator3","_step3","_step3$value","_context2","values","_iterator4","_step4","_step4$value","_context3","_step5","fd","_iterator5","_step5$value","_step6","boundary","chunks","_iterator6","_step6$value","setRequestHeader","_hasContentType","init","body","url","AutoSuggest","settings","$input","$element","elValue","frm","forceSelection","forceSelect","re","m","match","nid","rowindex","oEmpty","typeahead","getElement","elInput","tpl","elParent","lists","parentFields","minWidth","maxHeight","highlight","hint","minLength","limit","templates","trigger","delay","element","_options","_recordCount","lbl","formatResult","ar","ew","displayValue","setValue","v","item","attr","language","phrase","addClass","change","generateRequest","ajax","LANGUAGE_ID","getUserParams","arp","getOptionValues","MULTIPLE_OPTION_SEPARATOR","prepare","query","start","dataType","params","URLSearchParams","q","n","rnd","isNumber","getApiUrl","API_LOOKUP_ACTION","transform","results","totalRecordCount","records","lf","df1","df2","df3","df4","syncResults","asyncResults","count","menu","$node","find","more","$body","css","ta","dataset","datasets","_append","scrollTop","$lastSuggestion","outerHeight","always","on","isOpen","empty","$item","getActiveSelectable","blur","focus","removeClass","template","isString","render","bind","async","timer","$more","one","cancel","setTimeout","preventDefault","stopPropagation","hide","off","$menu","$dataset","parseInt","max-height","overflow-y","Form","pageId","_form","validateRequired","validate","emptyRow","autoSuggests","disableForm","getForm","prop","enableForm","appendHidden","$form","$dp","o","appendTo","canSubmit","updateTextArea","$dps","dp","$els","submit","action","compileTemplates","list","is","closest","getElements","selector","updateLists","$rowindex$","withIndex","querySelector","confirm","removeSpinner","_fixIndex","promises","parents","isBoolean","pvalues","parent","actions","updateOptions","Promise","resolve","reject","AJAX_DELAY","shift","then","console","log","createAutoSuggest","AUTO_SUGGEST_MAX_ENTRIES","initEditors","ed","active","save","destroyEditor","destroy","onError","msg","initUpload","later","upload","setupFilters","filters","$sf","filterList","$df","toggleClass","$delete","$save","$btn","saveFilters","SEARCH_FILTER_OPTION","localStorage","JSON","stringify","currentPage","success","prevAll","remove","isArray","_prompt","$submenu","insertBefore","TOKEN_NAME_KEY","TOKEN_NAME","ANTIFORGERY_TOKEN_KEY","ANTIFORGERY_TOKEN","_initiated","IS_LOGGEDIN","IS_SYS_ADMIN","CURRENT_USER_NAME","show","collapse","isSearch","substr","CONFIRM_CANCEL","modified","click","href","hasFormData","location","addForm","_forms","currentUrl","forms","$document","_removeSpinner","$body$1","initIcons","container","add","tooltip","placement","IS_MOBILE","sanitizeFn","initPasswordOptions","MIN_PASSWORD_STRENGTH","pStrength","changeBackground","backgrounds","passwordValidFrom","onPasswordStrengthChanged","strength","percentage","$pst","width","$pb","pct","GENERATE_PASSWORD_LENGTH","passwordLength","GENERATE_PASSWORD_UPPERCASE","uppercase","GENERATE_PASSWORD_LOWERCASE","lowercase","GENERATE_PASSWORD_NUMBER","numbers","specialChars","GENERATE_PASSWORD_SPECIALCHARS","onPasswordGenerated","pwd","RELATIVE_PATH","API_URL","USE_URL_REWRITE","route","encodeURIComponent","API_ACTION_NAME","qs","initExportLinks","fileDownload","initMultiSelectCheckboxes","$el","$cbs","_update","cnt","filter","$dlg","jQuery","SHOW_EXPORT_DIALOG","modal","xhrFields","responseType","createObjectURL","cd","getResponseHeader","download","fail","response","lazyLoad","LAZY_LOAD","bundleIds","$self","bundleId","loadjs","numRetries","LAZY_LOAD_RETRIES","initLightboxes","USE_COLORBOX","lightboxSettings","title","current","previous","xhrError","imgError","colorbox","rel","initPdfObjects","EMBED_PDF","PDFObjectOptions","not","PDFObject","fallbackLink","initTooltips","parse","text","$bd","isFunction","$f","updateOptions$1","obj","parentId","isUndefined","childFields","promise","$elf","typ","elf","_updateOptions","autoFillTargetFields","autoFill","oid","getOptionValues$1","getId","fo","frmo","prefix","clearOptions","addOpt","valid","newOption","first","triggerHandler","_updateSibling","ds","page","field","isModalLookup","root","_export$1","custom","sel","fobj","_alert","keySelected","serialize","isHiddenTextArea","isAutoSuggest","alert","$obj","getAutoSuggest","$cg","select","selectAll","$row","row","$tbl","ROWTYPE_ADD","ROWTYPE_EDIT","rows","tbl","$r","r","setColor","clearDelete","$tr","siblings","addBack","clickDelete","clearSelected","force","$rows","mouseOver","mouseOut","$target","cells","last","rowSpan","div","clientHeight","offsetHeight","attach","tBodies","sw","$grid","grid","multi","hasClass","RESPONSIVE_TABLE_CLASS","USE_OVERLAY_SCROLLBARS","overlayScrollbars","sidebarScrollbarsOptions","node","parentNode","nodeType","o1","o2","lookup","multiple","getOptionTexts","trim","getContainer","lo","valueSeparator","sep","OPTION_HTML_TEMPLATE","MAX_OPTION_COUNT","optionHtml","jsRenderHelpers","option","opts","$p","renderOption","$t","cols","$tpl","contents","$clr","clone","$items","$vals","optionsHtml","$lbl","$li","$opt","$div","selectedIndex","convertToBool","vals","isAutoSelect","_ajaxStop","multiPage","lastPageSubmit","executeScript","addScript","stripScript","str","scr","removeScript","getOptions","ewjtable","unbind","className","reload","dest_array","destEl","isValue","selectOption","v0","pid","post","$tt","trig","dir","popover","wd","$tip","checkDateEx","object_value","DATE_SEPARATOR","format","arDT","sYear","sMonth","sDay","wrksep","RegExp","arD","unformatYear","checkDay","checkTime","yr","UNFORMAT_YEAR","checkYear","checkMonth","maxDay","checkRange","escapeRegExChars","DECIMAL_POINT","ts","THOUSANDS_SEP","parseFloat","max_value","min_value","checkNumber","stringToFloat","isNull","TIME_SEPARATOR","email_cnt","arEmails","checkEmail","arg","showMessage","$heading","$alert","$content","children","detach","$toast","$header","w","animation","autohide","autoHideSuccessMessage","autoHideSuccessMessageDelay","$container","toast","ajaxSend","event","jqxhr","isApi","apiUrl","allowed","URL","objUrl","hostname","API_JWT_AUTHORIZATION_HEADER","addSpinner","timer1","timer2","timer3","counter","useKeepAlive","API_SESSION_ACTION","token","keepAlive","SESSION_TIMEOUT","setTimer","SESSION_TIMEOUT_COUNTDOWN","timeoutTime","timeout","resetTimer","TIMEOUT_URL","keepAliveInterval","SESSION_KEEP_ALIVE_INTERVAL","parm","$fld","$x","$y","$fld2","$cond","hasCond","$and","$opr","$opr2","opr2","isBetween","opr","isNullOpr","isNullOpr2","hideOpr2","hasY","hideX","hideY","els","divId","tmplId","classId","exportType","class","export","enabled","querySelectorAll","subtmpl","getElementById","replaceWith","textContent","innerHTML","tmpl","PDF_STYLESHEET_FILENAME","responseText","currentPage$1","customexport","searchParams","level","idx","classname","$scr","before","after","infix","bool","oelm","fld","getvalue","nelm","fnelm","newvalue","sanitize","srcElement","currentForm","isPost","isMultiple","sameText","_submit","k","_success","_prompt$1","jquery","setFocus","$pane","ctrlKey","$cb","$lastrow","suffix","$elkeycnt","keycnt","data-rowindex","attributes","removeData","scrollHeight","rowidx","keycntname","$keyact","_delete","getAncestorBy","_submitSuccess","lnk","objName","API_OBJECT_NAME","linkField","dfs","displayFields","ffs","filterFields","pfs","lfv","txt","$lu","nv","arOpt","obj2","ar2","$div2","status","statusText","btn","API_ADD_ACTION","_fail","pf","which","nodeName","ff","showing","size","_caption","$lnk","caption","_button","parseJson","pathname","view","_always","footer","cf","ct","$data","getContent","keypress","_format","setAutoSuggest","arLinkValue","txts","useText","record","df","sort","linkValue","paging","pageSize","pageSizes","pageSizeChangeArea","pageList","selecting","selectingCheckboxes","multiselect","listAction","jtParams","recperpage","postData","serverCommunicationError","loadingMessage","spinnerClass","noDataAvailable","pagingInfo","pageSizeChangeLabel","gotoPageLabel","fields","recordsLoaded","selectedRows","selectionChanged","splice","$search","prependTo","_timer","LOOKUP_DELAY","sv","message","importDialog","$message","$progress","$msg","enableButtons","pc","updateProgress","tcnt","totalCount","showProgress","importProgress","API_PROGRESS_ACTION","API_FILE_TOKEN_NAME","importComplete","fileResults","fileResult","scnt","successCount","fcnt","failCount","showLog","failList","ecnt","session","SESSION_ID","acceptFileTypes","fileupload","API_UPLOAD_ACTION","autoUpload","formData","singleFileUploads","messages","maxFileSize","maxNumberOfFiles","minFileSize","importfiles","ok","filetoken","importFail","importFiles","hideMessage","textStatus","errorThrown","uploadProgress","total","loaded","hdr","emailDialog","checkEmails","MAX_EMAIL_RECIPIENT","hasValue","param","exportid","exportWithCharts","arUrl","redirect","pos","CSS_FLIP","getTipElement","height","outerWidth","ypos","offset","xpos","left","pageX","top","pageY","setupTable","drillDownCharts","cht","dispose","_convert","DATE_FORMAT","checkDate","checkShortDate","checkUSDate","checkShortUSDate","checkEuroDate","checkShortEuroDate","creditcard_string","doubledigit","tempdigit","checkdigit","pattern","readonly","$ft","$fn","$fa","$fs","$exts","$maxsize","$maxfilecount","$label","label","_confirmDelete","uploadUrl","API_JQUERY_UPLOAD_ACTION","table","exts","maxsize","maxfilecount","multipart","loadVideoFileTypes","loadAudioFileTypes","filesContainer","uploadTemplateId","downloadTemplateId","uploadTemplate","_uploadTemplate","downloadTemplate","_downloadTemplate","previewMaxWidth","UPLOAD_THUMBNAIL_WIDTH","previewMaxHeight","dropZone","UPLOAD_THUMBNAIL_HEIGHT","pasteZone","MULTIPLE_UPLOAD_SEPARATOR","originalEvent","fid","l","context","Event","config","separator","regex","decimal","thousandsSeparator","decimalSeparator","regexBits","isFinite","newOutput","output","decPlaces","decSep","thouSep","decIndex","toFixed","substring","charAt","makeArray","def","timesep","moment","toUpperCase","$tables","initForms","adminlte","Treeview","_jQueryInterface","$window","$rpt","mh","$card","toggleGroup","USE_JAVASCRIPT_MESSAGE","currentTarget","$i","exportId","rootPath","p","lastIndexOf","exportUrl","exp","exportCharts","charts","toBase64Image","chart_engine","stream_type","stream","parameters","API_EXPORT_CHART_ACTION","xhr","_fixLayoutHeightTimer","layout","fixLayoutHeight","HttpForm","_Form","MOBILE_DETECT","mobile","userAgent","IS_IE","MultiPage","formid","formID","pageIndex","maxPageIndex","minPageIndex","pageIndexes","$pages","$collapses","isTab","isCollapse","hideDisabledButton","hideInactivePages","lockTabs","hideTabs","showPagerTop","showPagerBottom","pagerTemplate","_show","_properties","pageShow","toggle","gotoPage","$page","eq","gotoPageByIndex","gotoPageByElement","gotoPageByElementId","togglePage","$tabs","googleMaps","google","maps","setCenter","$bodies","functions","views","debugMode","setSessionTimer","DEBUG","initPage","hash","animate","$document$1","zIndex","isDate","when","periodic","interval","setInterval","clearInterval","clearTimeout","fldvar","getAttribute","rec","extend","visible","toNumber","parseNumber","toDate","parseDate","toJsDate","_toggle","$relativeTarget","treeviewMenu","$text"],"mappings":"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","sourcesContent":["var check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line no-undef\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  check(typeof self == 'object' && self) ||\n  check(typeof global == 'object' && global) ||\n  // eslint-disable-next-line no-new-func\n  Function('return this')();\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n","var fails = require('../internals/fails');\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !fails(function () {\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n});\n","'use strict';\nvar nativePropertyIsEnumerable = {}.propertyIsEnumerable;\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !nativePropertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.github.io/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : nativePropertyIsEnumerable;\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","var fails = require('../internals/fails');\nvar classof = require('../internals/classof-raw');\n\nvar split = ''.split;\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins\n  return !Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split.call(it, '') : Object(it);\n} : Object;\n","// `RequireObjectCoercible` abstract operation\n// https://tc39.github.io/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on \" + it);\n  return it;\n};\n","// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = require('../internals/indexed-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","var isObject = require('../internals/is-object');\n\n// `ToPrimitive` abstract operation\n// https://tc39.github.io/ecma262/#sec-toprimitive\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (input, PREFERRED_STRING) {\n  if (!isObject(input)) return input;\n  var fn, val;\n  if (PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;\n  if (typeof (fn = input.valueOf) == 'function' && !isObject(val = fn.call(input))) return val;\n  if (!PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var hasOwnProperty = {}.hasOwnProperty;\n\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar createElement = require('../internals/document-create-element');\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n","var DESCRIPTORS = require('../internals/descriptors');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPrimitive = require('../internals/to-primitive');\nvar has = require('../internals/has');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\n\nvar nativeGetOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? nativeGetOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return nativeGetOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (has(O, P)) return createPropertyDescriptor(!propertyIsEnumerableModule.f.call(O, P), O[P]);\n};\n","var isObject = require('../internals/is-object');\n\nmodule.exports = function (it) {\n  if (!isObject(it)) {\n    throw TypeError(String(it) + ' is not an object');\n  } return it;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\nvar anObject = require('../internals/an-object');\nvar toPrimitive = require('../internals/to-primitive');\n\nvar nativeDefineProperty = Object.defineProperty;\n\n// `Object.defineProperty` method\n// https://tc39.github.io/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? nativeDefineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return nativeDefineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var global = require('../internals/global');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nmodule.exports = function (key, value) {\n  try {\n    createNonEnumerableProperty(global, key, value);\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n","var global = require('../internals/global');\nvar setGlobal = require('../internals/set-global');\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || setGlobal(SHARED, {});\n\nmodule.exports = store;\n","var store = require('../internals/shared-store');\n\nvar functionToString = Function.toString;\n\n// this helper broken in `3.4.1-3.4.4`, so we can't use `shared` helper\nif (typeof store.inspectSource != 'function') {\n  store.inspectSource = function (it) {\n    return functionToString.call(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n","var NATIVE_WEAK_MAP = require('../internals/native-weak-map');\nvar global = require('../internals/global');\nvar isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar objectHas = require('../internals/has');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP) {\n  var store = new WeakMap();\n  var wmget = store.get;\n  var wmhas = store.has;\n  var wmset = store.set;\n  set = function (it, metadata) {\n    wmset.call(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget.call(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas.call(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return objectHas(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return objectHas(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n","var global = require('../internals/global');\nvar inspectSource = require('../internals/inspect-source');\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = typeof WeakMap === 'function' && /native code/.test(inspectSource(WeakMap));\n","var IS_PURE = require('../internals/is-pure');\nvar store = require('../internals/shared-store');\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.6.5',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: ' 2020 Denis Pushkarev (zloirock.ru)'\n});\n","var id = 0;\nvar postfix = Math.random();\n\nmodule.exports = function (key) {\n  return 'Symbol(' + String(key === undefined ? '' : key) + ')_' + (++id + postfix).toString(36);\n};\n","var shared = require('../internals/shared');\nvar uid = require('../internals/uid');\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n","module.exports = {};\n","var anObject = require('../internals/an-object');\nvar defineProperties = require('../internals/object-define-properties');\nvar enumBugKeys = require('../internals/enum-bug-keys');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar html = require('../internals/html');\nvar documentCreateElement = require('../internals/document-create-element');\nvar sharedKey = require('../internals/shared-key');\n\nvar GT = '>';\nvar LT = '<';\nvar PROTOTYPE = 'prototype';\nvar SCRIPT = 'script';\nvar IE_PROTO = sharedKey('IE_PROTO');\n\nvar EmptyConstructor = function () { /* empty */ };\n\nvar scriptTag = function (content) {\n  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;\n};\n\n// Create object with fake `null` prototype: use ActiveX Object with cleared prototype\nvar NullProtoObjectViaActiveX = function (activeXDocument) {\n  activeXDocument.write(scriptTag(''));\n  activeXDocument.close();\n  var temp = activeXDocument.parentWindow.Object;\n  activeXDocument = null; // avoid memory leak\n  return temp;\n};\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar NullProtoObjectViaIFrame = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var JS = 'java' + SCRIPT + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  // https://github.com/zloirock/core-js/issues/475\n  iframe.src = String(JS);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(scriptTag('document.F=Object'));\n  iframeDocument.close();\n  return iframeDocument.F;\n};\n\n// Check for document.domain and active x support\n// No need to use active x approach when document.domain is not set\n// see https://github.com/es-shims/es5-shim/issues/150\n// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n// avoid IE GC bug\nvar activeXDocument;\nvar NullProtoObject = function () {\n  try {\n    /* global ActiveXObject */\n    activeXDocument = document.domain && new ActiveXObject('htmlfile');\n  } catch (error) { /* ignore */ }\n  NullProtoObject = activeXDocument ? NullProtoObjectViaActiveX(activeXDocument) : NullProtoObjectViaIFrame();\n  var length = enumBugKeys.length;\n  while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];\n  return NullProtoObject();\n};\n\nhiddenKeys[IE_PROTO] = true;\n\n// `Object.create` method\n// https://tc39.github.io/ecma262/#sec-object.create\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    EmptyConstructor[PROTOTYPE] = anObject(O);\n    result = new EmptyConstructor();\n    EmptyConstructor[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = NullProtoObject();\n  return Properties === undefined ? result : defineProperties(result, Properties);\n};\n","var global = require('../internals/global');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar has = require('../internals/has');\nvar setGlobal = require('../internals/set-global');\nvar inspectSource = require('../internals/inspect-source');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar getInternalState = InternalStateModule.get;\nvar enforceInternalState = InternalStateModule.enforce;\nvar TEMPLATE = String(String).split('String');\n\n(module.exports = function (O, key, value, options) {\n  var unsafe = options ? !!options.unsafe : false;\n  var simple = options ? !!options.enumerable : false;\n  var noTargetGet = options ? !!options.noTargetGet : false;\n  if (typeof value == 'function') {\n    if (typeof key == 'string' && !has(value, 'name')) createNonEnumerableProperty(value, 'name', key);\n    enforceInternalState(value).source = TEMPLATE.join(typeof key == 'string' ? key : '');\n  }\n  if (O === global) {\n    if (simple) O[key] = value;\n    else setGlobal(key, value);\n    return;\n  } else if (!unsafe) {\n    delete O[key];\n  } else if (!noTargetGet && O[key]) {\n    simple = true;\n  }\n  if (simple) O[key] = value;\n  else createNonEnumerableProperty(O, key, value);\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, 'toString', function toString() {\n  return typeof this == 'function' && getInternalState(this).source || inspectSource(this);\n});\n","var global = require('../internals/global');\n\nmodule.exports = global;\n","var path = require('../internals/path');\nvar global = require('../internals/global');\n\nvar aFunction = function (variable) {\n  return typeof variable == 'function' ? variable : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(path[namespace]) || aFunction(global[namespace])\n    : path[namespace] && path[namespace][method] || global[namespace] && global[namespace][method];\n};\n","var ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `ToInteger` abstract operation\n// https://tc39.github.io/ecma262/#sec-tointeger\nmodule.exports = function (argument) {\n  return isNaN(argument = +argument) ? 0 : (argument > 0 ? floor : ceil)(argument);\n};\n","var toInteger = require('../internals/to-integer');\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.github.io/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toInteger(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n","var toInteger = require('../internals/to-integer');\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toInteger(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n","var toIndexedObject = require('../internals/to-indexed-object');\nvar toLength = require('../internals/to-length');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n","var has = require('../internals/has');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar indexOf = require('../internals/array-includes').indexOf;\nvar hiddenKeys = require('../internals/hidden-keys');\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !has(hiddenKeys, key) && has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~indexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertynames\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n","exports.f = Object.getOwnPropertySymbols;\n","var getBuiltIn = require('../internals/get-built-in');\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar anObject = require('../internals/an-object');\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? keys.concat(getOwnPropertySymbols(it)) : keys;\n};\n","var has = require('../internals/has');\nvar ownKeys = require('../internals/own-keys');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar definePropertyModule = require('../internals/object-define-property');\n\nmodule.exports = function (target, source) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!has(target, key)) defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n  }\n};\n","var fails = require('../internals/fails');\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : typeof detection == 'function' ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n","var global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar setGlobal = require('../internals/set-global');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar isForced = require('../internals/is-forced');\n\n/*\n  options.target      - name of the target object\n  options.global      - target is the global object\n  options.stat        - export as static methods of target\n  options.proto       - export as prototype methods of target\n  options.real        - real prototype method for the `pure` version\n  options.forced      - export even if the native feature is available\n  options.bind        - bind methods to the target, required for the `pure` version\n  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n  options.sham        - add a flag to not completely full polyfills\n  options.enumerable  - export as enumerable property\n  options.noTargetGet - prevent calling a getter on target\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || setGlobal(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.noTargetGet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty === typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    // extend global\n    redefine(target, key, sourceProperty, options);\n  }\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  // Chrome 38 Symbol has incorrect toString conversion\n  // eslint-disable-next-line no-undef\n  return !String(Symbol());\n});\n","var NATIVE_SYMBOL = require('../internals/native-symbol');\n\nmodule.exports = NATIVE_SYMBOL\n  // eslint-disable-next-line no-undef\n  && !Symbol.sham\n  // eslint-disable-next-line no-undef\n  && typeof Symbol.iterator == 'symbol';\n","var global = require('../internals/global');\nvar shared = require('../internals/shared');\nvar has = require('../internals/has');\nvar uid = require('../internals/uid');\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar WellKnownSymbolsStore = shared('wks');\nvar Symbol = global.Symbol;\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!has(WellKnownSymbolsStore, name)) {\n    if (NATIVE_SYMBOL && has(Symbol, name)) WellKnownSymbolsStore[name] = Symbol[name];\n    else WellKnownSymbolsStore[name] = createWellKnownSymbol('Symbol.' + name);\n  } return WellKnownSymbolsStore[name];\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.github.io/ecma262/#sec-object.keys\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar anObject = require('../internals/an-object');\nvar objectKeys = require('../internals/object-keys');\n\n// `Object.defineProperties` method\n// https://tc39.github.io/ecma262/#sec-object.defineproperties\nmodule.exports = DESCRIPTORS ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) definePropertyModule.f(O, key = keys[index++], Properties[key]);\n  return O;\n};\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('document', 'documentElement');\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar create = require('../internals/object-create');\nvar definePropertyModule = require('../internals/object-define-property');\n\nvar UNSCOPABLES = wellKnownSymbol('unscopables');\nvar ArrayPrototype = Array.prototype;\n\n// Array.prototype[@@unscopables]\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\nif (ArrayPrototype[UNSCOPABLES] == undefined) {\n  definePropertyModule.f(ArrayPrototype, UNSCOPABLES, {\n    configurable: true,\n    value: create(null)\n  });\n}\n\n// add a key to Array.prototype[@@unscopables]\nmodule.exports = function (key) {\n  ArrayPrototype[UNSCOPABLES][key] = true;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar has = require('../internals/has');\n\nvar defineProperty = Object.defineProperty;\nvar cache = {};\n\nvar thrower = function (it) { throw it; };\n\nmodule.exports = function (METHOD_NAME, options) {\n  if (has(cache, METHOD_NAME)) return cache[METHOD_NAME];\n  if (!options) options = {};\n  var method = [][METHOD_NAME];\n  var ACCESSORS = has(options, 'ACCESSORS') ? options.ACCESSORS : false;\n  var argument0 = has(options, 0) ? options[0] : thrower;\n  var argument1 = has(options, 1) ? options[1] : undefined;\n\n  return cache[METHOD_NAME] = !!method && !fails(function () {\n    if (ACCESSORS && !DESCRIPTORS) return true;\n    var O = { length: -1 };\n\n    if (ACCESSORS) defineProperty(O, 1, { enumerable: true, get: thrower });\n    else O[1] = 1;\n\n    method.call(O, argument0, argument1);\n  });\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $includes = require('../internals/array-includes').includes;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.includes` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.includes\n$({ target: 'Array', proto: true, forced: !USES_TO_LENGTH }, {\n  includes: function includes(el /* , fromIndex = 0 */) {\n    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('includes');\n","var requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `ToObject` abstract operation\n// https://tc39.github.io/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar objectKeys = require('../internals/object-keys');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar toObject = require('../internals/to-object');\nvar IndexedObject = require('../internals/indexed-object');\n\nvar nativeAssign = Object.assign;\nvar defineProperty = Object.defineProperty;\n\n// `Object.assign` method\n// https://tc39.github.io/ecma262/#sec-object.assign\nmodule.exports = !nativeAssign || fails(function () {\n  // should have correct order of operations (Edge bug)\n  if (DESCRIPTORS && nativeAssign({ b: 1 }, nativeAssign(defineProperty({}, 'a', {\n    enumerable: true,\n    get: function () {\n      defineProperty(this, 'b', {\n        value: 3,\n        enumerable: false\n      });\n    }\n  }), { b: 2 })).b !== 1) return true;\n  // should work with symbols and should have deterministic property order (V8 bug)\n  var A = {};\n  var B = {};\n  // eslint-disable-next-line no-undef\n  var symbol = Symbol();\n  var alphabet = 'abcdefghijklmnopqrst';\n  A[symbol] = 7;\n  alphabet.split('').forEach(function (chr) { B[chr] = chr; });\n  return nativeAssign({}, A)[symbol] != 7 || objectKeys(nativeAssign({}, B)).join('') != alphabet;\n}) ? function assign(target, source) { // eslint-disable-line no-unused-vars\n  var T = toObject(target);\n  var argumentsLength = arguments.length;\n  var index = 1;\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  var propertyIsEnumerable = propertyIsEnumerableModule.f;\n  while (argumentsLength > index) {\n    var S = IndexedObject(arguments[index++]);\n    var keys = getOwnPropertySymbols ? objectKeys(S).concat(getOwnPropertySymbols(S)) : objectKeys(S);\n    var length = keys.length;\n    var j = 0;\n    var key;\n    while (length > j) {\n      key = keys[j++];\n      if (!DESCRIPTORS || propertyIsEnumerable.call(S, key)) T[key] = S[key];\n    }\n  } return T;\n} : nativeAssign;\n","var $ = require('../internals/export');\nvar assign = require('../internals/object-assign');\n\n// `Object.assign` method\n// https://tc39.github.io/ecma262/#sec-object.assign\n$({ target: 'Object', stat: true, forced: Object.assign !== assign }, {\n  assign: assign\n});\n","var isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\n// `IsRegExp` abstract operation\n// https://tc39.github.io/ecma262/#sec-isregexp\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : classof(it) == 'RegExp');\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar toLength = require('../internals/to-length');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\nvar IS_PURE = require('../internals/is-pure');\n\nvar nativeEndsWith = ''.endsWith;\nvar min = Math.min;\n\nvar CORRECT_IS_REGEXP_LOGIC = correctIsRegExpLogic('endsWith');\n// https://github.com/zloirock/core-js/pull/702\nvar MDN_POLYFILL_BUG = !IS_PURE && !CORRECT_IS_REGEXP_LOGIC && !!function () {\n  var descriptor = getOwnPropertyDescriptor(String.prototype, 'endsWith');\n  return descriptor && !descriptor.writable;\n}();\n\n// `String.prototype.endsWith` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.endswith\n$({ target: 'String', proto: true, forced: !MDN_POLYFILL_BUG && !CORRECT_IS_REGEXP_LOGIC }, {\n  endsWith: function endsWith(searchString /* , endPosition = @length */) {\n    var that = String(requireObjectCoercible(this));\n    notARegExp(searchString);\n    var endPosition = arguments.length > 1 ? arguments[1] : undefined;\n    var len = toLength(that.length);\n    var end = endPosition === undefined ? len : min(toLength(endPosition), len);\n    var search = String(searchString);\n    return nativeEndsWith\n      ? nativeEndsWith.call(that, search, end)\n      : that.slice(end - search.length, end) === search;\n  }\n});\n","var isRegExp = require('../internals/is-regexp');\n\nmodule.exports = function (it) {\n  if (isRegExp(it)) {\n    throw TypeError(\"The method doesn't accept regular expressions\");\n  } return it;\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\nmodule.exports = function (METHOD_NAME) {\n  var regexp = /./;\n  try {\n    '/./'[METHOD_NAME](regexp);\n  } catch (e) {\n    try {\n      regexp[MATCH] = false;\n      return '/./'[METHOD_NAME](regexp);\n    } catch (f) { /* empty */ }\n  } return false;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\n\n// `String.prototype.includes` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.includes\n$({ target: 'String', proto: true, forced: !correctIsRegExpLogic('includes') }, {\n  includes: function includes(searchString /* , position = 0 */) {\n    return !!~String(requireObjectCoercible(this))\n      .indexOf(notARegExp(searchString), arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar toLength = require('../internals/to-length');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\nvar IS_PURE = require('../internals/is-pure');\n\nvar nativeStartsWith = ''.startsWith;\nvar min = Math.min;\n\nvar CORRECT_IS_REGEXP_LOGIC = correctIsRegExpLogic('startsWith');\n// https://github.com/zloirock/core-js/pull/702\nvar MDN_POLYFILL_BUG = !IS_PURE && !CORRECT_IS_REGEXP_LOGIC && !!function () {\n  var descriptor = getOwnPropertyDescriptor(String.prototype, 'startsWith');\n  return descriptor && !descriptor.writable;\n}();\n\n// `String.prototype.startsWith` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.startswith\n$({ target: 'String', proto: true, forced: !MDN_POLYFILL_BUG && !CORRECT_IS_REGEXP_LOGIC }, {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = String(requireObjectCoercible(this));\n    notARegExp(searchString);\n    var index = toLength(min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = String(searchString);\n    return nativeStartsWith\n      ? nativeStartsWith.call(that, search, index)\n      : that.slice(index, index + search.length) === search;\n  }\n});\n","/* global FormData self Blob File */\r\n/* eslint-disable no-inner-declarations */\r\n\r\nif (typeof Blob !== 'undefined' && (typeof FormData === 'undefined' || !FormData.prototype.keys)) {\r\n  const global = typeof window === 'object'\r\n    ? window\r\n    : typeof self === 'object' ? self : this\r\n\r\n  // keep a reference to native implementation\r\n  const _FormData = global.FormData\r\n\r\n  // To be monkey patched\r\n  const _send = global.XMLHttpRequest && global.XMLHttpRequest.prototype.send\r\n  const _fetch = global.Request && global.fetch\r\n  const _sendBeacon = global.navigator && global.navigator.sendBeacon\r\n\r\n  // Unable to patch Request constructor correctly\r\n  // const _Request = global.Request\r\n  // only way is to use ES6 class extend\r\n  // https://github.com/babel/babel/issues/1966\r\n\r\n  const stringTag = global.Symbol && Symbol.toStringTag\r\n\r\n  // Add missing stringTags to blob and files\r\n  if (stringTag) {\r\n    if (!Blob.prototype[stringTag]) {\r\n      Blob.prototype[stringTag] = 'Blob'\r\n    }\r\n\r\n    if ('File' in global && !File.prototype[stringTag]) {\r\n      File.prototype[stringTag] = 'File'\r\n    }\r\n  }\r\n\r\n  // Fix so you can construct your own File\r\n  try {\r\n    new File([], '') // eslint-disable-line\r\n  } catch (a) {\r\n    global.File = function File (b, d, c) {\r\n      const blob = new Blob(b, c)\r\n      const t = c && void 0 !== c.lastModified ? new Date(c.lastModified) : new Date()\r\n\r\n      Object.defineProperties(blob, {\r\n        name: {\r\n          value: d\r\n        },\r\n        lastModifiedDate: {\r\n          value: t\r\n        },\r\n        lastModified: {\r\n          value: +t\r\n        },\r\n        toString: {\r\n          value () {\r\n            return '[object File]'\r\n          }\r\n        }\r\n      })\r\n\r\n      if (stringTag) {\r\n        Object.defineProperty(blob, stringTag, {\r\n          value: 'File'\r\n        })\r\n      }\r\n\r\n      return blob\r\n    }\r\n  }\r\n\r\n  function normalizeValue ([value, filename]) {\r\n    if (value instanceof Blob) {\r\n      // Should always returns a new File instance\r\n      // console.assert(fd.get(x) !== fd.get(x))\r\n      value = new File([value], filename, {\r\n        type: value.type,\r\n        lastModified: value.lastModified\r\n      })\r\n    }\r\n\r\n    return value\r\n  }\r\n\r\n  function ensureArgs (args, expected) {\r\n    if (args.length < expected) {\r\n      throw new TypeError(`${expected} argument required, but only ${args.length} present.`)\r\n    }\r\n  }\r\n\r\n  function normalizeArgs (name, value, filename) {\r\n    return value instanceof Blob\r\n      // normalize name and filename if adding an attachment\r\n      ? [String(name), value, filename !== undefined\r\n        ? filename + '' // Cast filename to string if 3th arg isn't undefined\r\n        : typeof value.name === 'string' // if name prop exist\r\n          ? value.name // Use File.name\r\n          : 'blob'] // otherwise fallback to Blob\r\n\r\n      // If no attachment, just cast the args to strings\r\n      : [String(name), String(value)]\r\n  }\r\n\r\n  // normalize linefeeds for textareas\r\n  // https://html.spec.whatwg.org/multipage/form-elements.html#textarea-line-break-normalisation-transformation\r\n  function normalizeLinefeeds (value) {\r\n    return value.replace(/\\r\\n/g, '\\n').replace(/\\n/g, '\\r\\n')\r\n  }\r\n\r\n  function each (arr, cb) {\r\n    for (let i = 0; i < arr.length; i++) {\r\n      cb(arr[i])\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @implements {Iterable}\r\n   */\r\n  class FormDataPolyfill {\r\n    /**\r\n     * FormData class\r\n     *\r\n     * @param {HTMLElement=} form\r\n     */\r\n    constructor (form) {\r\n      this._data = Object.create(null)\r\n\r\n      if (!form) return this\r\n\r\n      const self = this\r\n\r\n      each(form.elements, elm => {\r\n        if (!elm.name || elm.disabled || elm.type === 'submit' || elm.type === 'button') return\r\n\r\n        if (elm.type === 'file') {\r\n          const files = elm.files && elm.files.length\r\n            ? elm.files\r\n            : [new File([], '', { type: 'application/octet-stream' })] // #78\r\n\r\n          each(files, file => {\r\n            self.append(elm.name, file)\r\n          })\r\n        } else if (elm.type === 'select-multiple' || elm.type === 'select-one') {\r\n          each(elm.options, opt => {\r\n            !opt.disabled && opt.selected && self.append(elm.name, opt.value)\r\n          })\r\n        } else if (elm.type === 'checkbox' || elm.type === 'radio') {\r\n          if (elm.checked) self.append(elm.name, elm.value)\r\n        } else {\r\n          const value = elm.type === 'textarea' ? normalizeLinefeeds(elm.value) : elm.value\r\n          self.append(elm.name, value)\r\n        }\r\n      })\r\n    }\r\n\r\n    /**\r\n     * Append a field\r\n     *\r\n     * @param   {string}           name      field name\r\n     * @param   {string|Blob|File} value     string / blob / file\r\n     * @param   {string=}          filename  filename to use with blob\r\n     * @return  {undefined}\r\n     */\r\n    append (name, value, filename) {\r\n      ensureArgs(arguments, 2)\r\n      ;[name, value, filename] = normalizeArgs.apply(null, arguments)\r\n      const map = this._data\r\n\r\n      if (!map[name]) map[name] = []\r\n\r\n      map[name].push([value, filename])\r\n    }\r\n\r\n    /**\r\n     * Delete all fields values given name\r\n     *\r\n     * @param   {string}  name  Field name\r\n     * @return  {undefined}\r\n     */\r\n    delete (name) {\r\n      ensureArgs(arguments, 1)\r\n      delete this._data[String(name)]\r\n    }\r\n\r\n    /**\r\n     * Iterate over all fields as [name, value]\r\n     *\r\n     * @return {Iterator}\r\n     */\r\n    * entries () {\r\n      const map = this._data\r\n\r\n      for (const name in map) {\r\n        for (const value of map[name]) {\r\n          yield [name, normalizeValue(value)]\r\n        }\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Iterate over all fields\r\n     *\r\n     * @param   {Function}  callback  Executed for each item with parameters (value, name, thisArg)\r\n     * @param   {Object=}   thisArg   `this` context for callback function\r\n     * @return  {undefined}\r\n     */\r\n    forEach (callback, thisArg) {\r\n      ensureArgs(arguments, 1)\r\n      for (const [name, value] of this) {\r\n        callback.call(thisArg, value, name, this)\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Return first field value given name\r\n     * or null if non existen\r\n     *\r\n     * @param   {string}  name      Field name\r\n     * @return  {string|File|null}  value Fields value\r\n     */\r\n    get (name) {\r\n      ensureArgs(arguments, 1)\r\n      const map = this._data\r\n      name = String(name)\r\n      return map[name] ? normalizeValue(map[name][0]) : null\r\n    }\r\n\r\n    /**\r\n     * Return all fields values given name\r\n     *\r\n     * @param   {string}  name  Fields name\r\n     * @return  {Array}         [{String|File}]\r\n     */\r\n    getAll (name) {\r\n      ensureArgs(arguments, 1)\r\n      return (this._data[String(name)] || []).map(normalizeValue)\r\n    }\r\n\r\n    /**\r\n     * Check for field name existence\r\n     *\r\n     * @param   {string}   name  Field name\r\n     * @return  {boolean}\r\n     */\r\n    has (name) {\r\n      ensureArgs(arguments, 1)\r\n      return String(name) in this._data\r\n    }\r\n\r\n    /**\r\n     * Iterate over all fields name\r\n     *\r\n     * @return {Iterator}\r\n     */\r\n    * keys () {\r\n      for (const [name] of this) {\r\n        yield name\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Overwrite all values given name\r\n     *\r\n     * @param   {string}    name      Filed name\r\n     * @param   {string}    value     Field value\r\n     * @param   {string=}   filename  Filename (optional)\r\n     * @return  {undefined}\r\n     */\r\n    set (name, value, filename) {\r\n      ensureArgs(arguments, 2)\r\n      const args = normalizeArgs.apply(null, arguments)\r\n      this._data[args[0]] = [[args[1], args[2]]]\r\n    }\r\n\r\n    /**\r\n     * Iterate over all fields\r\n     *\r\n     * @return {Iterator}\r\n     */\r\n    * values () {\r\n      for (const [, value] of this) {\r\n        yield value\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Return a native (perhaps degraded) FormData with only a `append` method\r\n     * Can throw if it's not supported\r\n     *\r\n     * @return {FormData}\r\n     */\r\n    ['_asNative'] () {\r\n      const fd = new _FormData()\r\n\r\n      for (const [name, value] of this) {\r\n        fd.append(name, value)\r\n      }\r\n\r\n      return fd\r\n    }\r\n\r\n    /**\r\n     * [_blob description]\r\n     *\r\n     * @return {Blob} [description]\r\n     */\r\n    ['_blob'] () {\r\n      const boundary = '----formdata-polyfill-' + Math.random()\r\n      const chunks = []\r\n\r\n      for (const [name, value] of this) {\r\n        chunks.push(`--${boundary}\\r\\n`)\r\n\r\n        if (value instanceof Blob) {\r\n          chunks.push(\r\n            `Content-Disposition: form-data; name=\"${name}\"; filename=\"${value.name}\"\\r\\n`,\r\n            `Content-Type: ${value.type || 'application/octet-stream'}\\r\\n\\r\\n`,\r\n            value,\r\n            '\\r\\n'\r\n          )\r\n        } else {\r\n          chunks.push(\r\n            `Content-Disposition: form-data; name=\"${name}\"\\r\\n\\r\\n${value}\\r\\n`\r\n          )\r\n        }\r\n      }\r\n\r\n      chunks.push(`--${boundary}--`)\r\n\r\n      return new Blob(chunks, {\r\n        type: 'multipart/form-data; boundary=' + boundary\r\n      })\r\n    }\r\n\r\n    /**\r\n     * The class itself is iterable\r\n     * alias for formdata.entries()\r\n     *\r\n     * @return  {Iterator}\r\n     */\r\n    [Symbol.iterator] () {\r\n      return this.entries()\r\n    }\r\n\r\n    /**\r\n     * Create the default string description.\r\n     *\r\n     * @return  {string} [object FormData]\r\n     */\r\n    toString () {\r\n      return '[object FormData]'\r\n    }\r\n  }\r\n\r\n  if (stringTag) {\r\n    /**\r\n     * Create the default string description.\r\n     * It is accessed internally by the Object.prototype.toString().\r\n     */\r\n    FormDataPolyfill.prototype[stringTag] = 'FormData'\r\n  }\r\n\r\n  // Patch xhr's send method to call _blob transparently\r\n  if (_send) {\r\n    const setRequestHeader = global.XMLHttpRequest.prototype.setRequestHeader\r\n\r\n    /**\r\n     * @param {string} name\r\n     * @param {string} value\r\n     * @returns {undefined}\r\n     * @see https://xhr.spec.whatwg.org/#dom-xmlhttprequest-setrequestheader\r\n     */\r\n    global.XMLHttpRequest.prototype.setRequestHeader = function (name, value) {\r\n      setRequestHeader.call(this, name, value)\r\n      if (name.toLowerCase() === 'content-type') this._hasContentType = true\r\n    }\r\n\r\n    /**\r\n     * @param {ArrayBuffer|ArrayBufferView|Blob|Document|FormData|string=} data\r\n     * @return {undefined}\r\n     * @see https://xhr.spec.whatwg.org/#the-send()-method\r\n     */\r\n    global.XMLHttpRequest.prototype.send = function (data) {\r\n      // need to patch send b/c old IE don't send blob's type (#44)\r\n      if (data instanceof FormDataPolyfill) {\r\n        const blob = data['_blob']()\r\n        if (!this._hasContentType) this.setRequestHeader('Content-Type', blob.type)\r\n        _send.call(this, blob)\r\n      } else {\r\n        _send.call(this, data)\r\n      }\r\n    }\r\n  }\r\n\r\n  // Patch fetch's function to call _blob transparently\r\n  if (_fetch) {\r\n    const _fetch = global.fetch\r\n\r\n    global.fetch = function (input, init) {\r\n      if (init && init.body && init.body instanceof FormDataPolyfill) {\r\n        init.body = init.body['_blob']()\r\n      }\r\n\r\n      return _fetch.call(this, input, init)\r\n    }\r\n  }\r\n\r\n  // Patch navigator.sendBeacon to use native FormData\r\n  if (_sendBeacon) {\r\n    global.navigator.sendBeacon = function (url, data) {\r\n      if (data instanceof FormDataPolyfill) {\r\n        data = data['_asNative']()\r\n      }\r\n      return _sendBeacon.call(this, url, data)\r\n    }\r\n  }\r\n\r\n  global['FormData'] = FormDataPolyfill\r\n}\r\n","import $ from 'jquery';\r\n\r\n// AutoSuggest class\r\nexport default function AutoSuggest(settings) {\r\n\tvar $input,\r\n\t\t$element,\r\n\t\tself = this,\r\n\t\telValue = settings.id,\r\n\t\tfrm = settings.form,\r\n\t\tforceSelection = settings.forceSelect,\r\n\t\tre = /^[xy](\\d*|\\$rowindex\\$)_/,\r\n\t\tm = elValue.match(re),\r\n\t\tnid = elValue.replace(re, \"x_\"),\r\n\t\trowindex = m ? m[1] : \"\",\r\n\t\toEmpty = {typeahead:{}}; // Empty Auto-Suggest object\r\n\tif (rowindex == \"$rowindex$\")\r\n\t\treturn oEmpty;\r\n\tvar form = frm.getElement(); // HTML form or DIV\r\n\tvar elInput = frm.getElement(\"sv_\" + elValue);\r\n\tif (!elInput)\r\n\t\treturn oEmpty;\r\n\tvar elContainer = frm.getElement(\"sc_\" + elValue);\r\n\tvar elParent = frm.lists[nid].parentFields.slice(); // Clone\r\n\r\n\tfor (var i = 0, len = elParent.length; i < len; i++) {\r\n\t\tvar ar = elParent[i].split(\" \");\r\n\t\tif (ar.length == 1) // Parent field in the same table, add row index\r\n\t\telParent[i] = elParent[i].replace(/^x_/, \"x\" + rowindex + \"_\");\r\n\t}\r\n\r\n\t// Properties\r\n\tthis.data = settings.data;\r\n\tthis.minWidth = settings.minWidth;\r\n\tthis.maxHeight = settings.maxHeight;\r\n\tthis.highlight = settings.highlight;\r\n\tthis.hint = settings.hint;\r\n\tthis.minLength = settings.minLength;\r\n\tthis.limit = settings.limit;\r\n\tthis.templates = Object.assign({}, settings.templates); // Clone\r\n\tthis.trigger = settings.trigger; // For loading more results\r\n\tthis.delay = settings.delay; // For loading more results\r\n\tthis.display = settings.display || \"value\";\r\n\tthis.input = elInput;\r\n\tthis.element = frm.getElement(elValue);\r\n\tthis.$input = $input = $(this.input)\r\n\tthis.$element = $element = $(this.element);\r\n\tthis._options = [];\r\n\tthis._recordCount = 0;\r\n\r\n\t// Save initial option\r\n\tif ($input.val() && $element.val())\r\n\t\tthis._options.push({val: $element.val(), lbl: $input.val()});\r\n\r\n\t// Format display value in textbox\r\n\tthis.formatResult = function(ar) {\r\n\t\treturn ew.displayValue(ar, this.element) || ar[0];\r\n\t};\r\n\r\n\t// Set the selected item to the actual field\r\n\tthis.setValue = function(v) {\r\n\t\tv = v || $input.val();\r\n\t\tvar ar = $input.data(\"results\") ? $.map($input.data(\"results\"), function(item, i) {\r\n\t\t\tif (item[\"value\"] == v) // Value exists\r\n\t\t\t\treturn i; // Return the index\r\n\t\t}) : [];\r\n\t\tif (ar.length == 0) { // Not found in results\r\n\t\t\tif (this._options && this._options.length && this._options[this._options.length - 1].lbl == v) // Option added by Add Option dialog or initial option\r\n\t\t\t\treturn;\r\n\t\t\tif (forceSelection && v) { // Force selection and query not empty => error\r\n\t\t\t\t$input.typeahead(\"val\", \"\").attr(\"placeholder\", ew.language.phrase(\"ValueNotExist\")).addClass(\"is-invalid\");\r\n\t\t\t\t$element.val(\"\").change();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t} else { // Found in results\r\n\t\t\tif (!/s(ea)?rch$/.test(form.id) || forceSelection) { // Force selection or not search form\r\n\t\t\t\tvar i = ar[0]; // Get the index\r\n\t\t\t\tif (i > -1)\r\n\t\t\t\t\tv = $input.data(\"results\")[i][\"lf\"]; // Replace the display value by Link Field value\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (v !== $element.val())\r\n\t\t\t$element.val(v).change(); // Set value to the actual field\r\n\t};\r\n\r\n\t// Generate request\r\n\tthis.generateRequest = function() {\r\n\t\tvar data = Object.assign({}, this.data, {\r\n\t\t\tname: this.element.name,\r\n\t\t\tajax: \"autosuggest\",\r\n\t\t\tlanguage: ew.LANGUAGE_ID\r\n\t\t}, ew.getUserParams(\"#p_\" + elValue, form));\r\n\t\tif (elParent.length > 0) {\r\n\t\t\tfor (var i = 0, len = elParent.length; i < len; i++) {\r\n\t\t\t\tvar arp = getOptionValues(elParent[i], form);\r\n\t\t\t\tdata[\"v\" + (i + 1)] = arp.join(ew.MULTIPLE_OPTION_SEPARATOR);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn data;\r\n\t};\r\n\r\n\t// Prepare to send request\r\n\tthis.prepare = function(query, start) {\r\n\t\tvar settings = {};\r\n\t\tsettings.data = this.generateRequest();\r\n\t\tsettings.type = \"POST\";\r\n\t\tsettings.dataType = \"json\";\r\n\t\tvar params = new URLSearchParams({ \"q\": query, \"n\": this.limit, \"rnd\": ew.random() });\r\n\t\tif ($.isNumber(start))\r\n\t\t\tparams.set(\"start\", start);\r\n\t\tsettings.url = ew.getApiUrl(ew.API_LOOKUP_ACTION, params.toString());\r\n\t\treturn settings;\r\n\t};\r\n\r\n\t// Transform suggestion\r\n\tthis.transform = function(data) {\r\n\t\tvar results;\r\n\t\tif (data && data.result == \"OK\") {\r\n\t\t\tself._recordCount = data.totalRecordCount;\r\n\t\t\tresults = data.records;\r\n\t\t}\r\n\t\t$input.data(\"results\", results || []);\r\n\t\tvar ar = $.map($input.data(\"results\"), function(item) {\r\n\t\t\tvar val = item[\"value\"] = self.formatResult(item); // Format the item and save as property\r\n\t\t\treturn { lf: item[0], df1: item[1], df2: item[2], df3: item[3], df4: item[4], value: val }; // Return as object\r\n\t\t});\r\n\t\treturn ar;\r\n\t};\r\n\r\n\t// Get suggestions by Ajax\r\n\tthis.source = function(query, syncResults, asyncResults) {\r\n\t\tself._recordCount = 0; // Reset\r\n\t\tvar settings = self.prepare(query);\r\n\t\t$.ajax(settings).done(function(data) {\r\n\t\t\tasyncResults(self.transform(data));\r\n\t\t});\r\n\t};\r\n\r\n\t// Get current suggestion count\r\n\tthis.count = function() {\r\n\t\treturn self.typeahead.menu.$node.find(\".tt-suggestion.tt-selectable\").length;\r\n\t};\r\n\r\n\t// Get more suggestions by Ajax\r\n\tthis.more = function() {\r\n\t\t$body = $(\"body\");\r\n\t\t$body.css(\"cursor\", \"wait\");\r\n\t\tvar ta = self.typeahead, query = ta.menu.query, dataset = ta.menu.datasets[0];\r\n\t\tvar start = self.count();\r\n\t\tvar settings = self.prepare(query, start);\r\n\t\t$.ajax(settings).done(function(data) {\r\n\t\t\tdata = self.transform(data);\r\n\t\t\tdataset._append(query, data);\r\n\t\t\tta.menu.$node.find(\".tt-dataset\").scrollTop(dataset.$lastSuggestion.outerHeight() * start);\r\n\t\t}).always(function() {\r\n\t\t\t$body.css(\"cursor\", \"default\");\r\n\t\t});\r\n\t};\r\n\r\n\t// Add events\r\n\t$input.on(\"typeahead:select\", function(e, d) {\r\n\t\tself.setValue(d.value);\r\n\t}).change(function(e) {\r\n\t\tvar ta = $input.data(\"tt-typeahead\");\r\n\t\tif (ta && ta.isOpen() && !ta.menu.empty()) {\r\n\t\t\tvar $item = ta.menu.getActiveSelectable();\r\n\t\t\tif ($item) { // A suggestion is highlighted\r\n\t\t\t\tvar i = $item.index();\r\n\t\t\t\tvar val = $input.data(\"results\")[i][1];\r\n\t\t\t\t$input.typeahead(\"val\", val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.setValue();\r\n\t}).blur(function(e) { // \"change\" fires before blur\r\n\t\tvar ta = $input.data(\"tt-typeahead\");\r\n\t\tif (ta && ta.isOpen())\r\n\t\t\tta.menu.close();\r\n\t}).focus(function(e) {\r\n\t\t$input.attr(\"placeholder\", $input.data(\"placeholder\")).removeClass(\"is-invalid\");\r\n\t});\r\n\r\n\t// Option template (\"suggestion\" template)\r\n\tvar tpl;\r\n\tif (frm.lists[nid].template) {\r\n\t\ttpl = frm.lists[nid].template;\r\n\t} else {\r\n\t\ttpl = self.templates[\"suggestion\"];\r\n\t}\r\n\tif (tpl && $.isString(tpl))\r\n\t\ttpl = $.templates(tpl);\r\n\tif (tpl)\r\n\t\tself.templates[\"suggestion\"] = tpl.render.bind(tpl);\r\n\r\n\t// Save\r\n\t$element.data(\"autosuggest\", this);\r\n\r\n\t// Create Typeahead\r\n\t$(function() {\r\n\t\t// Typeahead options and dataset\r\n\t\tvar options = {\r\n\t\t\thighlight: self.highlight,\r\n\t\t\tminLength: self.minLength,\r\n\t\t\thint: self.hint,\r\n\t\t\ttrigger: self.trigger,\r\n\t\t\tdelay: self.delay\r\n\t\t};\r\n\t\tvar dataset = {\r\n\t\t\tname: frm.id + \"-\" + elValue,\r\n\t\t\tsource: self.source,\r\n\t\t\ttemplates: self.templates,\r\n\t\t\tdisplay: self.display,\r\n\t\t\tlimit: self.limit,\r\n\t\t\tasync: true\r\n\t\t};\r\n\t\tvar args = [options, dataset];\r\n\t\t// Trigger \"typeahead\" event\r\n\t\t$element.trigger(\"typeahead\", [args]);\r\n\t\tself.limit = dataset.limit;\r\n\t\t// Create Typeahead\r\n\t\t$input.typeahead.apply($input, args);\r\n\t\t$input.on(\"typeahead:rendered\", function() {\r\n\t\t\tvar $node = self.typeahead.menu.$node;\r\n\t\t\tvar $more = $node.find(\".tt-more\").html(ew.language.phrase(\"More\"));\r\n\t\t\tif (arguments.length > 1 && // Arguments: event, suggestion, suggestion, ...\r\n\t\t\t\tself._recordCount > self.count()) {\r\n\t\t\t\tvar timer;\r\n\t\t\t\t$more.one(options.trigger, function(e) {\r\n\t\t\t\t\tif (timer)\r\n\t\t\t\t\t\ttimer.cancel();\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tself.more();\r\n\t\t\t\t\t}, options.delay);\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t$more.hide();\r\n\t\t\t}\r\n\t\t});\r\n\t\t$input.off(\"blur.tt\");\r\n\t\tself.typeahead = $input.data(\"tt-typeahead\");\r\n\t\tvar $menu = self.typeahead.menu.$node.css(\"z-index\", 1000);\r\n\t\tif (self.minWidth)\r\n\t\t\t$menu.css(\"min-width\", self.minWidth);\r\n\t\tvar $dataset = $menu.find(\".tt-dataset\");\r\n\t\tvar maxHeight = self.maxHeight ||\r\n\t\t\t(parseInt($dataset.css(\"line-height\"), 10) + 6) * (dataset.limit + 1); // Match .tt-suggestion padding\r\n\t\t$dataset.css({\"max-height\": maxHeight, \"overflow-y\": \"auto\"});\r\n\t});\r\n}","import $ from 'jquery';\r\nimport AutoSuggest from './autosuggest';\r\n\r\n// Form class\r\nexport default function Form(id, pageId) {\r\n\tvar self = this,\r\n\t\t_initiated = false;\r\n\r\n\tthis.id = id; // Same ID as the form\r\n\tthis.pageId = pageId;\r\n\tthis.$element = null;\r\n\tthis._form = null; // HTML form\r\n\tthis.initSearchPanel = false; // Expanded by default\r\n\tthis.modified = false;\r\n\tthis.validateRequired = true;\r\n\tthis.validate = null;\r\n\tthis.emptyRow = null; // Check empty row\r\n\tthis.multiPage = null; // Multi-page\r\n\tthis.autoSuggests = {}; // AutoSuggests\r\n\r\n\t// Disable form\r\n\tthis.disableForm = function() {\r\n\t\tvar form = this.getForm();\r\n\t\t$(form).find(\":submit:not(.dropdown-toggle)\").prop(\"disabled\", true).addClass(\"disabled\");\r\n\t}\r\n\r\n\t// Enable form\r\n\tthis.enableForm = function() {\r\n\t\tvar form = this.getForm();\r\n\t\t$(form).find(\":submit:not(.dropdown-toggle)\").prop(\"disabled\", false).removeClass(\"disabled\");\r\n\t}\r\n\r\n\t// Append hidden element with form name\r\n\tthis.appendHidden = function(el) {\r\n\t\tvar form = this.getForm(), $form = $(form), $dp = $(el).closest(\".ew-form\"), name = $dp.attr(\"id\") + \"$\" + el.name;\r\n\t\tif ($form.find(\"input:hidden[name='\" + name + \"']\")[0]) // Already appended\r\n\t\t\treturn;\r\n\t\tvar ar = $dp.find('[name=\"' + el.name + '\"]').serializeArray();\r\n\t\tif (ar.length) {\r\n\t\t\tar.forEach(function(o, i) {\r\n\t\t\t\t$('<input type=\"hidden\" name=\"' + name + '\">').val(o.value).appendTo($form);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\t$('<input type=\"hidden\" name=\"' + name + '\">').val(\"\").appendTo($form);\r\n\t\t}\r\n\t}\r\n\r\n\t// Can submit\r\n\tthis.canSubmit = function() {\r\n\t\tvar form = this.getForm(), $form = $(form);\r\n\t\tthis.disableForm();\r\n\t\tthis.updateTextArea();\r\n\t\tif (!this.validate || this.validate() && !$form.find(\".is-invalid\")[0]) {\r\n\t\t\t$form.find(\"input[name^=sv_], input[name^=p_], .ew-template input\") // Do not submit these values\r\n\t\t\t\t.prop(\"disabled\", true);\r\n\t\t\t$form.find(\"[data-readonly=1][disabled]\").prop(\"disabled\", false); // Submit readonly values\r\n\t\t\tvar $dps = $($form.find(\"input[name='detailpage']\").map(function(i, el) {\r\n\t\t\t\treturn $form.find(\"#\" + el.value).get();\r\n\t\t\t}));\r\n\t\t\tif ($dps.length > 1) { // Multiple Master/Detail, check element names\r\n\t\t\t\t$dps.each(function(i, dp) {\r\n\t\t\t\t\t$(dp).find(\":input\").each(function(j, el) {\r\n\t\t\t\t\t\tif (/^(fn_)?(x|o)\\d*_/.test(el.name)) {\r\n\t\t\t\t\t\t\tvar $els = $dps.not(dp).find(\":input[name='\" + el.name + \"']\");\r\n\t\t\t\t\t\t\tif ($els.length) { // Elements with same name found\r\n\t\t\t\t\t\t\t\tself.appendHidden(el); // Append element with form name\r\n\t\t\t\t\t\t\t\t$els.each(function() {\r\n\t\t\t\t\t\t\t\t\tself.appendHidden(this); // Append elements with same name and form name\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\tthis.enableForm();\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Submit\r\n\tthis.submit = function(action) {\r\n\t\tvar form = this.getForm();\r\n\t\tif (this.canSubmit()) {\r\n\t\t\tif (action)\r\n\t\t\t\tform.action = action;\r\n\t\t\tform.submit();\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Dynamic selection lists\r\n\tthis.lists = function(name) {\r\n\t\tname = name.replace(/^[xy](\\d*|\\$rowindex\\$)_/, \"x_\"); // Fix element name prefix\r\n\t\treturn this.lists[name];\r\n\t}\r\n\r\n\t// Compile templates\r\n\tthis.compileTemplates = function() {\r\n\t\tfor (var id in this.lists) {\r\n\t\t\tvar list = this.lists[id];\r\n\t\t\tif (list.template && $.isString(list.template))\r\n\t\t\t\tlist.template = $.templates(list.template);\r\n\t\t}\r\n\t}\r\n\r\n\t// Get the HTML form object\r\n\tthis.getForm = function() {\r\n\t\tif (!this._form) {\r\n\t\t\tthis.$element = $(\"#\" + this.id);\r\n\t\t\tif (this.$element.is(\"form\")) { // HTML form\r\n\t\t\t\tthis._form = this.$element[0];\r\n\t\t\t} else if (this.$element.is(\"div\")) { // HTML div => Grid page\r\n\t\t\t\tthis._form = this.$element.closest(\"form\")[0];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this._form;\r\n\t}\r\n\r\n\t// Get form element as single element\r\n\tthis.getElement = function(name) {\r\n\t\tif (!this.$element)\r\n\t\t\tthis.$element = $(\"#\" + this.id);\r\n\t\treturn (name) ? ew.getElement(name, this.$element) : this.$element[0];\r\n\t}\r\n\r\n\t// Get form element(s) as single element or array of radio/checkbox\r\n\tthis.getElements = function(name) {\r\n\t\tif (!this.$element)\r\n\t\t\tthis.$element = $(\"#\" + this.id);\r\n\t\tvar selector = \"[name='\" + name + \"']\";\r\n\t\tselector = \"input\" + selector + \",select\" + selector + \",textarea\" + selector + \",button\" + selector;\r\n\t\tvar $els = this.$element.find(selector);\r\n\t\treturn ($els.length == 0) ? null : ($els.length == 1 && $els.is(\":not([type=checkbox]):not([type=radio])\")) ? $els[0] : $els.get();\r\n\t}\r\n\r\n\t// Update selection lists\r\n\t// @param {(null|undefined|number)*} rowindex Row index\r\n\tthis.updateLists = function(rowindex) {\r\n\t\tvar $rowindex$ = null;\r\n\t\tif (rowindex === $rowindex$) // null\r\n\t\t\treturn;\r\n\t\tvar form = this.getForm(), // Set up $element and _form\r\n\t\t\twithIndex = !$.isUndefined(rowindex),\r\n\t\t\tconfirm = form.querySelector(\"input#confirm\");\r\n\t\tif (confirm && confirm.value == \"confirm\") { // Confirm page\r\n\t\t\tremoveSpinner();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar _fixIndex = function(id) {\r\n\t\t\treturn (withIndex) ? id.replace(/^x_/, \"x\" + rowindex + \"_\") : id;\r\n\t\t};\r\n\t\tvar selector = Object.keys(this.lists).map(function(id) {\r\n\t\t\treturn \"[name='\" + _fixIndex(id) + \"']\";\r\n\t\t}).join();\r\n\t\tif (!selector || !form.querySelector(selector)) { // Lists not found\r\n\t\t\tremoveSpinner();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar actions = [], promises = [];\r\n\t\tthis.compileTemplates(); // For grid where updateList() called before init()\r\n\t\tfor (var id in this.lists) {\r\n\t\t\tvar parents = this.lists[id].parentFields.slice(); // Clone\r\n\t\t\tvar ajax = this.lists[id].ajax;\r\n\t\t\tif (withIndex) {\r\n\t\t\t\tid = _fixIndex(id);\r\n\t\t\t\tfor (var i = 0, len = parents.length; i < len; i++)\r\n\t\t\t\t\tparents[i] = _fixIndex(parents[i]);\r\n\t\t\t}\r\n\t\t\tif ($.isBoolean(ajax)) { // Ajax\r\n\t\t\t\tvar pvalues = parents.map(function(parent) {\r\n\t\t\t\t\treturn getOptionValues(parent, form); // Save the initial values of the parent lists\r\n\t\t\t\t});\r\n\t\t\t\tactions.push([id, pvalues, ajax, false]);\r\n\t\t\t} else { // Non-Ajax\r\n\t\t\t\tupdateOptions.call(this, id, parents, null, false);\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Update the Ajax lists\r\n\t\tfor (var i = 0; i < actions.length; i++) {\r\n\t\t\tpromises.push(new Promise(function(resolve, reject) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tresolve(updateOptions.apply(self, actions.shift()));\r\n\t\t\t\t}, ew.AJAX_DELAY * i); // Delay a little in case of large number of lists\r\n\t\t\t}));\r\n\t\t}\r\n\t\tPromise.all(promises).then(function() {\r\n\t\t\t$(document).trigger(\"updatedone\", [{source: self, target: form}]);\r\n\t\t}).catch(function(error) {\r\n\t\t\tconsole.log(error);\r\n\t\t});\r\n\t}\r\n\r\n\t// Create AutoSuggest\r\n\tthis.createAutoSuggest = function(settings) {\r\n\t\tvar id = settings.id;\r\n\t\tsettings.form = this;\r\n\t\tvar options = Object.assign({}, ew.autoSuggestSettings, { limit: ew.AUTO_SUGGEST_MAX_ENTRIES }, settings); // Global settings + field specific settings\r\n\t\tvar nid = id.replace(/^[xy](\\d*|\\$rowindex\\$)_/, \"x_\");\r\n\t\tvar data = Object.assign({}, self.lists[nid], { options: null, template: null });\r\n\t\tif (!(self.autoSuggests[id] instanceof AutoSuggest))\r\n\t\t\toptions.data = data;\r\n\t\tself.autoSuggests[id] = new AutoSuggest(options);\r\n\t}\r\n\r\n\t// Init editors\r\n\tthis.initEditors = function() {\r\n\t\tvar form = this.getForm();\r\n\t\t$(form.elements).filter(\"textarea.editor\").each(function(i, el) {\r\n\t\t\tvar ed = $(el).data(\"editor\");\r\n\t\t\tif (ed && !ed.active && !ed.name.includes(\"$rowindex$\"))\r\n\t\t\t\ted.create();\r\n\t\t});\r\n\t}\r\n\r\n\t// Update textareas\r\n\tthis.updateTextArea = function(name) {\r\n\t\tvar form = this.getForm();\r\n\t\t$(form.elements).filter(\"textarea.editor\").each(function(i, el) {\r\n\t\t\tvar ed = $(el).data(\"editor\");\r\n\t\t\tif (!ed || name && ed.name != name)\r\n\t\t\t\treturn true; // Continue\r\n\t\t\ted.save();\r\n\t\t\tif (name)\r\n\t\t\t\treturn false; // Break\r\n\t\t});\r\n\t}\r\n\r\n\t// Destroy editor(s)\r\n\tthis.destroyEditor = function(name) {\r\n\t\tvar form = this.getForm();\r\n\t\t$(form.elements).filter(\"textarea.editor\").each(function(i, el) {\r\n\t\t\tvar ed = $(el).data(\"editor\");\r\n\t\t\tif (!ed || name && ed.name != name)\r\n\t\t\t\treturn true; // Continue\r\n\t\t\ted.destroy();\r\n\t\t\tif (name)\r\n\t\t\t\treturn false; // Break\r\n\t\t});\r\n\t}\r\n\r\n\t// Show error message\r\n\tthis.onError = function(el, msg) {\r\n\t\treturn onError(this, el, msg);\r\n\t}\r\n\r\n\t// Init file upload\r\n\tthis.initUpload = function() {\r\n\t\tvar form = this.getForm();\r\n\t\t$(form.elements).filter(\"input:file:not([name*='$rowindex$'],[id='importfiles'])\").each(function(index) {\r\n\t\t\t$.later(ew.AJAX_DELAY * index, null, upload, this); // Delay a little in case of large number of upload fields\r\n\t\t});\r\n\t}\r\n\r\n\t// Set up filters\r\n\tthis.setupFilters = function(e, filters) {\r\n\t\tvar id = this.id, data = this.filterList ? this.filterList.data : null, $sf = $(\".ew-save-filter[data-form=\" + id + \"]\").toggleClass(\"disabled\", !data),\r\n\t\t\t$df = $(\".ew-delete-filter[data-form=\" + id + \"]\").toggleClass(\"disabled\", !filters.length).toggleClass(\"dropdown-toggle\", !!filters.length),\r\n\t\t\t$delete = $df.parent(\"li\").toggleClass(\"dropdown-submenu dropdown-hover\", !!filters.length).toggleClass(\"disabled\", !filters.length),\r\n\t\t\t$save = $sf.parent(\"li\").toggleClass(\"disabled\", !data),\r\n\t\t\t$btn = $(e.target);\r\n\t\tvar saveFilters = function(id, filters) {\r\n\t\t\tif (ew.SEARCH_FILTER_OPTION == \"Client\") {\r\n\t\t\t\twindow.localStorage.setItem(id + \"_filters\", JSON.stringify(filters));\r\n\t\t\t} else if (ew.SEARCH_FILTER_OPTION == \"Server\") {\r\n\t\t\t\t$body = $(\"body\");\r\n\t\t\t\t$body.css(\"cursor\", \"wait\");\r\n\t\t\t\t$.ajax(currentPage(), {\r\n\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\tdataType: \"json\",\r\n\t\t\t\t\tdata: { \"ajax\": \"savefilters\", \"filters\": JSON.stringify(filters) }\r\n\t\t\t\t}).done(function(result) {\r\n\t\t\t\t\tif (result[0] && result[0].success)\r\n\t\t\t\t\t\tself.filterList.filters = filters; // Save filters\r\n\t\t\t\t}).always(function() {\r\n\t\t\t\t\t$body.css(\"cursor\", \"default\");\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\t$save.off(\"click.ew\").on(\"click.ew\", function(e) { // Save filter\r\n\t\t\tif ($save.hasClass(\"disabled\"))\r\n\t\t\t\treturn false;\r\n\t\t\t_prompt(ew.language.phrase(\"EnterFilterName\"), function(name) {\r\n\t\t\t\tfilters.push([name, data]);\r\n\t\t\t\tsaveFilters(id, filters);\r\n\t\t\t}, true);\r\n\t\t}).prevAll().remove();\r\n\t\t$df.next(\"ul.dropdown-menu\").remove();\r\n\t\tif (filters.length) {\r\n\t\t\tvar $menu = $df.closest(\"ul.dropdown-menu\");\r\n\t\t\tvar $submenu = $(\"<ul class='dropdown-menu'></ul>\");\r\n\t\t\tfor (var i in filters) {\r\n\t\t\t\tif (!$.isArray(filters[i]))\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t$('<li><a class=\"dropdown-item\" data-index=\"' + i + '\" href=\"#\" onclick=\"return false;\">' + filters[i][0] + '</a></li>').on(\"click\", function(e) { // Delete\r\n\t\t\t\t\tvar i = $(this).find(\"a[data-index]\").data(\"index\");\r\n\t\t\t\t\t_prompt(ew.language.phrase(\"DeleteFilterConfirm\").replace(\"%s\", filters[i][0]), function(result) {\r\n\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\tfilters.splice(i, 1);\r\n\t\t\t\t\t\t\tsaveFilters(id, filters);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}).appendTo($submenu);\r\n\t\t\t\t$('<li><a class=\"dropdown-item ew-filter-list\" data-index=\"' + i + '\" href=\"#\" onclick=\"return false;\">' + filters[i][0] + '</a></li>').insertBefore($save).on(\"click\", function(e) {\r\n\t\t\t\t\tvar i = $(this).find(\"a[data-index]\").data(\"index\");\r\n\t\t\t\t\t$(\"<form>\").attr({method: \"post\", action: currentPage()})\r\n\t\t\t\t\t\t.append($(\"<input type='hidden'>\").attr({name: \"cmd\", value: \"resetfilter\"}),\r\n\t\t\t\t\t\t\t//***$(\"<input type='hidden'>\").attr({name: ew.TOKEN_NAME, value: ew.ANTIFORGERY_TOKEN}),\r\n\t\t\t\t\t\t\t$(\"<input type='hidden'>\").attr({name: ew.TOKEN_NAME_KEY, value: ew.TOKEN_NAME}), //*** PHP\r\n\t\t\t\t\t\t\t$(\"<input type='hidden'>\").attr({name: ew.ANTIFORGERY_TOKEN_KEY, value: ew.ANTIFORGERY_TOKEN}), //*** PHP\r\n\t\t\t\t\t\t\t$(\"<input type='hidden'>\").attr({name: \"filter\", value: JSON.stringify(filters[i][1])}))\r\n\t\t\t\t\t\t.appendTo(\"body\").submit();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t$(\"<li class='dropdown-divider'></li>\").insertBefore($save);\r\n\t\t\t$delete.append($submenu);\r\n\t\t}\r\n\t}\r\n\r\n\t// Init form\r\n\tthis.init = function() {\r\n\t\tif (this._initiated)\r\n\t\t\treturn;\r\n\r\n\t\t// Filters button\r\n\t\tif (ew.SEARCH_FILTER_OPTION == \"Client\" && window.localStorage || ew.SEARCH_FILTER_OPTION == \"Server\" && ew.IS_LOGGEDIN && !ew.IS_SYS_ADMIN && ew.CURRENT_USER_NAME != \"\") {\r\n\t\t\t$(\".ew-filter-option.\" + this.id + \" .ew-btn-dropdown\").on(\"show.bs.dropdown\", function(e) {\r\n\t\t\t\tvar filters = [];\r\n\t\t\t\tif (ew.SEARCH_FILTER_OPTION == \"Client\") {\r\n\t\t\t\t\tvar item = window.localStorage.getItem(self.id + \"_filters\");\r\n\t\t\t\t\tif (item)\r\n\t\t\t\t\t\tfilters = parseJson(item) || [];\r\n\t\t\t\t} else if (ew.SEARCH_FILTER_OPTION == \"Server\")\r\n\t\t\t\t\tfilters = self.filterList && self.filterList.filters ? self.filterList.filters : [];\r\n\t\t\t\tvar ar = $.grep(filters, function(val) {\r\n\t\t\t\t\tif ($.isArray(val) && val.length == 2)\r\n\t\t\t\t\t\treturn val;\r\n\t\t\t\t});\r\n\t\t\t\tself.setupFilters(e, ar);\r\n\t\t\t});\r\n\t\t\t$(\".ew-filter-option\").show();\r\n\t\t} else {\r\n\t\t\t$(\".ew-filter-option\").hide();\r\n\t\t}\r\n\r\n\t\t// Check form\r\n\t\tvar form = this.getForm(), $form = $(form);\r\n\t\tif (!form)\r\n\t\t\treturn;\r\n\r\n\t\t// Compile templates\r\n\t\tthis.compileTemplates();\r\n\r\n\t\t// Check if Search panel\r\n\t\tvar isSearch = /s(ea)?rch$/.test(this.id);\r\n\r\n\t\t// Search panel\r\n\t\tif (isSearch && this.initSearchPanel && !hasFormData(form))\r\n\t\t\t$(\"#\" + this.id + \"-search-panel\").removeClass(\"show\");\r\n\r\n\t\t// Search panel toggle\r\n\t\t$(\".ew-search-toggle[data-form=\" + this.id + \"]\").on(\"click.bs.button\", function() {\r\n\t\t\t$(\"#\" + $(this).data(\"form\") + \"-search-panel\").collapse(\"toggle\");\r\n\t\t});\r\n\r\n\t\t// Hide search operator column\r\n\t\tif (!$(\".ew-table .ew-search-operator\").text().trim())\r\n\t\t\t$(\".ew-table .ew-search-operator\").parent(\"td\").hide();\r\n\r\n\t\t// Highlight button\r\n\t\tif (isSearch) {\r\n\t\t\t$(\".ew-highlight[data-form=\" + this.id + \"]\").on(\"click.bs.button\", function() {\r\n\t\t\t\t$(\"span.\" + $(this).data(\"name\")).toggleClass(\"ew-highlight-search\");\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Search operators\r\n\t\tif (isSearch) { // Search form\r\n\t\t\t$form.find(\"select[id^=z_]\").each(function() {\r\n\t\t\t\tvar $this = $(this).change();\r\n\t\t\t\tif ($this.val() != \"BETWEEN\")\r\n\t\t\t\t\t$form.find(\"#w_\" + this.id.substr(2)).change();\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Multi-page\r\n\t\tif (this.multiPage)\r\n\t\t\tthis.multiPage.render();\r\n\r\n\t\t// HTML editors\r\n\t\tloadjs.ready([\"editor\"], this.initEditors.bind(this));\r\n\r\n\t\t// Dynamic selection lists\r\n\t\tthis.updateLists();\r\n\r\n\t\t// Init file upload\r\n\t\tthis.initUpload();\r\n\r\n\t\t// Submit/Cancel\r\n\t\tif (this.$element.is(\"form\")) { // Not Grid page\r\n\t\t\t$form.submit(function(e) { // Bind submit event\r\n\t\t\t\treturn self.submit();\r\n\t\t\t});\r\n\t\t\t$form.find(\"[data-field], .ew-priv\").change(function() {\r\n\t\t\t\tif (ew.CONFIRM_CANCEL)\r\n\t\t\t\t\tself.modified = true;\r\n\t\t\t});\r\n\t\t\t$form.find(\"#btn-cancel[data-href]\").click(function() { // Cancel\r\n\t\t\t\tself.updateTextArea();\r\n\t\t\t\tvar href = $(this).data(\"href\");\r\n\t\t\t\tif (self.modified && hasFormData(form)) {\r\n\t\t\t\t\t_prompt(ew.language.phrase(\"ConfirmCancel\"), function(result) {\r\n\t\t\t\t\t\tif (result)\r\n\t\t\t\t\t\t\twindow.location = href;\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\twindow.location = href;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis._initiated = true;\r\n\r\n\t\t// Store form object as data\r\n\t\tthis.$element.data(\"form\", this);\r\n\t}\r\n\r\n\t// Add to the global forms object\r\n\tew.addForm(this);\r\n}","import $ from 'jquery';\r\nimport AutoSuggest from './autosuggest';\r\nimport Form from './form';\r\n\r\nlet $document = $(document),\r\n\t$body = $(\"body\"),\r\n\t_forms = {};\r\n\r\nexport let currentUrl = new URL(window.location);\r\nexport { AutoSuggest, Form };\r\n\r\n// Forms object/function\r\nexport function forms(el) { // id or element\r\n\tvar id = ($.isString(el)) ? el : getForm(el).id;\r\n\treturn _forms[id];\r\n}\r\n\r\n// Add form\r\nexport function addForm(f) {\r\n\t_forms[f.id] = f;\r\n}\r\n\r\n// Remove spinner (immediately)\r\nvar _removeSpinner = ew.removeSpinner;\r\n\r\n// Remove spinner\r\nexport function removeSpinner() {\r\n\tvar timer = $body.data(\"_spinner\");\r\n\tif (timer)\r\n\t\ttimer.cancel();\r\n\ttimer = $.later(500, null, function() {\r\n\t\tif ($document.data(\"_ajax\") !== true) // Ajax not running\r\n\t\t\t_removeSpinner();\r\n\t});\r\n\t$body.data(\"_spinner\", timer);\r\n}\r\n\r\n// Init icon tooltip\r\nexport function initIcons(e) {\r\n\tvar el = (e && e.target) ? e.target : document;\r\n\t$(el).find(\".ew-icon\").closest(\"a, button\").add(\".ew-tooltip\").tooltip({\r\n\t\tcontainer: \"body\",\r\n\t\ttrigger: (ew.IS_MOBILE) ? \"manual\" : \"hover\",\r\n\t\tplacement: \"bottom\",\r\n\t\tsanitizeFn: ew.sanitizeFn\r\n\t});\r\n}\r\n\r\n// Init password options\r\nexport function initPasswordOptions(e) {\r\n\tvar el = (e && e.target) ? e.target : document;\r\n\tvar displayText = function(pwd) {\r\n\t\treturn ew.language.phrase(\"CurrentPassword\") + pwd;\r\n\t}\r\n\tif ($.fn.pStrength && typeof ew.MIN_PASSWORD_STRENGTH != \"undefined\") {\r\n\t\t$(el).find(\".ew-password-strength\").each(function() {\r\n\t\t\tvar $this = $(this);\r\n\t\t\tif (!$this.data(\"pStrength\"))\r\n\t\t\t\t$this.pStrength({\r\n\t\t\t\t\t\"changeBackground\": false,\r\n\t\t\t\t\t\"backgrounds\": [],\r\n\t\t\t\t\t\"passwordValidFrom\": ew.MIN_PASSWORD_STRENGTH,\r\n\t\t\t\t\t\"onPasswordStrengthChanged\": function(strength, percentage) {\r\n\t\t\t\t\t\tvar $this = $(this), $pst = $(\"[id='\" + $this.attr(\"data-password-strength\") + \"']\"), // Do not use #\r\n\t\t\t\t\t\t\t$pb = $pst.find(\".progress-bar\");\r\n\t\t\t\t\t\t$pst.width($this.outerWidth());\r\n\t\t\t\t\t\tif ($this.val()) {\r\n\t\t\t\t\t\t\tvar pct = percentage + \"%\";\r\n\t\t\t\t\t\t\tif (percentage < 25) {\r\n\t\t\t\t\t\t\t\t$pb.addClass(\"bg-danger\").removeClass(\"bg-warning bg-info bg-success\");\r\n\t\t\t\t\t\t\t} else if (percentage < 50) {\r\n\t\t\t\t\t\t\t\t$pb.addClass(\"bg-warning\").removeClass(\"bg-danger bg-info bg-success\");\r\n\t\t\t\t\t\t\t} else if (percentage < 75) {\r\n\t\t\t\t\t\t\t\t$pb.addClass(\"bg-info\").removeClass(\"bg-danger bg-warning bg-success\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$pb.addClass(\"bg-success\").removeClass(\"bg-danger bg-warning bg-info\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t$pb.css(\"width\", pct);\r\n\t\t\t\t\t\t\tif (percentage > 25)\r\n\t\t\t\t\t\t\t\tpct = ew.language.phrase(\"PasswordStrength\").replace(\"%p\", pct);\r\n\t\t\t\t\t\t\t$pb.html(pct);\r\n\t\t\t\t\t\t\t$pst.removeClass(\"d-none\").show();\r\n\t\t\t\t\t\t\t$this.data(\"validated\", percentage >= ew.MIN_PASSWORD_STRENGTH);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$pst.addClass(\"d-none\").hide();\r\n\t\t\t\t\t\t\t$this.data(\"validated\", false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t});\r\n\t}\r\n\tif ($.fn.pGenerator) {\r\n\t\t$(el).find(\".ew-password-generator\").each(function() {\r\n\t\t\tvar $this = $(this);\r\n\t\t\tif (!$this.data(\"pGenerator\"))\r\n\t\t\t\t$this.pGenerator({\r\n\t\t\t\t\t\"passwordLength\": ew.GENERATE_PASSWORD_LENGTH,\r\n\t\t\t\t\t\"uppercase\": ew.GENERATE_PASSWORD_UPPERCASE,\r\n\t\t\t\t\t\"lowercase\": ew.GENERATE_PASSWORD_LOWERCASE,\r\n\t\t\t\t\t\"numbers\": ew.GENERATE_PASSWORD_NUMBER,\r\n\t\t\t\t\t\"specialChars\": ew.GENERATE_PASSWORD_SPECIALCHARS,\r\n\t\t\t\t\t\"onPasswordGenerated\": function(pwd) {\r\n\t\t\t\t\t\tvar $this = $(this);\r\n\t\t\t\t\t\t$(\"#\" + $this.attr(\"data-password-field\")).val(pwd).change().focus().triggerHandler(\"click\"); // Trigger click to remove \"is-invalid\" class (Do not use $this.data)\r\n\t\t\t\t\t\t$(\"#\" + $this.attr(\"data-password-confirm\")).val(pwd);\r\n\t\t\t\t\t\t$(\"#\" + $this.attr(\"data-password-strength\")).addClass(\"d-none\").hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t});\r\n\t}\r\n}\r\n\r\n// Get API action URL\r\nexport function getApiUrl(action, query) {\r\n\tvar url = ew.RELATIVE_PATH + ew.API_URL, params = new URLSearchParams(query);\r\n\tif (ew.USE_URL_REWRITE) {\r\n\t\tif ($.isString(action)) { // Route as string\r\n\t\t\turl += action ? action : \"\";\r\n\t\t} else if ($.isArray(action)) { // Route as array\r\n\t\t\tvar route = action.map(function(v) {\r\n\t\t\t\treturn encodeURIComponent(v);\r\n\t\t\t}).join(\"/\");\r\n\t\t\turl += route ? route : \"\";\r\n\t\t}\r\n\t} else {\r\n\t\tif (action)\r\n\t\t\tparams.set(ew.API_ACTION_NAME, action);\r\n\t}\r\n\tvar qs = params.toString();\r\n\treturn url + (qs ? \"?\" + qs : \"\");\r\n}\r\n\r\n// Set session timer\r\nexport function setSessionTimer() {\r\n\tvar timeoutTime, timer1, timer2, timer3, counter, $dlg = $(\"#ew-timer\"),\r\n\t\tuseKeepAlive = (ew.SESSION_KEEP_ALIVE_INTERVAL > 0 || ew.IS_LOGGEDIN && ew.IS_AUTOLOGIN);\r\n\t// Keep alive\r\n\tvar keepAlive =\tfunction() {\r\n\t\t$.get(getApiUrl(ew.API_SESSION_ACTION), { \"rnd\": random() }, function(token) {\r\n\t\t\t//*** to be tested for csrf\r\n\t\t\t//ew.ANTIFORGERY_TOKEN = token;\r\n\t\t\t//$(\"input:hidden[name=\" + ew.TOKEN_NAME + \"]\").val(token);\r\n\t\t\tif (token && $.isObject(token)) { //*** PHP\r\n\t\t\t\tew.TOKEN_NAME = token[ew.TOKEN_NAME_KEY];\r\n\t\t\t\tew.ANTIFORGERY_TOKEN = token[ew.ANTIFORGERY_TOKEN_KEY];\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t// Onclick handler of modal\r\n\t$dlg.find(\".modal-footer .btn-primary\").click(function(e) {\r\n\t\tif (timer2)\r\n\t\t\ttimer2.cancel(); // Clear timer2\r\n\t\t$dlg.modal(\"hide\");\r\n\t\tkeepAlive();\r\n\t\tif (!useKeepAlive && ew.SESSION_TIMEOUT > 0)\r\n\t\t\tsetTimer();\r\n\t});\r\n\t// Reset timer\r\n\tvar resetTimer = function() {\r\n\t\tcounter = ew.SESSION_TIMEOUT_COUNTDOWN;\r\n\t\ttimeoutTime = ew.SESSION_TIMEOUT - ew.SESSION_TIMEOUT_COUNTDOWN;\r\n\t\tif (timeoutTime < 0) { // Timeout now\r\n\t\t\ttimeoutTime = 0;\r\n\t\t\tcounter = ew.SESSION_TIMEOUT;\r\n\t\t}\r\n\t\tif (timer2)\r\n\t\t\ttimer2.cancel(); // Clear timer2\r\n\t\tif (timer1)\r\n\t\t\ttimer1.cancel(); // Clear timer1\r\n\t};\r\n\t// Timeout\r\n\tvar timeout = function() {\r\n\t\tif (timer3)\r\n\t\t\ttimer3.cancel(); // Stop keep alive\r\n\t\ttimer2 = $.later(1000, null, function() { // Create a timer that runs every second\r\n\t\t\tif (counter > 0) {\r\n\t\t\t\t$dlg.find(\".modal-body\").html('<p class=\"text-danger\">' + ew.language.phrase(\"SessionWillExpire\").replace(\"%s\", counter) + '</p>');\r\n\t\t\t\t$dlg.modal(\"show\");\r\n\t\t\t} else { // Counter = 0, log out\r\n\t\t\t\t$dlg.find(\".modal-body\").html('<p class=\"text-danger\">' + ew.language.phrase(\"SessionExpired\") + '</p>');\r\n\t\t\t\tresetTimer();\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t$dlg.modal(\"hide\");\r\n\t\t\t\t\twindow.location = ew.TIMEOUT_URL + \"?expired=1\";\r\n\t\t\t\t}, 1000); // Redirect after 1 second\r\n\t\t\t};\r\n\t\t\tcounter--;\r\n\t\t}, null, true); // Periodic\r\n\t};\r\n\t// Set timer\r\n\tvar setTimer = function() {\r\n\t\tresetTimer(); // Reset timer first\r\n\t\ttimer1 = $.later(timeoutTime * 1000, null, timeout);\r\n\t};\r\n\tif (useKeepAlive) { // Keep alive\r\n\t\tvar keepAliveInterval = (ew.SESSION_KEEP_ALIVE_INTERVAL > 0) ? ew.SESSION_KEEP_ALIVE_INTERVAL : ew.SESSION_TIMEOUT - ew.SESSION_TIMEOUT_COUNTDOWN;\r\n\t\tif (keepAliveInterval <= 0) keepAliveInterval = 60;\r\n\t\ttimer3 = $.later(keepAliveInterval * 1000, null, keepAlive, null, true); // Periodic\r\n\t} else {\r\n\t\tif (ew.SESSION_TIMEOUT > 0) // Set session timeout\r\n\t\t\tsetTimer();\r\n\t}\r\n}\r\n\r\n// Init export links\r\nexport function initExportLinks(e) {\r\n\tvar el = (e && e.target) ? e.target : document;\r\n\t$(el).find(\".ew-export-link[href]:not(.ew-email):not(.ew-print):not(.ew-xml)\").click(function(e) {\r\n\t\tvar $dlg, $this = $(this), href = $this.attr(\"href\");\r\n\t\tif (href && href != \"#\")\r\n\t\t\tfileDownload(href);\r\n\t\te.preventDefault();\r\n\t});\r\n}\r\n\r\n// Init multi-select checkboxes\r\nexport function initMultiSelectCheckboxes(e) {\r\n\tvar el = (e && e.target) ? e.target : document,\r\n\t\t$el = $(el),\r\n\t\t$cbs = $el.find(\"input[type=checkbox].ew-multi-select\");\r\n\tvar _update = function(id) {\r\n\t\tvar $els = $cbs.filter(\"[name^='\" + id + \"_']\"), cnt = $els.length, len = $els.filter(\":checked\").length;\r\n\t\t$els.closest(\"form\").find(\"input[type=checkbox]#\" + id)\r\n\t\t\t.prop(\"checked\", len == cnt).prop(\"indeterminate\", len != cnt && len != 0);\r\n\t};\r\n\t$cbs.click(function(e) {\r\n\t\t_update(this.name.split(\"_\")[0]);\r\n\t});\r\n\t$el.find(\"input[type=checkbox].ew-priv:not(.ew-multi-select)\").each(function() {\r\n\t\t_update(this.id); // Init\r\n\t});\r\n}\r\n\r\n// Download file\r\nexport function fileDownload(href, data) {\r\n\tvar $dlg, $ = (window.location != window.parent.location && window.parent.jQuery) ? window.parent.jQuery : jQuery;\r\n\t$body.css(\"cursor\", \"wait\");\r\n\tif (ew.SHOW_EXPORT_DIALOG) {\r\n\t\t$dlg = $(\"#ew-message-box\");\r\n\t\t$dlg.find(\".modal-body\").html(\"<p>\" + ew.language.phrase(\"Exporting\") + \"</p>\");\r\n\t\t$dlg.find(\".modal-footer button\").prop(\"disabled\", true);\r\n\t\t$dlg.modal(\"show\");\r\n\t}\r\n\tvar method = (data) ? \"POST\" : \"GET\";\r\n\t$.ajax({\r\n\t\turl: href,\r\n\t\ttype: method,\r\n\t\tcache: false,\r\n\t\tdata: data || null,\r\n\t\txhrFields: { responseType: \"blob\" }\r\n\t}).done(function(data, textStatus, jqXHR) {\r\n\t\tvar url = window.URL.createObjectURL(data),\r\n\t\t\ta = document.createElement(\"a\"),\r\n\t\t\tcd = jqXHR.getResponseHeader(\"Content-Disposition\");\r\n\t\ta.style.display = \"none\";\r\n\t\ta.href = url;\r\n\t\ta.download = cd.includes(\"attachment; filename=\"); //*** test!\r\n\t\tdocument.body.appendChild(a);\r\n\t\ta.click();\r\n\t\twindow.URL.revokeObjectURL(url);\r\n\t\tif (ew.SHOW_EXPORT_DIALOG)\r\n\t\t\t$dlg.modal(\"hide\");\r\n\t\t$document.trigger(\"export\", [{ \"type\": \"done\", \"url\": url }]);\r\n\t}).fail(function(){\r\n\t\tif (ew.SHOW_EXPORT_DIALOG)\r\n\t\t\t$dlg.find(\".modal-body\").html(\"<div class='text-danger'><h4>\" + ew.language.phrase(\"FailedToExport\") + \"</h4>\" + response + \"</div>\");\r\n\t\t$document.trigger(\"export\", [{ \"type\": \"fail\", \"url\": url }]);\r\n\t}).always(function() {\r\n\t\tif (ew.SHOW_EXPORT_DIALOG)\r\n\t\t\t$dlg.find(\".modal-footer button\").prop(\"disabled\", false);\r\n\t\t$body.css(\"cursor\", \"default\");\r\n\t\t$document.trigger(\"export\", [{ \"type\": \"always\", \"url\": href }]);\r\n\t});\r\n}\r\n\r\n// Lazy load images\r\nexport function lazyLoad(e) {\r\n\tif (!ew.LAZY_LOAD)\r\n\t\treturn;\r\n\tvar el = (e && e.target) ? e.target : document, $el = $(el),\r\n\t\t$els = $el.find(\"img.ew-lazy\"), bundleIds = [];\r\n\t$els.each(function(index) {\r\n\t\tvar self = this, $self = $(self), src = $self.data(\"src\"), bundleId = ($el.attr(\"id\") || \"\") +  \"lazyload\" + random();\r\n\t\tbundleIds.push(bundleId);\r\n\t\tloadjs(\"img!\" + src, bundleId, {\r\n\t\t\tsuccess: function() {\r\n\t\t\t\tself.src = src;\r\n\t\t\t},\r\n\t\t\tnumRetries: ew.LAZY_LOAD_RETRIES\r\n\t\t});\r\n\t});\r\n\tloadjs.ready(bundleIds, function() {\r\n\t\t$document.trigger(\"lazyload\"); // All images loaded\r\n\t});\r\n}\r\n\r\n// Colorboxes\r\nexport function initLightboxes(e) {\r\n\tif (!ew.USE_COLORBOX)\r\n\t\treturn;\r\n\tvar el = (e && e.target) ? e.target : document;\r\n\tvar settings = Object.assign({}, ew.lightboxSettings, {\r\n\t\ttitle: ew.language.phrase(\"LightboxTitle\"),\r\n\t\tcurrent: ew.language.phrase(\"LightboxCurrent\"),\r\n\t\tprevious: ew.language.phrase(\"LightboxPrevious\"),\r\n\t\tnext: ew.language.phrase(\"LightboxNext\"),\r\n\t\tclose: ew.language.phrase(\"LightboxClose\"),\r\n\t\txhrError: ew.language.phrase(\"LightboxXhrError\"),\r\n\t\timgError: ew.language.phrase(\"LightboxImgError\")\r\n\t});\r\n\t$(el).find(\".ew-lightbox\").each(function() {\r\n\t\tvar $this = $(this);\r\n\t\t$this.colorbox(Object.assign({ rel: $this.data(\"rel\") }, settings));\r\n\t});\r\n}\r\n\r\n// PDFObjects\r\nexport function initPdfObjects(e) {\r\n\tif (!ew.EMBED_PDF)\r\n\t\treturn;\r\n\tvar el = (e && e.target) ? e.target : document,\r\n\t\toptions = Object.assign({}, ew.PDFObjectOptions);\r\n\t$(el).find(\".ew-pdfobject\").not(\":has(.pdfobject)\").each(function() { // Not already embedded\r\n\t\tvar $this = $(this), url = $this.data(\"url\"), html = $this.html();\r\n\t\tif (url)\r\n\t\t\tPDFObject.embed(url, this, Object.assign(options, { fallbackLink: html }));\r\n\t});\r\n}\r\n\r\n// Tooltips and popovers\r\nexport function initTooltips(e) {\r\n\tvar el = (e && e.target) ? e.target : document, $el = $(el);\r\n\t$el.find(\"input[data-toggle=tooltip],textarea[data-toggle=tooltip],select[data-toggle=tooltip]\").each(function() {\r\n\t\tvar $this = $(this);\r\n\t\t$this.tooltip(Object.assign({ html: true, placement: \"bottom\", sanitizeFn: ew.sanitizeFn }, $this.data()));\r\n\t});\r\n\t$el.find(\"a.ew-tooltip-link\").each(tooltip); // Init tooltips\r\n\t$el.find(\".ew-tooltip\").tooltip({ placement: \"bottom\", sanitizeFn: ew.sanitizeFn });\r\n\t$el.find(\".ew-popover\").popover({ sanitizeFn: ew.sanitizeFn });\r\n}\r\n\r\n// Parse JSON\r\nfunction parseJson(data) {\r\n\tif ($.isString(data)) {\r\n\t\ttry {\r\n\t\t\treturn JSON.parse(data);\r\n\t\t} catch(e) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\treturn data;\r\n}\r\n\r\n// Change search operator\r\nexport function searchOperatorChanged(el) {\r\n\tvar $el = $(el), $p = $el.closest(\"[id^=r_], [id^=xsc_]\"), parm = el.id.substr(2),\r\n\t\t$fld = $p.find(\".ew-search-field\"), $x = $fld.find(\"[name='x_\" + parm + \"'], [name='x_\" + parm + \"[]']\"),\r\n\t\t$fld2 = $p.find(\".ew-search-field2\"), $y = $fld2.find(\"[name='y_\" + parm + \"'], [name='y_\" + parm + \"[]']\"), hasY = $y.length,\r\n\t\t$cond = $p.find(\".ew-search-cond\"), hasCond = $cond.length, // Has condition and operator 2\r\n\t\t$and = $p.find(\".ew-search-and\"),\r\n\t\t$opr = $p.find(\".ew-search-operator\"), opr = $opr.find(\"[name='z_\" + parm + \"']\").val(),\r\n\t\t$opr2 = $p.find(\".ew-search-operator2\"), opr2 = $opr2.find(\"[name='w_\" + parm + \"']\").val(),\r\n\t\tisBetween = opr == \"BETWEEN\", // Can only be operator 1\r\n\t\tisNullOpr = [\"IS NULL\", \"IS NOT NULL\"].includes(opr), isNullOpr2 = [\"IS NULL\", \"IS NOT NULL\"].includes(opr2),\r\n\t\thideOpr2 = !hasY || isBetween, hideX = isNullOpr, hideY = !isBetween && (!hasCond || isNullOpr2);\r\n\t$cond.toggleClass(\"d-none\", hideOpr2).find(\":input\").prop(\"disabled\", hideOpr2);\r\n\t$and.toggleClass(\"d-none\", !isBetween);\r\n\t$opr2.toggleClass(\"d-none\", hideOpr2).find(\":input\").prop(\"disabled\", hideOpr2);\r\n\t$fld.toggleClass(\"d-none\", hideX).find(\":input\").prop(\"disabled\", hideX);\r\n\t$fld2.toggleClass(\"d-none\", hideY).find(\":input\").prop(\"disabled\", hideY);\r\n}\r\n\r\n// Init forms\r\nfunction initForms(e) {\r\n\tvar el = (e && e.target) ? e.target : document, $el = $(el);\r\n\tfor (var id in forms) {\r\n\t\tif ($el.find(\"#\" + id))\r\n\t\t\t_forms[id].init();\r\n\t}\r\n}\r\n\r\n// Prompt/Confirm/Alert\r\nfunction _prompt(text, cb, input) {\r\n\tvar $dlg = $(\"#ew-prompt\"), $bd = $dlg.find(\".modal-body\").empty();\r\n\tif (input) { // Prompt\r\n\t\t$bd.append('<div class=\"form-group row\">' +\r\n\t\t\t'<label class=\"col-form-label\">' + text + '</label>' +\r\n\t\t\t'<input type=\"text\" class=\"form-control d-block w-100\"></div>');\r\n\t\tvar $input = $bd.find(\"input\").click(function() {\r\n\t\t\t$input.removeClass(\"is-invalid\");\r\n\t\t});\r\n\t\t$dlg.find(\".modal-footer .btn-primary\").off().click(function(e) { // OK button\r\n\t\t\tvar val = $input.val().trim();\r\n\t\t\tif (val == \"\") {\r\n\t\t\t\t$input.addClass(\"is-invalid\");\r\n\t\t\t\t$input[0].focus();\r\n\t\t\t} else {\r\n\t\t\t\t$dlg.modal(\"hide\");\r\n\t\t\t\tif ($.isFunction(cb))\r\n\t\t\t\t\tcb(val);\r\n\t\t\t}\r\n\t\t});\r\n\t\t$dlg.on(\"shown.bs.modal\", function(e) {\r\n\t\t\t$input[0].focus();\r\n\t\t});\r\n\t} else { // Confirm or Alert\r\n\t\t$bd.append(\"<div>\" + text + \"</div>\");\r\n\t\t$dlg.find(\".modal-footer .btn-primary\").off().click(function(e) { // OK button\r\n\t\t\t$dlg.modal(\"hide\");\r\n\t\t\tif ($.isFunction(cb))\r\n\t\t\t\tcb(true);\r\n\t\t});\r\n\t\tif (cb) { // Confirm\r\n\t\t\t$dlg.find(\".modal-footer .btn-default\").off().click(function(e) { // Cancel button\r\n\t\t\t\t$dlg.modal(\"hide\");\r\n\t\t\t\tif ($.isFunction(cb))\r\n\t\t\t\t\tcb(false);\r\n\t\t\t}).show();\r\n\t\t} else { // Alert\r\n\t\t\t$dlg.find(\".modal-footer .btn-default\").hide();\r\n\t\t}\r\n\t}\r\n\t$dlg.modal(\"show\");\r\n}\r\n\r\nexport { _prompt as prompt };\r\n\r\n// Get .ew-form element (form/div)\r\nexport function getForm(el) {\r\n\tif (el instanceof Form)\r\n\t\treturn el.$element[0];\r\n\tvar $el = $(el), $f = $el.closest(\".ew-form\");\r\n\tif (!$f[0]) // Element not inside form\r\n\t\t$f = $el.closest(\".ew-grid, .ew-multi-column-grid\").find(\".ew-form\").not(\".ew-pager-form\");\r\n\treturn $f[0];\r\n}\r\n\r\n// Check form data\r\nexport function hasFormData(form) {\r\n\tvar selector = \"[name^=x_][value!='{value}'],[name^=y_],[name^=z_],[name^=w_],[name=psearch]\",\r\n\t\tels = $(form).find(selector).filter(\":enabled\").get();\r\n\tfor (var i = 0, len = els.length; i < len; i++) {\r\n\t\tvar el = els[i];\r\n\t\tif (/^(z|w)_/.test(el.name)) {\r\n\t\t\tif (/^IS/.test($(el).val()))\r\n\t\t\t\treturn true;\r\n\t\t} else if (el.type == \"checkbox\" || el.type == \"radio\") {\r\n\t\t\tif (el.checked)\r\n\t\t\t\treturn true;\r\n\t\t} else if (el.type == \"select-one\" || el.type == \"select-multiple\") {\r\n\t\t\tif (!!$(el).val())\r\n\t\t\t\treturn true;\r\n\t\t} else if (el.type == \"text\" || el.type == \"hidden\" || el.type == \"textarea\") {\r\n\t\t\tif (el.value)\r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n// Set search type\r\nexport function setSearchType(el, val) {\r\n\tvar $this = $(el), $form = $this.closest(\"form\"), text = \"\";\r\n\t$form.find(\"input[name=psearchtype]\").val(val || \"\");\r\n\tif (val == \"=\") {\r\n\t\ttext = ew.language.phrase(\"QuickSearchExactShort\");\r\n\t} else if (val == \"AND\") {\r\n\t\ttext = ew.language.phrase(\"QuickSearchAllShort\");\r\n\t} else if (val == \"OR\") {\r\n\t\ttext = ew.language.phrase(\"QuickSearchAnyShort\");\r\n\t} else {\r\n\t\ttext = ew.language.phrase(\"QuickSearchAutoShort\");\r\n\t}\r\n\t$form.find(\"#searchtype\").html(text + ((text) ? \"&nbsp;\" : \"\"));\r\n\t$this.closest(\"ul\").find(\"li\").removeClass(\"active\");\r\n\t$this.closest(\"li\").addClass(\"active\");\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * Update a dynamic selection list\r\n *\r\n * @param {(HTMLElement|HTMLElement[]|string|string[])} obj - Target HTML element(s) or the ID of the element(s)\r\n * @param {(string[]|array[])} parentId - Parent field element names or data\r\n * @param {(boolean|null)} async - async(true) or sync(false) or non-Ajax(null)\r\n * @param {boolean} change - Trigger onchange event\r\n * @returns\r\n */\r\nexport function updateOptions(obj, parentId, async, change) {\r\n\tvar f = (this.$element) ? this.$element[0] : (this.form) ? this.form : null; // Get form/div element from this\r\n\tif (!f)\r\n\t\treturn;\r\n\tvar frm = (this._form) ? this : _forms[f.id]; // Get Form object\r\n\tif (!frm)\r\n\t\treturn;\r\n\tif (this.form && $.isUndefined(obj)) // Target unspecified\r\n\t\tobj = forms(this).lists[this.name.replace(/^(sv_)?[xy]\\d*_/, \"x_\")].childFields.slice(); // Clone\r\n\telse if ($.isString(obj))\r\n\t\tobj = getElements(obj, f);\r\n\tif (!obj || $.isArray(obj) && obj.length == 0)\r\n\t\treturn;\r\n\tvar self = this, promise = Promise.resolve();\r\n\tif ($.isArray(obj) && $.isString(obj[0])) { // Array of id (onchange/onclick event)\r\n\t\tfor (var i = 0, len = obj.length; i < len; i++) {\r\n\t\t\tvar ar = obj[i].split(\" \");\r\n\t\t\tif (ar.length == 1 && self.form) { // Parent/Child fields in the same table\r\n\t\t\t\tvar m = getId(self, false).match(/^([xy]\\d*_)/);\r\n\t\t\t\tif (m)\r\n\t\t\t\t\tobj[i] = obj[i].replace(/^([xy]\\d*_)/, m[1]);\r\n\t\t\t}\r\n\t\t\tvar el = getElements(obj[i], f), names = [];\r\n\t\t\tif (ar.length == 2 && $.isArray(el)) { // Check if id is \"tblvar fldvar\" and multiple inputs\r\n\t\t\t\tvar $el = $(el);\r\n\t\t\t\t$el.each(function() {\r\n\t\t\t\t\tif (!names.includes(this.name)) {\r\n\t\t\t\t\t\tnames.push(this.name);\r\n\t\t\t\t\t\tvar $elf = $el.filter(\"[name='\" + this.name + \"']\"), typ = $elf.attr(\"type\"),\r\n\t\t\t\t\t\t\telf = [\"radio\", \"checkbox\"].includes(typ) ? $elf.get() : $elf[0];\r\n\t\t\t\t\t\tpromise = promise.then(_updateOptions.bind(self, elf, parentId, async, change));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tpromise = promise.then(_updateOptions.bind(self, el, parentId, async, change));\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar list = forms(self).lists[self.name.replace(/^[xy]\\d*_/, \"x_\")];\r\n\t\tif (list && $.isArray(list.autoFillTargetFields) && list.autoFillTargetFields[0]) // AutoFill\r\n\t\t\tpromise = promise.then(autoFill.bind(null, self));\r\n\t} else {\r\n\t\tpromise = promise.then(_updateOptions.bind(self, obj, parentId, async, change));\r\n\t}\r\n\treturn promise.then(function() { $document.trigger(\"updatedone\", [{ source: self, target: obj }]); });\r\n}\r\n\r\n/**\r\n * Update a dynamic selection list\r\n *\r\n * @param {(HTMLElement|HTMLElement[]} obj - Target HTML element(s) or the ID of the element(s)\r\n * @param {(string[]|array[])} parentId - Parent field element names or data\r\n * @param {(boolean|null)} async - async(true) or sync(false) or non-Ajax(null)\r\n * @param {boolean} change - Trigger onchange event\r\n * @returns Promise\r\n */\r\nfunction _updateOptions(obj, parentId, async, change) {\r\n\tvar self = this,\r\n\t\targs = $.makeArray(arguments),\r\n\t\tar = getOptionValues(obj),\r\n\t\toid = getId(obj, false);\r\n\tif (!oid)\r\n\t\treturn;\r\n\tvar fo = getForm(obj); // Get form/div element from obj\r\n\tif (!fo || !fo.id)\r\n\t\treturn;\r\n\tvar frmo = _forms[fo.id];\r\n\tif (!frmo)\r\n\t\treturn;\r\n\tvar m = oid.match(/^([xy])(\\d*)_/),\r\n\t\tprefix = (m) ? m[1] : \"\",\r\n\t\trowindex = (m) ? m[2] : \"\",\r\n\t\tnid = oid.replace(/^([xy])(\\d*)_/, \"x_\"),\r\n\t\tarp = [],\r\n\t\tlist = frmo.lists[nid];\r\n\tif ($.isUndefined(parentId)) { // Parent IDs not specified, use default\r\n\t\tparentId = list.parentFields.slice(); // Clone\r\n\t\tif (rowindex != \"\") {\r\n\t\t\tfor (var i = 0, len = parentId.length; i < len; i++) {\r\n\t\t\t\tvar arr = parentId[i].split(\" \");\r\n\t\t\t\tif (arr.length == 1) // Parent field in the same table, add row index\r\n\t\t\t\t\tparentId[i] = parentId[i].replace(/^x_/, \"x\" + rowindex + \"_\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif ($.isArray(parentId) && parentId.length > 0) {\r\n\t\tif ($.isArray(parentId[0])) { // Array of array => data\r\n\t\t\tarp = parentId;\r\n\t\t} else if ($.isString(parentId[0])) { // Array of string => Parent IDs\r\n\t\t\tfor (var i = 0, len = parentId.length; i < len; i++)\r\n\t\t\t\tarp.push(getOptionValues(parentId[i], fo));\r\n\t\t}\r\n\t}\r\n\tif (!isAutoSuggest(obj)) // Do not clear Auto-Suggest\r\n\t\tclearOptions(obj);\r\n\tvar addOpt = function(results) {\r\n\t\tvar name = getId(obj);\r\n\t\tresults.forEach(function(result) {\r\n\t\t\tvar args = {\"data\": result, \"parents\": arp, \"valid\": true, \"name\": name, \"form\": fo};\r\n\t\t\t$document.trigger(\"addoption\", [args]);\r\n\t\t\tif (args.valid)\r\n\t\t\t\tnewOption(obj, result, fo);\r\n\t\t});\r\n\t\tif (!obj.options && obj.length) { // Radio/Checkbox list\r\n\t\t\trenderOption(obj);\r\n\t\t\tobj = getElements(oid, fo); // Update the list\r\n\t\t}\r\n\t\tselectOption(obj, ar);\r\n\t\tif (change !== false) {\r\n\t\t\tif (!obj.options && obj.length)\r\n\t\t\t\t$(obj).first().triggerHandler(\"click\");\r\n\t\t\telse\r\n\t\t\t\t$(obj).first().change();\r\n\t\t}\r\n\t}\r\n\tif ($.isUndefined(async)) // Async not specified, use default\r\n\t\tasync = list.ajax;\r\n\tvar _updateSibling = function() { // Update the y_* element\r\n\t\tif (/s(ea)?rch$/.test(fo.id) && prefix == \"x\") { // Search form\r\n\t\t\targs[0] = oid.replace(/^x_/, \"y_\");\r\n\t\t\tupdateOptions.apply(self, args); // args[0] is string, use updateOptions()\r\n\t\t}\r\n\t}\r\n\tif (!$.isBoolean(async) || $.isArray(list.options) && list.options.length > 0) { // Non-Ajax or Options loaded\r\n\t\tvar ds = list.options;\r\n\t\taddOpt(ds);\r\n\t\t_updateSibling();\r\n\t\treturn ds;\r\n\t} else { // Ajax\r\n\t\tvar name = getId(obj), data = Object.assign({\r\n\t\t\tpage: list.page,\r\n\t\t\tfield: list.field,\r\n\t\t\tajax: \"updateoption\",\r\n\t\t\tlanguage: ew.LANGUAGE_ID,\r\n\t\t\tname: name // Name of the target element\r\n\t\t}, getUserParams(\"#p_\" + oid, fo)); // Add user parameters\r\n\t\tif (isAutoSuggest(obj) && self._form) // Auto-Suggest (init form or auto-fill)\r\n\t\t\tdata[\"v0\"] = ar[0] ? ar[0] : random(); // Filter by the current value\r\n\t\telse if (isModalLookup(obj)) // Modal-Lookup\r\n\t\t\tdata[\"v0\"] = ar[0] ? ($(obj).data(\"multiple\") ? ar.join(ew.MULTIPLE_OPTION_SEPARATOR) : ar[0]) : random(); // Filter by the current value\r\n\t\tfor (var i = 0, cnt = arp.length; i < cnt; i++) // Filter by parent fields\r\n\t\t\tdata[\"v\" + (i + 1)] = arp[i].join(ew.MULTIPLE_OPTION_SEPARATOR);\r\n\t\treturn $.ajax(getApiUrl(ew.API_LOOKUP_ACTION), {\r\n\t\t\t\t\"type\": \"POST\", \"dataType\": \"json\", \"data\": data, \"async\": async\r\n\t\t\t}).done(function(result) {\r\n\t\t\t\tvar ds = result.records || [];\r\n\t\t\t\taddOpt(ds);\r\n\t\t\t\t_updateSibling();\r\n\t\t\t\treturn ds;\r\n\t\t\t});\r\n\t}\r\n}\r\n\r\n// Get user parameters from id\r\nexport function getUserParams(id, root) {\r\n\tvar id = id.replace(/\\[\\]$/, \"\"), o = {};\r\n\tvar root = !$.isString(root) ? root : /^#/.test(root) ? root : \"#\" + root;\r\n\tvar $els = (root) ? $(root).find(id) : $(id);\r\n\tvar val = $els.val();\r\n\tif (val) {\r\n\t\tvar params = new URLSearchParams(val);\r\n\t\tparams.forEach(function(value, key) {\r\n\t\t\to[key] = value;\r\n\t\t});\r\n\t}\r\n\treturn o;\r\n}\r\n\r\n// Apply client side template to a DIV\r\nexport function applyTemplate(divId, tmplId, classId, exportType, data) { // Note: classId = fileName\r\n\tvar args = {\"data\": data || {}, \"id\": divId, \"template\": tmplId, \"class\": classId, \"export\": exportType, \"enabled\": true};\r\n\t$document.trigger(\"rendertemplate\", [args]);\r\n\tif (args.enabled) {\r\n\t\tvar template = document.getElementById(tmplId).content;\r\n\t\ttemplate.querySelectorAll(\"slot\").forEach(function(el) {\r\n\t\t\tvar subtmpl = document.getElementById(el.name);\r\n\t\t\tif (subtmpl && subtmpl.content)\r\n\t\t\t\tel.replaceWith(subtmpl.content);\r\n\t\t\telse\r\n\t\t\t\tel.remove();\r\n\t\t});\r\n\t\tif (ew.useJsRender && $.views) {\r\n\t\t\tvar textContent = template.textContent;\r\n\t\t\tif (textContent.includes(\"{{\") && textContent.includes(\"}}\")) { // Includes JsRender template\r\n\t\t\t\tvar div = document.createElement(\"div\");\r\n\t\t\t\tdiv.appendChild(template);\r\n\t\t\t\tvar html = div.innerHTML,\r\n\t\t\t\t\ttmpl = $.templates(html);\r\n\t\t\t\tdocument.getElementById(divId).innerHTML = tmpl.render(args.data, ew.jsRenderHelpers);\r\n\t\t\t} else {\r\n\t\t\t\tdocument.getElementById(divId).appendChild(template);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tdocument.getElementById(divId).appendChild(template);\r\n\t\t}\r\n\t}\r\n\tif (exportType && exportType != \"print\") { // Export custom\r\n\t\t$(function() {\r\n\t\t\tvar $meta = $(\"meta[http-equiv='Content-Type']\"),\r\n\t\t\t\thtml = \"<html><head>\",\r\n\t\t\t\t$div = $(\"#\" + divId);\r\n\t\t\tif ($div.children(0).is(\"div[id^=ct_]\")) // Remove first div tag\r\n\t\t\t\t$div = $div.children(0);\r\n\t\t\tif ($meta[0])\r\n\t\t\t\thtml += \"<meta http-equiv='Content-Type' content='\" + $meta.attr(\"content\") + \"'>\";\r\n\t\t\tif (exportType == \"pdf\") {\r\n\t\t\t\thtml += \"<link rel='stylesheet' type='text/css' href='\" + ew.PDF_STYLESHEET_FILENAME + \"'>\";\r\n\t\t\t} else {\r\n\t\t\t\thtml += \"<style>\" + $.ajax({async: false, type: \"GET\", url: ew.PROJECT_STYLESHEET_FILENAME}).responseText + \"</style>\";\r\n\t\t\t}\r\n\t\t\thtml += \"</\" + \"head><body>\";\r\n\t\t\t$(\".ew-chart-top\").each(function() {\r\n\t\t\t\thtml += $(this).html();\r\n\t\t\t});\r\n\t\t\thtml += $div.html();\r\n\t\t\t$(\".ew-chart-bottom\").each(function() {\r\n\t\t\t\thtml += $(this).html();\r\n\t\t\t});\r\n\t\t\thtml += \"</body></html>\";\r\n\t\t\tvar url = currentPage(),\r\n\t\t\t\tdata = { \"customexport\": exportType, \"data\": html, \"filename\": args.class };\r\n\t\t\tdata[ew.TOKEN_NAME] = ew.ANTIFORGERY_TOKEN;\r\n\t\t\tif (exportType == \"email\") {\r\n\t\t\t\tvar str = currentUrl.searchParams.toString() + \"&\" + $.param(data); // Add data\r\n\t\t\t\t$.post(url, str, function(result) {\r\n\t\t\t\t\tshowMessage(result);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tfileDownload(url, data);\r\n\t\t\t}\r\n\t\t\tif (window.location != window.parent.location && window.parent.jQuery) // In iframe\r\n\t\t\t\twindow.parent.jQuery(\"body\").css(\"cursor\", \"default\");\r\n\t\t});\r\n\t}\r\n}\r\n\r\n// Toggle group\r\nexport function toggleGroup(el) {\r\n\tvar $el = $(el), $tr = $el.closest(\"tr\"), selector = \"tr\", level;\r\n\tfor (var i = 1; i <= 6; i++) {\r\n\t\tvar idx = (i == 1) ? \"\" : \"-\" + i;\r\n\t\tvar data = $tr.data(\"group\" + idx);\r\n\t\tif ($.isValue(data)) {\r\n\t\t\tlevel = i;\r\n\t\t\tif (data != \"\")\r\n\t\t\t\tselector += \"[data-group\" + idx + \"='\" + String(data).replace(/'/g, \"\\\\'\") + \"']\";\r\n\t\t}\r\n\t}\r\n\tif ($el.hasClass(\"icon-collapse\")) { // Hide\r\n\t\t$(selector).slice(1).addClass(\"ew-rpt-grp-hide-\" + level);\r\n\t\t$el.toggleClass(\"icon-expand icon-collapse\");\r\n\t} else {\r\n\t\t$(selector).slice(1).removeClass(\"ew-rpt-grp-hide-\" + level);\r\n\t\t$el.toggleClass(\"icon-expand icon-collapse\");\r\n\t}\r\n}\r\n\r\n// Show template\r\nexport function showTemplates(classname) {\r\n\t$(\"script\" + ((classname) ? \".\" + classname : \"\") + \"[type='text/html']\").each(function() {\r\n\t\tvar $scr = $(this),\r\n\t\t\tm = $scr.html().match(/^\\s*(<(td|th)[\\s\\S]*>[\\s\\S]*<\\/\\2>)\\s*$/i);\r\n\t\tif (m) { // Table cells\r\n\t\t\t$scr.next().before(m[1]);\r\n\t\t} else {\r\n\t\t\t$(this).after($(\"<span></span>\").addClass($scr.attr(\"class\")).html($scr.html()));\r\n\t\t}\r\n\t\t$scr.closest(\".ew-table, .ew-view-table, .ew-grid\").removeClass(\"d-none\").show();\r\n\t});\r\n}\r\n\r\n// Check if boolean value is true\r\nexport function convertToBool(value) {\r\n\treturn value && [\"1\", \"y\", \"t\", \"true\"].includes(value.toLowerCase());\r\n}\r\n\r\n// Check if element value changed\r\nexport function valueChanged(fobj, infix, fld, bool) {\r\n\tvar nelm = getElements(\"x\" + infix + \"_\" + fld, fobj);\r\n\tvar oelm = getElement(\"o\" + infix + \"_\" + fld, fobj); // Hidden element\r\n\tvar fnelm = getElement(\"fn_x\" + infix + \"_\" + fld, fobj); // Hidden element\r\n\tif (!oelm && (!nelm || $.isArray(nelm) && nelm.length == 0))\r\n\t\treturn false;\r\n\tvar getvalue = function(obj) {\r\n\t\treturn getOptionValues(obj).join();\r\n\t}\r\n\tif (oelm && nelm) {\r\n\t\tif (bool) {\r\n\t\t\tif (convertToBool(getvalue(oelm)) === convertToBool(getvalue(nelm)))\r\n\t\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\tvar oldvalue = getvalue(oelm);\r\n\t\t\tvar newvalue = (fnelm) ? getvalue(fnelm) : getvalue(nelm);\r\n\t\t\tif (oldvalue == newvalue)\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n// Set language\r\nexport function setLanguage(el) {\r\n\tvar $el = $(el), val = $el.val() || $el.data(\"language\");\r\n\tif (!val)\r\n\t\treturn;\r\n\tvar params = new URLSearchParams();\r\n\tcurrentUrl.searchParams.forEach(function(value, key) {\r\n\t\tparams.append(key, ew.sanitize(value));\r\n\t});\r\n\tparams.set(\"language\", ew.sanitize(val));\r\n\tcurrentUrl.search = params.toString();\r\n\twindow.location = currentUrl.toString();\r\n}\r\n\r\n/**\r\n * Submit action\r\n *\r\n * @param {Event} e\r\n * @param {Object} args - Arguments\r\n * @param {HTMLElement} args.f - HTML form (default is the form of the source element)\r\n * @param {string} args.url - URL to which the request is sent (default is current page)\r\n * @param {Object} args.key - Key as object (for single record only)\r\n * @param {string} args.msg - Confirm message\r\n * @param {string} args.action - Custom action name\r\n * @param {string} args.select - \"single\"|\"s\" (single record) or \"multiple\"|\"m\" (multiple records, default)\r\n * @param {string} args.method - \"ajax\"|\"a\" (Ajax by HTTP POST) or \"post\"|\"p\" (HTTP POST, default)\r\n * @param {Object} args.data - Object of user data that is sent to the server\r\n * @param {string|callback|Object} success - Function to be called if the request succeeds, or settings for jQuery.ajax() (for Ajax only)\r\n * @returns\r\n */\r\nexport function submitAction(e, args) {\r\n\tvar el = e.target || e.srcElement, $el = $(el),\r\n\t\tf = args.f || $el.closest(\"form\")[0] || currentForm, $f = $(f),\r\n\t\tkey = args.key, action = args.action, url = args.url || currentPage(),\r\n\t\tmsg = args.msg, data = args.data, success = args.success,\r\n\t\tisPost = !args.method || sameText(args.method[0], \"p\"),\r\n\t\tisMultiple = !args.select && !args.key || args.select && sameText(args.select[0], \"m\");\r\n\tif (isMultiple && !$f[0])\r\n\t\treturn false;\r\n\tif (isMultiple && !keySelected($f[0])) {\r\n\t\t_prompt(\"<p class=\\\"text-danger\\\">\" + ew.language.phrase(\"NoRecordSelected\") + \"</p>\");\r\n\t\treturn false;\r\n\t}\r\n\tvar _success = function(result) {\r\n\t\tshowMessage(result);\r\n\t};\r\n\tvar _submit = function() {\r\n\t\tif (isPost) { // Post back\r\n\t\t\tif (action) // Action\r\n\t\t\t\t$(\"<input>\").attr({type: \"hidden\", name: \"useraction\", value: action}).appendTo($f);\r\n\t\t\tif ($.isObject(data)) { // User data\r\n\t\t\t\tfor (var k in data) {\r\n\t\t\t\t\tvar $input = $f.find(\"input[type=hidden][name='\" + k + \"']\");\r\n\t\t\t\t\tif ($input[0])\r\n\t\t\t\t\t\t$input.val(data[k]);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\t$(\"<input>\").attr({type: \"hidden\", name: k, value: data[k]}).appendTo($f);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!isMultiple && $.isObject(key)) { // Key\r\n\t\t\t\tfor (var k in key)\r\n\t\t\t\t\t$(\"<input>\").attr({type: \"hidden\", name: k, value: key[k]}).appendTo($f);\r\n\t\t\t}\r\n\t\t\t$f.prop(\"action\", url).submit();\r\n\t\t\tif (action) // Action\r\n\t\t\t\t$f.find(\"input[type=hidden][name=useraction]\").remove(); // Remove the \"useraction\" element\r\n\t\t} else { // Ajax\r\n\t\t\tdata = $.isObject(data) ? $.param(data) : $.isString(data) ? data : \"\"; // User data\r\n\t\t\tif (action)\r\n\t\t\t\tdata += \"&useraction=\" + action + \"&ajax=\" + action; // Action\r\n\t\t\tif (isMultiple) // Multiple records\r\n\t\t\t\tdata += \"&\" + $f.find(\"input[name='key_m[]']:checked\").serialize(); // Keys\r\n\t\t\telse if (key) // Single record\r\n\t\t\t\tdata += \"&\" + ($.isObject(key) ? $.param(key) : key); // Key\r\n\t\t\tif (success && $.isString(success))\r\n\t\t\t\tsuccess = window[success];\r\n\t\t\tif ($.isFunction(success)) {\r\n\t\t\t\t$.post(url, data, success);\r\n\t\t\t} else if ($.isObject(success)) { // \"success\" is Ajax settings\r\n\t\t\t\tsuccess.data = data;\r\n\t\t\t\tsuccess.method = success.method || \"POST\";\r\n\t\t\t\tsuccess.success = success.success || _success;\r\n\t\t\t\t$.ajax(url, success);\r\n\t\t\t} else {\r\n\t\t\t\t$.post(url, data, _success);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tif (msg) {\r\n\t\t_prompt(msg, function(result) {\r\n\t\t\tif (result)\r\n\t\t\t\t_submit();\r\n\t\t});\r\n\t} else {\r\n\t\t_submit();\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * Export with selected records and/or Custom Template\r\n *\r\n * @param {string} f - Form ID\r\n * @param {string} url - Form action\r\n * @param {string} type - Export type\r\n * @param {boolean} custom - Using Custom Template\r\n * @param {boolean} sel - Selected records only\r\n * @param {Object} fobj - email form object\r\n * @returns false\r\n */\r\nfunction _export(f, url, type, custom, sel, fobj) {\r\n\tif (!f)\r\n\t\treturn false;\r\n\tvar $f = $(f),\r\n\t\ttarget = $f.attr(\"target\"),\r\n\t\taction = $f.attr(\"action\"),\r\n\t\tcb = sel && $f.find(\"input[type=checkbox][name='key_m[]']\")[0];\r\n\tif (cb && !keySelected(f)) {\r\n\t\t_alert(ew.language.phrase(\"NoRecordSelected\"));\r\n\t\treturn false;\r\n\t}\r\n\tif (custom) { // Use Custom Template\r\n\t\t$(\"iframe.ew-export\").remove();\r\n\t\tif (type == \"email\")\r\n\t\t\turl += (\"&\" + $(fobj).serialize()).replace(/&export=email/i, \"\"); // Remove duplicate export=email\r\n\t\tif (cb) {\r\n\t\t\t$(\"<iframe>\").attr(\"name\", \"ew-export-frame\").addClass(\"ew-export d-none\").appendTo($body);\r\n\t\t\ttry {\r\n\t\t\t\t$f.append($(\"<input type='hidden'>\").attr({name: \"custom\", value: \"1\"}))\r\n\t\t\t\t\t.attr({ \"action\": url, \"target\": \"ew-export-frame\" }).find(\"input[name=exporttype]\").val(type).end().submit();\r\n\t\t\t} finally { // Reset\r\n\t\t\t\t$f.attr({ \"target\": target || \"\", \"action\": action }).find(\"input[name=custom]\").remove();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t$(\"<iframe>\").attr({ name: \"ew-export-frame\", src: url }).addClass(\"ew-export d-none\").appendTo($body);\r\n\t\t}\r\n\t} else { // No Custom Template\r\n\t\t$f.find(\"input[name=exporttype]\").val(type);\r\n\t\tif ([\"xml\", \"print\"].includes(type))\r\n\t\t\t$f.submit(); // Submit the form directly\r\n\t\telse\r\n\t\t\tfileDownload(action, $f.serialize());\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nexport { _export as export };\r\n\r\n// Remove spaces\r\nexport function removeSpaces(value) {\r\n\treturn (/^(<(p|br)\\/?>(&nbsp;)?(<\\/p>)?)?$/i.test(value.replace(/\\s/g, \"\"))) ? \"\" : value;\r\n}\r\n\r\n// Check if hidden text area (HTML editor)\r\nexport function isHiddenTextArea(el) {\r\n\tvar $el = $(el);\r\n\treturn (el && $el.is(\":hidden\") && $el.data(\"editor\"));\r\n}\r\n\r\n// Check if modal lookup\r\nexport function isModalLookup(el) {\r\n\tvar $el = $(el);\r\n\treturn (el && $el.is(\":hidden\") && $el.data(\"lookup\"));\r\n}\r\n\r\n// Check if hidden textbox (Auto-Suggest)\r\nexport function isAutoSuggest(el) {\r\n\tvar $el = $(el);\r\n\treturn $el[0] && $el.is(\":hidden\") && $el.data(\"autosuggest\");\r\n}\r\n\r\n// Get AutoSuggest instance\r\nexport function getAutoSuggest(el) {\r\n\treturn forms(el).autoSuggests[el.id];\r\n}\r\n\r\n/**\r\n * Alert\r\n *\r\n * @param {string} msg - Message\r\n * @param {callback} cb - Callback function\r\n * @param {string} type - CSS class: \"muted|primary|success|info|warning|danger\"\r\n */\r\nfunction _alert(msg, cb, type) {\r\n\tif (ew.IS_MOBILE) {\r\n\t\talert(msg.replace(/<[^>]*>/g, \"\")); // Remove HTML\r\n\t\tif (cb)\r\n\t\t\tsetTimeout(cb, 100); // Focus later to make sure editors are created\r\n\t} else {\r\n\t\tvar $dlg = $(\"#ew-message-box\");\r\n\t\t$dlg.find(\".modal-body\").html('<p class=\"text-' + (type || 'danger') + '\">' + msg + '</p>');\r\n\t\t$dlg.modal(\"show\");\r\n\t\tif (cb)\r\n\t\t\t$dlg.off(\"hidden.bs.modal\").on(\"hidden.bs.modal\", cb);\r\n\t}\r\n}\r\n\r\nexport { _alert as alert };\r\n\r\n// Show error message\r\nexport function onError(frm, el, msg) {\r\n\tif (el.jquery) { // el is jQuery object\r\n\t\tvar typ = el.attr(\"type\");\r\n\t\tel = (typ == \"checkbox\" || typ == \"radio\") ? el.get() : el[0];\r\n\t}\r\n\t_alert(msg, function() {\r\n\t\tsetFocus(el);\r\n\t});\r\n\tif (frm) {\r\n\t\tif (frm.multiPage) { // Multi-page\r\n\t\t\tfrm.multiPage.gotoPageByElement(el);\r\n\t\t} else if (frm.$element.is(\"div\")) { // Multiple Master/Detail\r\n\t\t\tvar $pane = frm.$element.closest(\".tab-pane\");\r\n\t\t\tif ($pane[0] && !$pane.hasClass(\"active\"))\r\n\t\t\t\t$pane.closest(\".tabbable, .ew-nav-tabs\").find(\"a[data-toggle=tab][href='#\" + $pane.attr(\"id\") + \"']\").click();\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n// Set focus\r\nexport function setFocus(obj) {\r\n\tif (!obj)\r\n\t\treturn;\r\n\tvar $obj = $(obj);\r\n\tif (isHiddenTextArea(obj)) { // HTML editor\r\n\t\treturn $obj.data(\"editor\").focus();\r\n\t} else if (!obj.options && obj.length) { // Radio/Checkbox list\r\n\t\tobj = $obj.filter(\"[value!='{value}']\")[0];\r\n\t} else if (isAutoSuggest(obj)) { // Auto-Suggest\r\n\t\tobj = getAutoSuggest(obj).input;\r\n\t}\r\n\tvar $cg = $obj.closest(\".form-group, [id^='el']\");\r\n\tif (isModalLookup(obj)) {\r\n\t\t$cg.find(\":button\").on(\"click\", function() {\r\n\t\t\t$cg.find(\".is-invalid\").removeClass(\"is-invalid\");\r\n\t\t});\r\n\t} else {\r\n\t\tif (obj.type == \"checkbox\" || obj.type == \"radio\") {\r\n\t\t\t$obj.filter(\"[value!='{value}']\").addClass(\"is-invalid\").focus().one(\"click keypress keyup\", function() {\r\n\t\t\t\t$cg.find(\".is-invalid\").removeClass(\"is-invalid\");\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\t$(obj).addClass(\"is-invalid\").focus().select().parent().one(\"click keypress keyup\", function() {\r\n\t\t\t\t$cg.find(\".is-invalid\").removeClass(\"is-invalid\");\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// Check if object has value\r\nexport function hasValue(obj) {\r\n\treturn getOptionValues(obj).join(\"\") != \"\";\r\n}\r\n\r\n// Get Ctrl key for multiple column sort\r\nexport function sort(e, url, type) {\r\n\tif (type == 2 && e.ctrlKey)\r\n\t\turl += \"&ctrl=1\";\r\n\tlocation = url;\r\n\treturn true;\r\n}\r\n\r\n// Confirm Delete Message\r\nexport function confirmDelete(el) {\r\n\tclickDelete(el);\r\n\t_prompt(ew.language.phrase(\"DeleteConfirmMsg\"), function(result) {\r\n\t\t(result && el.href) ? window.location = el.href : clearDelete(el);\r\n\t});\r\n\treturn false;\r\n}\r\n\r\n// Check if any key selected // PHP\r\nexport function keySelected(f) {\r\n\treturn $(f).find(\"input[type=checkbox][name='key_m[]']:checked\", f).length > 0;\r\n}\r\n\r\n// Select all key\r\nexport function selectAllKey(cb) {\r\n\tselectAll(cb);\r\n\tvar tbl = $(cb).closest(\".ew-table\")[0];\r\n\tif (!tbl)\r\n\t\treturn;\r\n\t$(tbl.tBodies).each(function() {\r\n\t\t$(this.rows).each(function(i, r) {\r\n\t\t\tvar $r = $(r);\r\n\t\t\tif ($r.is(\":not(.ew-template):not(.ew-table-preview-row)\")) {\r\n\t\t\t\t$r.data({ selected: cb.checked, checked: cb.checked });\r\n\t\t\t\tsetColor(i, r);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\n// Select all related checkboxes\r\nexport function selectAll(cb) {\r\n\tif (!cb || !cb.form)\r\n\t\treturn;\r\n\t$(cb.form.elements).filter(\"input[type=checkbox][name^=\" + cb.name + \"_], [type=checkbox][name=\" + cb.name + \"]\").not(cb).not(\":disabled\").prop(\"checked\", cb.checked);\r\n}\r\n\r\n// Update selected checkbox\r\nexport function updateSelected(f) {\r\n\treturn $(f).find(\"input[type=checkbox][name^=u_]:checked,input:hidden[name^=u_][value=1]\").length > 0;\r\n}\r\n\r\n// Set row color\r\nexport function setColor(index, row) {\r\n\tvar $row = $(row), $tbl = $row.closest(\".ew-table\");\r\n\tif (!$tbl[0])\r\n\t\treturn;\r\n\tif ($row.data(\"selected\")) {\r\n\t\t$row.removeClass($tbl.data(\"rowhighlightclass\") || \"ew-table-highlight-row\")\r\n\t\t\t.removeClass($tbl.data(\"roweditclass\") || \"ew-table-edit-row\")\r\n\t\t\t.addClass($tbl.data(\"rowselectclass\") || \"ew-table-select-row\");\r\n\t} else if ([ew.ROWTYPE_ADD, ew.ROWTYPE_EDIT].includes($row.data(\"rowtype\"))) {\r\n\t\t$row.removeClass($tbl.data(\"rowselectclass\") || \"ew-table-select-row\")\r\n\t\t\t.removeClass($tbl.data(\"rowhighlightclass\") || \"ew-table-highlight-row\")\r\n\t\t\t.addClass($tbl.data(\"roweditclass\") || \"ew-table-edit-row\");\r\n\t} else {\r\n\t\t$row.removeClass($tbl.data(\"rowselectclass\") || \"ew-table-select-row\")\r\n\t\t\t.removeClass($tbl.data(\"roweditclass\") || \"ew-table-edit-row\")\r\n\t\t\t.removeClass($tbl.data(\"rowhighlightclass\") || \"ew-table-highlight-row\");\r\n\t}\r\n}\r\n\r\n// Clear selected rows color\r\nexport function clearSelected(tbl) {\r\n\t$(tbl.rows).each(function(i, r) {\r\n\t\tvar $r = $(r);\r\n\t\tif (!$r.data(\"checked\") && $r.data(\"selected\")) {\r\n\t\t\t$r.data(\"selected\", false);\r\n\t\t\tsetColor(i, r);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n// Clear all row delete status\r\nexport function clearDelete(el) {\r\n\tvar $el = $(el), tbl = $el.closest(\".ew-table\")[0];\r\n\tif (!tbl)\r\n\t\treturn;\r\n\tvar $tr = $el.closest(\".ew-table > tbody > tr\");\r\n\t$tr.siblings(\"[data-rowindex='\" + $tr.data(\"rowindex\") + \"']\").addBack().each(function(i, r) {\r\n\t\tvar $r = $(r);\r\n\t\t$r.data(\"selected\", $r.data(\"checked\"));\r\n\t});\r\n}\r\n\r\n// Click single delete link\r\nexport function clickDelete(el) {\r\n\tvar $el = $(el), tbl = $el.closest(\".ew-table\")[0];\r\n\tif (!tbl)\r\n\t\treturn;\r\n\tclearSelected(tbl);\r\n\tvar $tr = $el.closest(\".ew-table > tbody > tr\");\r\n\t$tr.siblings(\"[data-rowindex='\" + $tr.data(\"rowindex\") + \"']\").addBack().each(function(i, r) {\r\n\t\t$(r).data(\"selected\", true);\r\n\t\tsetColor(i, r);\r\n\t});\r\n}\r\n\r\n// Click multiple checkbox\r\nexport function clickMultiCheckbox(e) {\r\n\tvar cb = e.target || e.srcElement, $cb = $(cb), tbl = $cb.closest(\".ew-table\")[0];\r\n\tif (!tbl)\r\n\t\treturn;\r\n\tclearSelected(tbl);\r\n\tvar $tr = $cb.closest(\".ew-table > tbody > tr\");\r\n\t$tr.siblings(\"[data-rowindex='\" + $tr.data(\"rowindex\") + \"']\").addBack().each(function(i, r) {\r\n\t\t$(r).data(\"checked\", cb.checked).data(\"selected\", cb.checked).find(\"input[type=checkbox][name='key_m[]']\").each(function() {\r\n\t\t\tif (this != cb) this.checked = cb.checked;\r\n\t\t});\r\n\t\tsetColor(i, r);\r\n\t});\r\n\te.stopPropagation();\r\n}\r\n\r\n// Setup table\r\nexport function setupTable(index, tbl, force) {\r\n\tvar $tbl = $(tbl), $rows = $(tbl.rows);\r\n\tif (!tbl || !tbl.rows || !force && $tbl.data(\"isset\") || tbl.tBodies.length == 0)\r\n\t\treturn;\r\n\r\n\t// Set mouse over color\r\n\tvar mouseOver = function(e) {\r\n\t\tvar $this = $(this);\r\n\t\tif (!$this.data(\"selected\") && ![ew.ROWTYPE_ADD, ew.ROWTYPE_EDIT].includes($this.data(\"rowtype\"))) {\r\n\t\t\tvar $tbl = $this.closest(\".ew-table\");\r\n\t\t\tif (!$tbl[0])\r\n\t\t\t\treturn;\r\n\t\t\t$this.siblings(\"[data-rowindex='\" + $this.data(\"rowindex\") + \"']\").addBack().each(function(i, r) {\r\n\t\t\t\t$(r).addClass($tbl.data(\"rowhighlightclass\") || \"ew-table-highlight-row\");\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t// Set mouse out color\r\n\tvar mouseOut = function(e) {\r\n\t\tvar $this = $(this);\r\n\t\tif (!$this.data(\"selected\") && ![ew.ROWTYPE_ADD, ew.ROWTYPE_EDIT].includes($this.data(\"rowtype\")))\r\n\t\t\t$this.siblings(\"[data-rowindex='\" + $this.data(\"rowindex\") + \"']\").addBack().each(setColor);\r\n\t}\r\n\r\n\t// Set selected row color\r\n\tvar click = function(e) {\r\n\t\tvar $this = $(this), tbl = $this.closest(\".ew-table\")[0],\r\n\t\t\t$target = $(e.target);\r\n\t\tif (!tbl || $target.hasClass(\"btn\") || $target.hasClass(\"ew-preview-row-btn\") || $target.is(\":input\"))\r\n\t\t\treturn;\r\n\t\tif (!$this.data(\"checked\")) {\r\n\t\t\tvar selected = $this.data(\"selected\");\r\n\t\t\tclearSelected(tbl); // Clear all other selected rows\r\n\t\t\t$this.siblings(\"[data-rowindex='\" + $this.data(\"rowindex\") + \"']\").addBack().each(function(i, r) {\r\n\t\t\t\t$(r).data(\"selected\", !selected); // Toggle\r\n\t\t\t\tsetColor(i, r);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tvar n = $rows.filter(\"[data-rowindex=1]\").length || $rows.filter(\"[data-rowindex=0]\").length || 1; // Alternate color every n rows\r\n\tvar rows = $rows\r\n\t\t.filter(\":not(.ew-template)\")\r\n\t\t.each(function() {\r\n\t\t\t$(this.cells).removeClass(\"ew-table-last-row\").last().addClass(\"ew-table-last-col\"); // Cell of last column\r\n\t\t}).get();\r\n\tvar div = $tbl.parentsUntil(\".ew-grid\", \".\" + ew.RESPONSIVE_TABLE_CLASS)[0];\r\n\tif (rows.length) {\r\n\t\tfor (var i = 1; i <= n; i++) {\r\n\t\t\tvar r = rows[rows.length - i]; // Last rows\r\n\t\t\t$(r.cells).each(function() {\r\n\t\t\t\tif (this.rowSpan == i) // Cell of last row\r\n\t\t\t\t\t$(this).addClass(\"ew-table-last-row\")\r\n\t\t\t\t\t\t.toggleClass(\"ew-table-border-bottom\", !!div && div.clientHeight > tbl.offsetHeight);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\tvar form = $tbl.closest(\"form\")[0];\r\n\tvar attach = form && $(form.elements).filter(\"input#action:not([value^=grid])\").length > 0;\r\n\t$(tbl.tBodies[tbl.tBodies.length - 1].rows) // Use last TBODY (avoid Opera bug)\r\n\t\t.filter(\":not(.ew-template):not(.ew-table-preview-row)\")\r\n\t\t.each(function(i) {\r\n\t\t\tvar $r = $(this);\r\n\t\t\tif (attach && !$r.data(\"isset\")) {\r\n\t\t\t\tif ([ew.ROWTYPE_ADD, ew.ROWTYPE_EDIT].includes($r.data(\"rowtype\"))) // Add/Edit row\r\n\t\t\t\t\t$r.on(\"mouseover\", function() {this.edit = true;}).addClass(\"ew-table-edit-row\");\r\n\t\t\t\t$r.on(\"mouseover\", mouseOver).on(\"mouseout\", mouseOut).on(\"click\", click);\r\n\t\t\t\t$r.data(\"isset\", true);\r\n\t\t\t}\r\n\t\t\tvar sw = i % (2 * n) < n;\r\n\t\t\t$r.toggleClass(\"ew-table-row\", sw).toggleClass(\"ew-table-alt-row\", !sw);\r\n\t\t});\r\n\tsetupGrid(index, $tbl.closest(\".ew-grid\")[0], force);\r\n\t$tbl.data(\"isset\", true);\r\n}\r\n\r\n// Setup grid\r\nexport function setupGrid(index, grid, force) {\r\n\tvar $grid = $(grid);\r\n\tif (!grid || !force && $grid.data(\"isset\"))\r\n\t\treturn;\r\n\tvar multi = $grid.find(\"table.ew-multi-column-table\").length, rowcnt;\r\n\tif (multi) {\r\n\t\trowcnt = $grid.find(\"td[data-rowindex]\").length;\r\n\t} else {\r\n\t\trowcnt = $grid.find(\"table.ew-table > tbody:first > tr:not(.ew-table-preview-row, .ew-template)\").length;\r\n\t}\r\n\tif (rowcnt == 0 && !$grid.find(\".ew-grid-upper-panel, .ew-grid-lower-panel\")[0])\r\n\t\t$grid.hide();\r\n\t// if (!$grid.find(\".ew-grid-upper-panel:visible\")[0])\r\n\t// \t$grid.css({\"border-top-left-radius\": 0, \"border-top-right-radius\": 0});\r\n\t// if (!$grid.find(\".ew-grid-lower-panel:visible\")[0])\r\n\t// \t$grid.css({\"border-bottom-left-radius\": 0, \"border-bottom-right-radius\": 0});\r\n\tif ($grid.find(\".ew-grid-middle-panel:visible\").hasClass(ew.RESPONSIVE_TABLE_CLASS) && $grid.width() > $(\".content\").width()) {\r\n\t\t$grid.addClass(\"d-flex\");\r\n\t\t$grid.closest(\".ew-detail-pages\").addClass(\"d-block\");\r\n\t\t$grid.closest(\".ew-form\").addClass(\"w-100\");\r\n\t\tif (ew.USE_OVERLAY_SCROLLBARS)\r\n\t\t\t$grid.find(\".ew-grid-middle-panel:not(.ew-preview-middle-panel)\").overlayScrollbars(ew.sidebarScrollbarsOptions);\r\n\t}\r\n\t$grid.data(\"isset\", true);\r\n}\r\n\r\n// Add a row to grid\r\nexport function addGridRow(el) {\r\n\tvar $grid = $(el).closest(\".ew-grid\"),\r\n\t\t$tbl = $grid.find(\"table.ew-table\").last(), $p = $tbl.parent(\"div\"),\r\n\t\t$tpl = $tbl.find(\"tr.ew-template\");\r\n\tif (!el || !$grid[0] || !$tbl[0] || !$tpl[0])\r\n\t\treturn false;\r\n\tvar $lastrow = $($tbl[0].rows).last();\r\n\t$tbl.find(\"td.ew-table-last-row\").removeClass(\"ew-table-last-row\");\r\n\tvar $row = $tpl.clone(true, true).removeClass(\"ew-template\");\r\n\tvar $form = $grid.find(\"div.ew-form[id^=f][id$=grid]\");\r\n\tif (!$form[0])\r\n\t\t$form = $grid.find(\"form.ew-form[id^=f][id$=list]\");\r\n\tvar suffix = ($form.is(\"div\")) ? \"_\" + $form.attr(\"id\") : \"\";\r\n\tvar $elkeycnt = $form.find(\"#key_count\" + suffix);\r\n\tvar keycnt = parseInt($elkeycnt.val(), 10) + 1;\r\n\t$row.attr({ \"id\": \"r\" + keycnt + $row.attr(\"id\").substring(2), \"data-rowindex\": keycnt });\r\n\tvar $els = $tpl.find(\"script:contains('$rowindex$')\"); // Get scripts with rowindex\r\n\t$row.children(\"td\").each(function() {\r\n\t\t$(this).find(\"*\").each(function() {\r\n\t\t\t$.each(this.attributes, function(i, attr) {\r\n\t\t\t\tattr.value = attr.value.replace(/\\$rowindex\\$/g, keycnt); // Replace row index\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\t$row.find(\".ew-icon\").closest(\"a, button\").removeData(\"bs.tooltip\").tooltip({ container: \"body\", placement: \"bottom\", trigger: \"hover\", sanitizeFn: ew.sanitizeFn });\r\n\t$elkeycnt.val(keycnt).after($(\"<input>\").attr({\r\n\t\ttype: \"hidden\",\r\n\t\tid: \"k\" + keycnt + \"_action\" + suffix,\r\n\t\tname: \"k\" + keycnt + \"_action\" + suffix,\r\n\t\tvalue: \"insert\"\r\n\t}));\r\n\t$lastrow.after($row);\r\n\t$els.each(function() {\r\n\t\taddScript(this.text.replace(/\\$rowindex\\$/g, keycnt));\r\n\t});\r\n\tvar frm = $form.data(\"form\");\r\n\tif (frm) {\r\n\t\tfrm.initEditors();\r\n\t\tfrm.initUpload();\r\n\t}\r\n\tsetupTable(-1, $tbl[0], true);\r\n\t$p.scrollTop($p[0].scrollHeight);\r\n\treturn false;\r\n}\r\n\r\n// Delete a row from grid\r\nexport function deleteGridRow(el, infix) {\r\n\tvar $el = $(el).tooltip(\"hide\").removeData(\"bs.tooltip\"),\r\n\t\t$grid = $el.closest(\".ew-grid, .ew-multi-column-grid\"),\r\n\t\t$row = $el.closest(\"tr, div[data-rowindex]\"), $tbl = $row.closest(\".ew-table\");\r\n\tif (!el || !$grid[0] || !$row[0])\r\n\t\treturn false;\r\n\tvar rowidx = parseInt($row.data(\"rowindex\"), 10);\r\n\tvar $form = $grid.find(\"div.ew-form[id^=f][id$=grid]\");\r\n\tif (!$form[0])\r\n\t\t$form = $grid.find(\"form.ew-form[id^=f][id$=list]\");\r\n\tvar frm = $form.data(\"form\");\r\n\tif (!$form[0] || !frm)\r\n\t\treturn false;\r\n\tvar suffix = ($form.is(\"div\")) ? \"_\" + $form.attr(\"id\") : \"\";\r\n\tvar keycntname = \"#key_count\" + suffix;\r\n\tvar $elkeycnt = $form.find(keycntname);\r\n\tvar _delete = function() {\r\n\t\t$row.remove();\r\n\t\tif ($grid.is(\".ew-grid\"))\r\n\t\t\tsetupTable(-1, $tbl[0], true);\r\n\t\tif (rowidx > 0) {\r\n\t\t\tvar $keyact = $form.find(\"#k\" + rowidx + \"_action\" + suffix);\r\n\t\t\tif ($keyact[0]) {\r\n\t\t\t\t$keyact.val(($keyact.val() == \"insert\") ? \"insertdelete\" : \"delete\");\r\n\t\t\t} else {\r\n\t\t\t\t$form.find(keycntname).after($(\"<input>\").attr({\r\n\t\t\t\t\ttype: \"hidden\",\r\n\t\t\t\t\tid: \"k\" + rowidx + \"_action\" + suffix,\r\n\t\t\t\t\tname: \"k\" + rowidx + \"_action\" + suffix,\r\n\t\t\t\t\tvalue: \"delete\"\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tif ($.isFunction(frm.emptyRow) && frm.emptyRow(infix)) { // Empty row\r\n\t\t_delete();\r\n\t} else { // Confirm\r\n\t\t_prompt(ew.language.phrase(\"DeleteConfirmMsg\"), function(result) {\r\n\t\t\tif (result)\r\n\t\t\t\t_delete();\r\n\t\t});\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n// HTML encode text\r\nexport function htmlEncode(text) {\r\n\tvar str = String(text);\r\n\tstr = str.replace(/&/g, '&amp;');\r\n\tstr = str.replace(/\\\"/g, '&quot;');\r\n\tstr = str.replace(/</g, '&lt;');\r\n\tstr = str.replace(/>/g, '&gt;');\r\n\treturn str;\r\n}\r\n\r\n// Clear search form\r\nexport function clearForm(form){\r\n\t$(form).find(\"[id^=x_],[id^=y_],[id^=n_]\").each(function() {\r\n\t\tif (this.type == \"checkbox\" || this.type == \"radio\") {\r\n\t\t\tthis.checked = false;\r\n\t\t} else if (this.type == \"select-one\") {\r\n\t\t\tthis.selectedIndex = 0;\r\n\t\t} else if (this.type == \"select-multiple\") {\r\n\t\t\t$(this).find(\"option\").prop(\"selected\", false);\r\n\t\t} else if (this.type == \"text\" || this.type == \"textarea\" || this.type == \"hidden\" && isAutoSuggest(this)) {\r\n\t\t\tthis.value = \"\";\r\n\t\t\tif (this.type == \"hidden\")\r\n\t\t\t\tgetAutoSuggest(this).input.value = \"\";\r\n\t\t}\r\n\t});\r\n}\r\n\r\n// Get form element(s) as single element or array of radio/checkbox\r\nexport function getElements(name, root) {\r\n\tvar selector = \"[name='\" + name + \"']\";\r\n\tvar ar = name.split(\" \"); // Check if \"#id name\"\r\n\tif (ar.length == 2)\r\n\t\tselector = \"[data-table='\" + ar[0] + \"'][data-field='\" + getId(ar[1]) + \"']:not([name^=o]):not([name^='x$'])\"; // Remove []\r\n\tvar root = !$.isString(root) ? root : /^#/.test(root) ? root : \"#\" + root;\r\n\tselector = \"input\" + selector + \",select\" + selector + \",textarea\" + selector + \",button\" + selector;\r\n\tvar $els = (root) ? $(root).find(selector) : $(selector);\r\n\tif ($els.length == 1 && $els.is(\":not([type=checkbox]):not([type=radio])\"))\r\n\t\treturn $els[0];\r\n\treturn $els.get();\r\n}\r\n\r\n// Get first element (not necessarily form element)\r\nexport function getElement(name, root) {\r\n\tvar root = $.isString(root) ? \"#\" + root : root,\r\n\t\tselector = \"#\" + name.replace(/([\\$\\[\\]])/g, \"\\\\$1\") + \",[name='\" + name + \"']\";\r\n\treturn (root) ? $(root).find(selector)[0] : $(selector).first()[0];\r\n}\r\n\r\n// Get ancestor by function\r\nexport function getAncestorBy(node, method) {\r\n\twhile (node = node.parentNode) {\r\n\t\tif (node && node.nodeType == 1 && (!method || method(node)))\r\n\t\t\treturn node;\r\n\t}\r\n\treturn null;\r\n}\r\n\r\n// Check if an element is hidden\r\nexport function isHidden(el) {\r\n\treturn $(el).css(\"display\") == \"none\" && !$(el).closest(\".dropdown-menu\")[0] && !isModalLookup(el) && !isAutoSuggest(el) && !isHiddenTextArea(el) || getAncestorBy(el, function(node) {\r\n\t\t\tvar $node = $(node);\r\n\t\t\treturn $node.css(\"display\") == \"none\" && !$node.hasClass(\"tab-pane\") && !$node.hasClass(\"collapse\");\r\n\t\t}) != null;\r\n}\r\n\r\n// Check if same text\r\nexport function sameText(o1, o2) {\r\n\treturn (String(o1).toLowerCase() == String(o2).toLowerCase());\r\n}\r\n\r\n// Check if same string\r\nexport function sameString(o1, o2) {\r\n\treturn (String(o1) == String(o2));\r\n}\r\n\r\n// Get existing selected values as an array\r\nexport function getOptionValues(el, form) {\r\n\tvar obj;\r\n\tif ($.isString(el)) {\r\n\t\tvar ar = el.split(\" \");\r\n\t\tif (ar.length == 2) { // Parent field in master table\r\n\t\t\tobj = getElements(el);\r\n\t\t} else {\r\n\t\t\tobj = getElements(el, form);\r\n\t\t}\r\n\t} else {\r\n\t\tobj = el;\r\n\t}\r\n\tif (obj.options) { // Selection list\r\n\t\treturn $(obj).find(\"option:selected[value!='']\").map(function() {\r\n\t\t\treturn this.value;\r\n\t\t}).get();\r\n\t} else if ($.isNumber(obj.length)) { // Radio/Checkbox list, or element not found\r\n\t\treturn $(obj).filter(\":checked[value!='{value}']\").map(function() {\r\n\t\t\treturn this.value;\r\n\t\t}).get();\r\n\t} else { // text/hidden\r\n\t\tvar data = $(obj).data();\r\n\t\tif (data.lookup && data.multiple) // Modal-Lookup\r\n\t\t\treturn obj.value.split(ew.MULTIPLE_OPTION_SEPARATOR);\r\n\t\telse\r\n\t\t\treturn [obj.value];\r\n\t}\r\n}\r\n\r\n// Get existing text of selected values as an array\r\nexport function getOptionTexts(el, form) {\r\n\tvar obj;\r\n\tif ($.isString(el)) {\r\n\t\tvar ar = el.split(\" \");\r\n\t\tif (ar.length == 2) { // Parent field in master table\r\n\t\t\tobj = getElements(el);\r\n\t\t} else {\r\n\t\t\tobj = getElements(el, form);\r\n\t\t}\r\n\t} else {\r\n\t\tobj = el;\r\n\t}\r\n\tif (obj.options) { // Selection list\r\n\t\treturn $(obj).find(\"option:selected[value!='']\").map(function() {\r\n\t\t\treturn this.text;\r\n\t\t}).get();\r\n\t} else if ($.isNumber(obj.length)) { // Radio/Checkbox list, or element not found\r\n\t\treturn $(obj).filter(\":checked[value!='{value}']\").map(function() {\r\n\t\t\treturn $(this).parent().text();\r\n\t\t}).get();\r\n\t} else if (isAutoSuggest(obj)) {\r\n\t\treturn [getAutoSuggest(obj).input.value];\r\n\t} else if (isModalLookup(obj)) { // Modal-Lookup\r\n\t\tvar $obj = $(obj);\r\n\t\treturn $obj.parent().find(\".ew-lookup-text .ew-option\").map(function() {\r\n\t\t\treturn $(this).text().trim();\r\n\t\t}).get();\r\n\t} else {\r\n\t\treturn [obj.value];\r\n\t}\r\n}\r\n\r\n// Get container of radio/checkbox list\r\nfunction getContainer(obj) {\r\n\tvar id = getId(obj);\r\n\treturn $(obj).closest(\".form-group, [id^=el][id$='\" + id.replace(/^([xy]\\d*_)/, '') + \"']\").find(\"#dsl_\" + id);\r\n}\r\n\r\n// Clear existing options\r\nexport function clearOptions(obj) {\r\n\tif (obj.options) { // Selection list\r\n\t\tvar lo = (obj.type == \"select-multiple\" || $(obj).data(\"pleaseselect\") === false || obj.length > 0 && obj.options[0].value != \"\") ? 0 : 1; // multiple or data-pleaseselect=\"false\" or non-empty first element => remove all\r\n\t\tfor (var i = obj.length - 1; i >= lo; i--)\r\n\t\t\tobj.options[i] = null;\r\n\t} else if (obj.length) { // Radio/Checkbox list\r\n\t\tvar id = getId(obj), $p = getContainer(obj);\r\n\t\t$p.data(\"options\", []).find(\"div\").first().empty();\r\n\t} else if (isAutoSuggest(obj)) {\r\n\t\tvar o = getAutoSuggest(obj);\r\n\t\to._options = [];\r\n\t\to.input.value = \"\";\r\n\t\tobj.value = \"\";\r\n\t} else if (isModalLookup(obj)) { // Modal-Lookup\r\n\t\t$(obj).data(\"options\", []);\r\n\t}\r\n}\r\n\r\n/**\r\n * Get the name or id of an element\r\n *\r\n * @param {*} el - Element\r\n * @param {boolean} [remove=true] - Remove square brackets\r\n * @returns\r\n */\r\nexport function getId(el, remove) {\r\n\tvar id = ($.isString(el)) ? el : ($(el).attr(\"name\") || $(el).attr(\"id\")); // Use name first (id may have suffix)\r\n\treturn (remove !== false) ? id.replace(/\\[\\]$/, \"\") : id;\r\n}\r\n\r\n// Get display value separator\r\nexport function valueSeparator(index, obj) {\r\n\tvar sep = $(obj).data(\"value-separator\");\r\n\treturn ($.isArray(sep)) ? sep[index - 1] : (sep || \", \");\r\n}\r\n\r\n/**\r\n * Get display value\r\n *\r\n * @param {Object} opt - Option being displayed\r\n * @param {HTMLElment} obj - HTML element\r\n * @returns {string} Display value\r\n */\r\nexport function displayValue(opt, obj) {\r\n\tvar text = opt.df;\r\n\tfor (var i = 2; i <= 4; i++) {\r\n\t\tif (opt[\"df\" + i] && opt[\"df\" + i] != \"\") {\r\n\t\t\tvar sep = valueSeparator(i - 1, obj);\r\n\t\t\tif ($.isUndefined(sep))\r\n\t\t\t\tbreak;\r\n\t\t\tif (text != \"\")\r\n\t\t\t\ttext += sep;\r\n\t\t\ttext += opt[\"df\" + i];\r\n\t\t}\r\n\t}\r\n\treturn text;\r\n}\r\n\r\n/**\r\n * Get HTML for a single option\r\n *\r\n * @param {*} val - Value of the option\r\n * @returns {string} HTML\r\n */\r\nexport function optionHtml(val) {\r\n\treturn ew.OPTION_HTML_TEMPLATE.replace(/\\{value\\}/g, val);\r\n}\r\n\r\n/**\r\n * Get HTML for diplaying all options\r\n *\r\n * @param {string[]} options - Array of all options (HTML)\r\n * @param {number} max - Maximum number of options to show\r\n * @returns {string} HTML\r\n */\r\nexport function optionsHtml(options, max) {\r\n\tif (options.length > (max || ew.MAX_OPTION_COUNT)) { // More than max option count\r\n\t\treturn ew.language.phrase(\"CountSelected\").replace(\"%s\", options.length);\r\n\t} else if (options.length) { // Some options\r\n\t\tvar html = \"\";\r\n\t\tfor (var i = 0; i < options.length; i++)\r\n\t\t\thtml += optionHtml(options[i]);\r\n\t\treturn html;\r\n\t} else { // No options\r\n\t\treturn ew.language.phrase(\"PleaseSelect\");\r\n\t}\r\n}\r\n\r\n/**\r\n * Create new option\r\n *\r\n * @param {(HTMLElement|array)} obj - Selection list\r\n * @param {Object} opt - Object for the new option\r\n * @param {form} f - form object of obj\r\n * @returns\r\n */\r\nexport function newOption(obj, opt, f) {\r\n\tvar frm = _forms[f.id], id = getId(obj), nid = getId(obj, false), text,\r\n\t\tvalue = opt.lf, item = { lf: opt.lf, df1: opt.df, df2: opt.df2, df3: opt.df3, df4: opt.df4 };\r\n\tif (frm.lists(nid).template && !isAutoSuggest(obj)) {\r\n\t\ttext = frm.lists(nid).template.render(item, ew.jsRenderHelpers);\r\n\t} else {\r\n\t\ttext = displayValue(opt, obj) || value;\r\n\t}\r\n\tvar args = { \"data\": item, \"name\": id, \"form\": f.$element, \"value\": value, \"text\": text };\r\n\tif (obj.options) { // Selection list\r\n\t\tObject.assign(args, { \"option\": $(\"<option></option>\").val(args.value).html(args.text) });\r\n\t\t$document.trigger(\"newoption\", [args]); // Fire \"newoption\" event for selection list\r\n\t\t$(obj).append(args.option);\r\n\t} else if (obj.length) { // Radio/Checkbox list\r\n\t\tvar $p = getContainer(obj), opts = $p.data(\"options\"); // Parent element\r\n\t\tif ($p[0] && opts)\r\n\t\t\topts.push({\"val\": args.value, \"lbl\": args.text});\r\n\t} else if (isAutoSuggest(obj)) { // Auto-Suggest\r\n\t\tvar o = getAutoSuggest(obj);\r\n\t\to._options.push({\"val\": args.value, \"lbl\": args.text});\r\n\t} else if (isModalLookup(obj)) { // Modal-Lookup\r\n\t\tvar $obj = $(obj), opts = $obj.data(\"options\") || [];\r\n\t\topts.push({\"val\": args.value, \"lbl\": args.text});\r\n\t\t$obj.data(\"options\", opts);\r\n\t}\r\n\treturn args.text;\r\n}\r\n\r\n// Render the options\r\nexport function renderOption(obj) {\r\n\tvar id = getId(obj), f = getForm(obj), $p = getContainer(obj);\r\n\tif (!$p[0] || !$p.data(\"options\"))\r\n\t\treturn;\r\n\tvar $t = $p.parent().find(\"#tp_\" + id);\r\n\tif (!$t[0])\r\n\t\treturn;\r\n\tvar cols = (!ew.IS_MOBILE) ? (parseInt($p.data(\"repeatcolumn\"), 10) || 5) : 1;\r\n\tvar $tpl = $t.contents(), opts = $p.data(\"options\"), type = $tpl.attr(\"type\");\r\n\tvar $btn = $p.prevAll(\".dropdown-toggle\"), $clr = $p.closest(\".ew-dropdown-list\").find(\".ew-dropdown-clear\");\r\n\tif (opts && opts.length) {\r\n\t\tif (cols > 1 || type == \"checkbox\" || !$btn[0]) { // Use table\r\n\t\t\tvar $tbl = $('<div class=\"d-table ew-item-table\"></div>');\r\n\t\t\tif (type == \"checkbox\")\r\n\t\t\t\t$tbl.click(function(e) { e.stopPropagation(); });\r\n\t\t\tfor (var i = 0, cnt = opts.length; i < cnt; i++) {\r\n\t\t\t\tvar $tr;\r\n\t\t\t\tif (i % cols == 0)\r\n\t\t\t\t\t$tr = $('<div class=\"d-table-row\"></div>');\r\n\t\t\t\tvar $el = $tpl.clone(true).val(opts[i].val).click(function(e) {\r\n\t\t\t\t\tif ($btn[0]) {\r\n\t\t\t\t\t\tvar $items = $tbl.find(\"input[name='\" + this.name + \"']:checked\");\r\n\t\t\t\t\t\tvar $vals = $items.map(function() {\r\n\t\t\t\t\t\t\treturn $(this).parent().text();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t$btn.html(optionsHtml($vals.get(), $(this).data(\"maxcount\")));\r\n\t\t\t\t\t\t$clr.prop(\"disabled\", $vals.length == 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t$el.attr(\"id\", $el.attr(\"id\") + \"_\" + i + \"_\" + random()); // Note: Make sure ID is unique\r\n\t\t\t\tvar $lbl = $('<label class=\"custom-control-label\"></label>').attr(\"for\", $el.attr(\"id\")).append(opts[i].lbl);\r\n\t\t\t\tvar args = {\"name\": id, \"form\": f, \"value\": opts[i].val, \"text\": opts[i].lbl, \"option\": $('<div class=\"custom-control custom-' + type + '\"></div>').append($el.add($lbl))};\r\n\t\t\t\t$document.trigger(\"newoption\", [args]); // Fire \"newoption\" event for radio/checkbox list\r\n\t\t\t\t$('<div class=\"d-table-cell\"></div>').append(args.option).appendTo($tr);\r\n\t\t\t\tif (i % cols == cols - 1) {\r\n\t\t\t\t\t$tbl.append($tr);\r\n\t\t\t\t} else if (i == cnt - 1) { // Last\r\n\t\t\t\t\tfor (var j = (i % cols) + 1; j < cols; j++)\r\n\t\t\t\t\t\t$tr.append('<div class=\"d-table-cell\"></div>');\r\n\t\t\t\t\t$tbl.append($tr);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t$p.find(\"div\").first().append($tbl);\r\n\t\t} else { // Single column dropdown radio buttons => Use list group\r\n\t\t\tvar $div = $('<div class=\"list-group\"></div>');\r\n\t\t\tfor (var i = 0, cnt = opts.length; i < cnt; i++) {\r\n\t\t\t\tvar $el = $tpl.clone(true).val(opts[i].val).click(function(e) {\r\n\t\t\t\t\tvar $li = $(this).closest(\".list-group-item\");\r\n\t\t\t\t\tif ($li.hasClass(\"active\"))\r\n\t\t\t\t\t\tthis.checked = false;\r\n\t\t\t\t\t$li.siblings(\".list-group-item\").removeClass(\"active\");\r\n\t\t\t\t\t$li.toggleClass(\"active\", this.checked);\r\n\t\t\t\t\t$btn.html(this.checked ? $li.text() : ew.language.phrase(\"PleaseSelect\"));\r\n\t\t\t\t\t$clr.prop(\"disabled\", !this.checked);\r\n\t\t\t\t});\r\n\t\t\t\t$el.attr(\"id\", $el.attr(\"id\") + \"_\" + i + \"_\" + random()); // Note: Make sure ID is unique\r\n\t\t\t\tvar $lbl = $('<label class=\"custom-control-label\"></label>').attr(\"for\", $el.attr(\"id\")).append(opts[i].lbl);\r\n\t\t\t\tvar $opt = $('<a class=\"list-group-item list-group-item-action\" href=\"#\"></a>').append($el, $lbl);\r\n\t\t\t\tvar args = {\"name\": id, \"form\": f, \"value\": opts[i].val, \"text\": opts[i].lbl, \"option\": $opt};\r\n\t\t\t\t$document.trigger(\"newoption\", [args]); // Fire \"newoption\" event for radio list\r\n\t\t\t\t$div.append(args.option);\r\n\t\t\t}\r\n\t\t\t$p.find(\"div\").first().append($div);\r\n\t\t}\r\n\t\t$clr.prop(\"disabled\", $btn && ($btn.html() || \"\").trim() == ew.language.phrase(\"PleaseSelect\")).off().click(function(e) {\r\n\t\t\t$p.find(\"[data-field][type=radio], [data-field][type=checkbox]\").prop(\"checked\", false).first().triggerHandler(\"click\");\r\n\t\t\t$p.find(\".list-group-item.active\").removeClass(\"active\");\r\n\t\t\t$btn.html(ew.language.phrase(\"PleaseSelect\"));\r\n\t\t});\r\n\t}\r\n\tif (!$p.hasClass(\"dropdown-menu\"))\r\n\t\t$p.removeClass(\"d-none\");\r\n\t$p.data(\"options\", []);\r\n}\r\n\r\n// Select combobox option\r\nexport function selectOption(obj, values) {\r\n\tif (!obj || !values)\r\n\t\treturn;\r\n\tvar $obj = $(obj);\r\n\tif ($.isArray(values)) {\r\n\t\tif (obj.options) { // Selection list\r\n\t\t\t$(obj).val(values);\r\n\t\t\tif (obj.type == \"select-one\" && obj.selectedIndex == -1)\r\n\t\t\t\tobj.selectedIndex = 0; // Make sure an option is selected (IE)\r\n\t\t} else if (obj.length) { // Radio/Checkbox list\r\n\t\t\tif (obj.length == 1 && obj[0].type == \"checkbox\" && obj[0].value != \"{value}\") { // Assume boolean field\r\n\t\t\t\tobj[0].checked = (convertToBool(obj[0].value) === convertToBool(values[0]));\r\n\t\t\t} else {\r\n\t\t\t\t$obj.val(values).closest(\".ew-dropdown-list\").find(\".ew-dropdown-clear\").prop(\"disabled\", false);\r\n\t\t\t}\r\n\t\t} else if (isAutoSuggest(obj) && values.length == 1) {\r\n\t\t\tvar o = getAutoSuggest(obj), opts = o._options || [];\r\n\t\t\tfor (var i = 0, len = opts.length; i < len; i++) {\r\n\t\t\t\tif (opts[i].val == values[0]) {\r\n\t\t\t\t\tobj.value = opts[i].val;\r\n\t\t\t\t\to.input.value = opts[i].lbl;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (isModalLookup(obj)) {\r\n\t\t\tvar $obj = $(obj), vals = [], html = [], opts = $obj.data(\"options\") || [];\r\n\t\t\tfor (var j = 0, cnt = values.length; j < cnt; j++) {\r\n\t\t\t\tfor (var i = 0, len = opts.length; i < len; i++) {\r\n\t\t\t\t\tif (values[j] == opts[i].val) {\r\n\t\t\t\t\t\tvals.push(opts[i].val);\r\n\t\t\t\t\t\thtml.push(optionHtml(opts[i].lbl));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t$obj.val(vals.join(ew.MULTIPLE_OPTION_SEPARATOR));\r\n\t\t\t$obj.parent().find(\".ew-lookup-text\").html(optionsHtml(html, $obj.data(\"maxcount\")));\r\n\t\t} else if (obj.type) {\r\n\t\t\tobj.value = values.join(ew.MULTIPLE_OPTION_SEPARATOR);\r\n\t\t}\r\n\t}\r\n\t// Auto-select if only one option\r\n\tfunction isAutoSelect(el) {\r\n\t\tif (!$(el).data(\"autoselect\")) // data-autoselect=\"false\"\r\n\t\t\treturn false;\r\n\t\tvar form = getForm(el);\r\n\t\tif (form) {\r\n\t\t\tif (/s(ea)?rch$/.test(form.id)) // Search forms\r\n\t\t\t\treturn false;\r\n\t\t\tvar list = _forms[form.id].lists(el.id);\r\n\t\t\tif (list && list.parentFields.length == 0) // No parent fields\r\n\t\t\t\treturn false;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tif (obj.options) { // Selection List\r\n\t\tif (obj.type == \"select-one\" && obj.options.length == 2 && !obj.options[1].selected && isAutoSelect(obj)) {\r\n\t\t\tobj.options[1].selected = true;\r\n\t\t} else if (obj.type == \"select-multiple\" && obj.options.length == 1 && !obj.options[0].selected && isAutoSelect(obj)) {\r\n\t\t\tobj.options[0].selected = true;\r\n\t\t}\r\n\t} else if (obj.length) { // Radio/Checkbox list\r\n\t\tif (obj.length == 2 && isAutoSelect(obj[1]))\r\n\t\t\tobj[1].checked = true;\r\n\t\tif (obj[0].type == \"radio\")\r\n\t\t\t$obj.filter(\":checked\").closest(\".list-group-item\").addClass(\"active\");\r\n\t\tvar $div = $obj.closest(\".dropdown-menu\");\r\n\t\tvar $btn = $div.closest(\".ew-dropdown-list\").find(\".dropdown-toggle\");\r\n\t\tif ($btn[0]) {\r\n\t\t\tvar $items = $div.find(\"input[name='\" + obj[0].name + \"']:checked\");\r\n\t\t\tvar $vals = $items.map(function() {\r\n\t\t\t\treturn $(this).parent().text();\r\n\t\t\t});\r\n\t\t\t$btn.html(optionsHtml($vals.get(), $obj.data(\"maxcount\")));\r\n\t\t}\r\n\t} else if (isAutoSuggest(obj)) {\r\n\t\tvar o = getAutoSuggest(obj), opts = o._options || [];\r\n\t\tif (opts.length == 1 && isAutoSelect(obj)) {\r\n\t\t\tobj.value = opts[0].val;\r\n\t\t\to.input.value = opts[0].lbl;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// Ajax send\r\n$document.ajaxSend(function(event, jqxhr, settings) {\r\n\tvar url = settings.url;\r\n\tif (url.match(/\\w+preview(\\w+)?(\\.php)?\\?/i)) // Preview page\r\n\t\t_removeSpinner(); // Preview has spinner already\r\n\tvar apiUrl = getApiUrl(), isApi = url.startsWith(apiUrl), // Is API request\r\n\t\tallowed = isApi || url.startsWith(currentPage());\r\n\tif (!allowed && url.match(/^http/i)) {\r\n\t\tvar objUrl = new URL(url);\r\n\t\tallowed = objUrl.hostname == currentUrl.hostname; // Same host name\r\n\t}\r\n\tif (allowed) {\r\n\t\tif (isApi && ew.API_JWT_TOKEN && !ew.IS_WINDOWS_AUTHENTICATION) // Do NOT set JWT authorization header if Windows Authentication\r\n\t\t\tjqxhr.setRequestHeader(ew.API_JWT_AUTHORIZATION_HEADER, \"Bearer \" + ew.API_JWT_TOKEN);\r\n\t\tif (settings.type == \"GET\") { // GET\r\n\t\t\tvar ar = settings.url.split(\"?\"), params = new URLSearchParams(ar[1]);\r\n\t\t\t//***params.set(ew.TOKEN_NAME, ew.ANTIFORGERY_TOKEN); // Add token\r\n\t\t\tparams.set(ew.TOKEN_NAME_KEY, ew.TOKEN_NAME); // Add token name //*** PHP\r\n\t\t\tparams.set(ew.ANTIFORGERY_TOKEN_KEY, ew.ANTIFORGERY_TOKEN); // Add antiforgery token //*** PHP\r\n\t\t\tar[1] = params.toString();\r\n\t\t\tsettings.url = ar[0] + (ar[1] ? \"?\" + ar[1] : \"\");\r\n\t\t} else { // POST\r\n\t\t\tif (settings.data instanceof FormData) { // FormData\r\n\t\t\t\t//***settings.data.set(ew.TOKEN_NAME, ew.ANTIFORGERY_TOKEN); // Add token\r\n\t\t\t\tsettings.data.set(ew.TOKEN_NAME_KEY, ew.TOKEN_NAME); // Add token name //*** PHP\r\n\t\t\t\tsettings.data.set(ew.ANTIFORGERY_TOKEN_KEY, ew.ANTIFORGERY_TOKEN); // Add antiforgery token //*** PHP\r\n\t\t\t} else {\r\n\t\t\t\tvar params = new URLSearchParams(settings.data);\r\n\t\t\t\t//***params.set(ew.TOKEN_NAME, ew.ANTIFORGERY_TOKEN); // Add token\r\n\t\t\t\tparams.set(ew.TOKEN_NAME_KEY, ew.TOKEN_NAME); // Add token name //*** PHP\r\n\t\t\t\tparams.set(ew.ANTIFORGERY_TOKEN_KEY, ew.ANTIFORGERY_TOKEN); // Add antiforgery token //*** PHP\r\n\t\t\t\tsettings.data = params.toString();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\n// Ajax start\r\n$document.ajaxStart(function() {\r\n\t$document.data(\"_ajax\", true);\r\n\tew.addSpinner();\r\n\t$(\"form.ew-form\").addClass(\"ew-wait\").each(function() {\r\n\t\tvar frm = _forms[this.id];\r\n\t\tif (frm) {\r\n\t\t\tif (!frm.multiPage || !frm.multiPage.lastPageSubmit)\r\n\t\t\t\tfrm.disableForm();\r\n\t\t}\r\n\t});\r\n});\r\n\r\n// Ajax stop (internal)\r\nfunction _ajaxStop() {\r\n\t$(\"form.ew-form.ew-wait\").removeClass(\"ew-wait\").each(function() {\r\n\t\tvar frm = _forms[this.id];\r\n\t\tif (frm) {\r\n\t\t\tif (!frm.multiPage || !frm.multiPage.lastPageSubmit)\r\n\t\t\t\tfrm.enableForm();\r\n\t\t}\r\n\t});\r\n\tremoveSpinner();\r\n\t$document.data(\"_ajax\", false);\r\n}\r\n\r\n// Ajax stop/error\r\n$document.ajaxStop(_ajaxStop).ajaxError(_ajaxStop);\r\n\r\n// Execute JavaScript in HTML loaded by Ajax\r\nexport function executeScript(html, id) {\r\n\tvar ar, i = 0, re = /<script([^>]*)>([\\s\\S]*?)<\\/script\\s*>/ig;\r\n\thtml = html.replace(/<head>[\\s\\S]*<\\/head>/, \"\");\r\n\twhile ((ar = re.exec(html)) != null) {\r\n\t\tvar text = ar[2];\r\n\t\tif (/(\\s+type\\s*=\\s*['\"]*text\\/javascript['\"]*)|^((?!\\s+type\\s*=).)*$/i.test(ar[1]) && text)\r\n\t\t\taddScript(text, \"scr_\" + id + \"_\" + i++);\r\n\t}\r\n}\r\n\r\n// Strip JavaScript in HTML loaded by Ajax\r\nexport function stripScript(html) {\r\n\tvar ar, re = /<script([^>]*)>([\\s\\S]*?)<\\/script\\s*>/ig;\r\n\tvar str = html;\r\n\twhile ((ar = re.exec(html)) != null) {\r\n\t\tvar text = ar[0];\r\n\t\tif (/(\\s+type\\s*=\\s*['\"]*text\\/javascript['\"]*)|^((?!\\s+type\\s*=).)*$/i.test(ar[1]))\r\n\t\t\tstr = str.replace(text, \"\");\r\n\t}\r\n\treturn str;\r\n}\r\n\r\n// Add SCRIPT tag\r\nexport function addScript(text, id) {\r\n\tvar scr = document.createElement(\"SCRIPT\");\r\n\tif (id)\r\n\t\tscr.id = id;\r\n\tscr.text = text;\r\n\treturn document.body.appendChild(scr); // Do not use jQuery so it can be removed\r\n}\r\n\r\n// Remove JavaScript added by Ajax\r\nexport function removeScript(id) {\r\n\tif (id)\r\n\t\t$(\"script[id^='scr_\" + id + \"_']\").remove();\r\n}\r\n\r\n// Clean HTML loaded by Ajax for modal dialog\r\nexport function getContent(html) {\r\n\tvar body = stripScript(html).match(/<body[\\s\\S]*>[\\s\\S]*<\\/body>/i);\r\n\treturn $(body[0]).not(\"div[id^=ew].modal, #ew-tooltip, #cookie-consent\");\r\n}\r\n\r\n// Get all options of Selection list or Radio/Checkbox list as array [{ name: \"name\", value: \"value\" }, ...]\r\nexport function getOptions(obj) {\r\n\tif (obj.options) {\r\n\t\treturn Array.prototype.map.call(obj.options, function(opt) {\r\n\t\t\treturn { value: opt.value, name: opt.text };\r\n\t\t});\r\n\t} else if (obj.length) {\r\n\t\treturn getContainer(obj).data(\"options\") || [];\r\n\t}\r\n\treturn [];\r\n}\r\n\r\n/**\r\n * Show Add Option dialog\r\n *\r\n * @param {Object} args - Arguments\r\n * @param {Object} args.frm - form object\r\n * @param {HTMLElement} args.lnk - Add option anchor element\r\n * @param {string} args.el - Form element name\r\n * @param {string} args.url - URL of the Add form\r\n * @returns\r\n */\r\nexport function addOptionDialogShow(args) {\r\n\r\n\t// Hide dialog\r\n\tvar _hide = function() {\r\n\t\tremoveScript($dlg.data(\"args\").el);\r\n\t\tvar frm = $dlg.removeData(\"args\").find(\".modal-body form\").data(\"form\");\r\n\t\tif (frm)\r\n\t\t\tfrm.destroyEditor();\r\n\t\t$dlg.find(\".modal-body\").html(\"\");\r\n\t\t$dlg.find(\".modal-footer .btn-primary\").unbind();\r\n\t\t$dlg.data(\"showing\", false);\r\n\t}\r\n\r\n\tvar $dlg = ew.addOptionDialog || $(\"#ew-add-opt-dialog\").on(\"hidden.bs.modal\", _hide);\r\n\tif (!$dlg[0]) {\r\n\t\t_alert(\"DIV #ew-add-opt-dialog not found.\");\r\n\t\treturn;\r\n\t}\r\n\tif ($dlg.data(\"showing\"))\r\n\t\treturn;\r\n\t$dlg.data(\"showing\", true);\r\n\r\n\t// Submission success\r\n\tvar _submitSuccess = function(data) {\r\n\t\tvar results = data,\r\n\t\t\targs = $dlg.data(\"args\"),\r\n\t\t\tfrm = forms(args.lnk), // form object\r\n\t\t\tobjName = $dlg.find(\".modal-body form input[name='\" + ew.API_OBJECT_NAME + \"']\").val(), // Get object name from form\r\n\t\t\tel = args.el, // HTML element\r\n\t\t\tre = /^x(\\d+)_/,\r\n\t\t\tm = el.match(re), // Check row index\r\n\t\t\tprefix = m ? m[0] : \"x_\",\r\n\t\t\tindex = m ? m[1] : -1,\r\n\t\t\tname = el.replace(re, \"x_\"),\r\n\t\t\tlist = frm.lists[name];\r\n\t\tif ($.isString(data))\r\n\t\t\tresults = parseJson(data);\r\n\t\tif (results && results.success && results[objName]) {\r\n\t\t\tvar result = results[objName];\r\n\t\t\t$dlg.modal(\"hide\");\r\n\t\t\tvar form = frm.$element[0]; // HTML form or DIV\r\n\t\t\tvar obj = getElements(el, form);\r\n\t\t\tif (obj) {\r\n\t\t\t\tvar name = el.replace(re, \"x_\");\r\n\t\t\t\tvar lf = frm.lists[name].linkField,\r\n\t\t\t\t\tdfs = frm.lists[name].displayFields.slice(), // Clone\r\n\t\t\t\t\tffs = frm.lists[name].filterFields.slice(), // Clone\r\n\t\t\t\t\tpfs = frm.lists[name].parentFields.slice(); // Clone\r\n\t\t\t\tfor (var i = 0, len = pfs.length; i < len; i++) {\r\n\t\t\t\t\tvar ar = pfs[i].split(\" \");\r\n\t\t\t\t\tif (ar.length == 1) // Parent field in the same table, add row index\r\n\t\t\t\t\t\tpfs[i] = pfs[i].replace(/^x_/, prefix);\r\n\t\t\t\t}\r\n\t\t\t\tvar lfv = (lf != \"\") ? result[lf] : \"\";\r\n\t\t\t\tvar row = { lf: lfv };\r\n\t\t\t\tfor (var i = 0, len = dfs.length; i < len; i++) {\r\n\t\t\t\t\tif (dfs[i] in result)\r\n\t\t\t\t\t\trow[\"df\" + (i || \"\")] = result[dfs[i]];\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i = 0, len = ffs.length; i < len; i++) {\r\n\t\t\t\t\tif (ffs[i] in result)\r\n\t\t\t\t\t\trow[\"ff\" + (i || \"\")] = result[ffs[i]];\r\n\t\t\t\t}\r\n\t\t\t\tif (lfv && dfs.length > 0 && row[\"df\"]) {\r\n\t\t\t\t\tvar id = getId(el, false), nid = id.replace(new RegExp(\"^\" + prefix), \"x_\");\r\n\t\t\t\t\tif (frm.lists[nid].ajax === null) { // Non-Ajax\r\n\t\t\t\t\t\tvar ar = frm.lists[nid].options;\r\n\t\t\t\t\t\tar.push(row);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Get the parent field values\r\n\t\t\t\t\tvar arp = [];\r\n\t\t\t\t\tfor (var i = 0, len = pfs.length; i < len; i++)\r\n\t\t\t\t\t\tarp.push(getOptionValues(pfs[i], form));\r\n\t\t\t\t\tvar args = {\"data\": row, \"parents\": arp, \"valid\": true, \"name\": getId(obj), \"form\": form};\r\n\t\t\t\t\t$document.trigger(\"addoption\", [args]);\r\n\t\t\t\t\tif (args.valid) { // Add the new option\r\n\t\t\t\t\t\tvar ar = getOptions(obj), vals = [];\r\n\t\t\t\t\t\tif (!obj.options && obj.length) { // Radio/Checkbox list\r\n\t\t\t\t\t\t\tvals = getOptionValues(obj);\r\n\t\t\t\t\t\t\tgetContainer(obj).find(\"div\").first().empty();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar txt = newOption(obj, row, form);\r\n\t\t\t\t\t\tif (obj.options) {\r\n\t\t\t\t\t\t\tobj.options[obj.options.length-1].selected = true;\r\n\t\t\t\t\t\t\t$(obj).change().focus();\r\n\t\t\t\t\t\t} else if (obj.length) { // Radio/Checkbox list\r\n\t\t\t\t\t\t\trenderOption(obj);\r\n\t\t\t\t\t\t\tobj = getElements(id, form); // Update the list\r\n\t\t\t\t\t\t\tif (vals.length > 0)\r\n\t\t\t\t\t\t\t\tselectOption(obj, vals);\r\n\t\t\t\t\t\t\tif (obj.length > 0) {\r\n\t\t\t\t\t\t\t\tvar el = $(obj).filter(\"[value!='{value}']\").last()[0];\r\n\t\t\t\t\t\t\t\tif (el.type == \"checkbox\" || el.type == \"radio\")\r\n\t\t\t\t\t\t\t\t\tel.click(); // Select new option and trigger click event\r\n\t\t\t\t\t\t\t\tel.focus();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (isAutoSuggest(obj)) {\r\n\t\t\t\t\t\t\tvar o = getAutoSuggest(obj);\r\n\t\t\t\t\t\t\t$(obj).val(lfv).change();\r\n\t\t\t\t\t\t\t$(o.input).val(txt).focus();\r\n\t\t\t\t\t\t} else if (isModalLookup(obj)) {\r\n\t\t\t\t\t\t\tvar $obj = $(obj), $lu = $(getElement(\"lu_\" + args.name, form));\r\n\t\t\t\t\t\t\tif ($obj.data(\"multiple\")) { // Add to existing values\r\n\t\t\t\t\t\t\t\tvar val = $(obj).val(), vals = [], nv = String(lfv);\r\n\t\t\t\t\t\t\t\tif (val !== \"\")\r\n\t\t\t\t\t\t\t\t\tvals = val.split(ew.MULTIPLE_OPTION_SEPARATOR);\r\n\t\t\t\t\t\t\t\tif (!vals.includes(nv)) {\r\n\t\t\t\t\t\t\t\t\tvals.push(nv);\r\n\t\t\t\t\t\t\t\t\t$obj.val(vals.join()).change();\r\n\t\t\t\t\t\t\t\t\tvar html = $lu.html(), arOpt = $lu.find(\".ew-option\").map(function() {\r\n\t\t\t\t\t\t\t\t\t\treturn $(this).html();\r\n\t\t\t\t\t\t\t\t\t}).get();\r\n\t\t\t\t\t\t\t\t\tif (arOpt.length) { // Some options selected\r\n\t\t\t\t\t\t\t\t\t\tarOpt.push(txt);\r\n\t\t\t\t\t\t\t\t\t\t$lu.html(optionsHtml(arOpt, $obj.data(\"maxcount\")));\r\n\t\t\t\t\t\t\t\t\t} else if (html == ew.language.phrase(\"PleaseSelect\")) { // No options selected\r\n\t\t\t\t\t\t\t\t\t\t$lu.html(optionHtml(txt));\r\n\t\t\t\t\t\t\t\t\t} else if (html) { // Many options selected\r\n\t\t\t\t\t\t\t\t\t\t$lu.html(ew.language.phrase(\"CountSelected\").replace(\"%s\", vals.length));\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$obj.val(lfv).change();\r\n\t\t\t\t\t\t\t\t$lu.html(txt);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar $form = $(form), suffix = ($form.is(\"div\")) ? \"_\" + $form.attr(\"id\") : \"\";\r\n\t\t\t\t\t\tvar cnt = $form.find(\"#key_count\" + suffix).val();\r\n\t\t\t\t\t\tif (cnt > 0) { // Grid-Add/Edit, update other rows\r\n\t\t\t\t\t\t\tfor (var i = 1; i <= cnt; i++) {\r\n\t\t\t\t\t\t\t\tif (i == index)\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\tvar obj2 = getElements(name.replace(/^x/, \"x\" + i), form);\r\n\t\t\t\t\t\t\t\tvar ar2 = getOptions(obj2), vals = [];\r\n\t\t\t\t\t\t\t\tif (JSON.stringify(ar) != JSON.stringify(ar2)) // Not same options\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\tif (!obj2.options && obj2.length) // Radio/Checkbox list\r\n\t\t\t\t\t\t\t\t\tvals = getOptionValues(obj2);\r\n\t\t\t\t\t\t\t\tnewOption(obj2, row, form);\r\n\t\t\t\t\t\t\t\tif (!obj2.options && obj2.length) { // Radio/Checkbox list\r\n\t\t\t\t\t\t\t\t\trenderOption(obj2);\r\n\t\t\t\t\t\t\t\t\tif (vals.length > 0)\r\n\t\t\t\t\t\t\t\t\t\tselectOption(obj2, vals);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar msg, $div = $dlg.find(\"div.ew-message-dialog\").html(\"\"),\r\n\t\t\t\t$div2 = $(\"<div></div>\").html(data).find(\"div.ew-message-dialog\");\r\n\t\t\tif ($div2[0]) {\r\n\t\t\t\tmsg = $div2.html();\r\n\t\t\t} else {\r\n\t\t\t\tmsg = (results && results.failureMessage) ? results.failureMessage : data;\r\n\t\t\t\tif (!msg || String(msg).trim() == \"\")\r\n\t\t\t\t\tmsg = ew.language.phrase(\"InsertFailed\");\r\n\t\t\t\tmsg = \"<p class=\\\"text-danger\\\">\" + msg + \"</p>\";\r\n\t\t\t}\r\n\t\t\t$div.html(msg).show();\r\n\t\t}\r\n\t}\r\n\r\n\t// Fail\r\n\tvar _fail = function(o) {\r\n\t\t$dlg.modal(\"hide\");\r\n\t\t_alert(\"Server Error \" + o.status + \": \" + o.statusText);\r\n\t}\r\n\r\n\t// Submit\r\n\tvar _submit = function(e) {\r\n\t\tvar $dlg = ew.addOptionDialog;\r\n\t\tvar form = $dlg.find(\".modal-body form\")[0];\r\n\t\tvar frm = _forms[form.id];\r\n\t\tvar btn = e ? e.target : null;\r\n\t\tif (btn) {\r\n\t\t\tfrm.enableForm = function() {\r\n\t\t\t\t$(btn).prop(\"disabled\", false).removeClass(\"disabled\");\r\n\t\t\t};\r\n\t\t\tfrm.disableForm = function() {\r\n\t\t\t\t$(btn).prop(\"disabled\", true).addClass(\"disabled\");\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (frm.canSubmit())\r\n\t\t\t$.post(getApiUrl(ew.API_ADD_ACTION), $(form).serialize(), _submitSuccess).fail(_fail).always(function() {\r\n\t\t\t\tfrm.enableForm();\r\n\t\t\t});\r\n\t\treturn false;\r\n\t}\r\n\r\n\t$dlg.modal(\"hide\");\r\n\t$dlg.data(\"args\", args);\r\n\r\n\t// Get form HTML\r\n\tvar success = function(data) {\r\n\t\tvar frm = forms(args.lnk),\r\n\t\t\tprefix = \"x_\",\r\n\t\t\tm = args.el.match(/^(x\\d+_)/);\r\n\t\tif (m) // Contains row index\r\n\t\t\tprefix = m[1];\r\n\t\tvar name = args.el.replace(prefix, \"x_\");\r\n\t\tvar pf = frm.lists[name].parentFields.slice(); // Clone\r\n\t\tvar ff = frm.lists[name].filterFieldVars.slice(); // Clone\r\n\t\tvar form = frm._form;\r\n\t\tvar ar = [], ar2 = [];\r\n\t\tfor (var i = 0, len = pf.length; i < len; i++) {\r\n\t\t\tvar arr = pf[i].split(\" \");\r\n\t\t\tif (arr.length == 1) // Parent field in the same table, add row index\r\n\t\t\t\tpf[i] = pf[i].replace(/^x_/, prefix);\r\n\t\t}\r\n\t\tfor (var i = 0, len = pf.length; i < len; i++) {\r\n\t\t\tar.push(getOptionValues(pf[i], form));\r\n\t\t\tar2.push(getOptionTexts(pf[i], form));\r\n\t\t}\r\n\t\t$dlg.find(\".modal-title\").html($(args.lnk).closest(\".ew-add-opt-btn\").data(\"title\"));\r\n\t\t$dlg.find(\".modal-body\").html(stripScript(data));\r\n\t\tvar form = $dlg.find(\".modal-body form\")[0];\r\n\t\tif (form) { // Set the filter field value\r\n\t\t\t$(form).keypress(function(e) {\r\n\t\t\t\tif (e.which == 13 && e.target.nodeName != \"TEXTAREA\")\r\n\t\t\t\t\treturn _submit();\r\n\t\t\t});\r\n\t\t\tvar _sameObj = function(o1, o2) {\r\n\t\t\t\treturn $.isArray(o1) && $.isArray(o2) && o1[0] && o2[0] &&\r\n\t\t\t\t\to1.name == o2.name && o1.form == o2.form;\r\n\t\t\t}\r\n\t\t\tfor (var i = 0, len = ar.length; i < len; i++) {\r\n\t\t\t\tvar obj = getElements(ff[i], form);\r\n\t\t\t\tif (obj && (obj.options || obj.length)) { // Selection list\r\n\t\t\t\t\tvar v = ar[i];\r\n\t\t\t\t\t$document.one(\"updatedone\", function(e, args) {\r\n\t\t\t\t\t\tvar target = args.target;\r\n\t\t\t\t\t\tif (obj == target || _sameObj(obj, target))\r\n\t\t\t\t\t\t\tselectOption(target, v);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tew.addOptionDialog = $dlg.modal(\"show\");\r\n\t\t$dlg.find(\".modal-footer .btn-primary\").click(_submit).focus();\r\n\t\texecuteScript(data, args.el);\r\n\t\tif (form) { // Set the filter field value\r\n\t\t\tfor (var i = 0, len = ar.length; i < len; i++) {\r\n\t\t\t\tvar obj = getElements(ff[i], form);\r\n\t\t\t\tif (obj) {\r\n\t\t\t\t\tif (isAutoSuggest(obj)) { // AutoSuggest\r\n\t\t\t\t\t\tobj.value = ar[i][0];\r\n\t\t\t\t\t\tvar o = getAutoSuggest(obj);\r\n\t\t\t\t\t\to.input.value = ar2[i][0];\r\n\t\t\t\t\t\to._options.push({\"val\": ar[i][0], \"lbl\": ar2[i][0]});\r\n\t\t\t\t\t} else if (isModalLookup(obj)) { // Modal-Lookup\r\n\t\t\t\t\t\tobj.value = ar[i][0];\r\n\t\t\t\t\t\tupdateOptions.call(_forms[form.id], obj);\r\n\t\t\t\t\t} else if (obj.options || obj.length) { // Selection list\r\n\t\t\t\t\t\t// Skip\r\n\t\t\t\t\t} else { // Text\r\n\t\t\t\t\t\tobj.value = ar[i][0];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t$dlg.trigger(\"load.ew\");\r\n\t};\r\n\t$.get(args.url, success).fail(_fail);\r\n}\r\n\r\n// Hide Modal dialog\r\nexport function modalDialogHide(e) {\r\n\tvar $dlg = $(this), args = $dlg.data(\"args\");\r\n\tremoveScript(\"ModalDialog\");\r\n\tvar frm = $dlg.removeData(\"args\").find(\".modal-body form\").data(\"form\");\r\n\tif (frm)\r\n\t\tfrm.destroyEditor();\r\n\tvar $bd = $dlg.find(\".modal-body\").html(\"\");\r\n\tif ($bd.ewjtable && $bd.ewjtable(\"instance\"))\r\n\t\t$bd.ewjtable(\"destroy\");\r\n\t$dlg.find(\".modal-footer .btn-primary\").unbind();\r\n\t$dlg.find(\".modal-dialog\").removeClass(function(index, className) {\r\n\t\tvar m = className.match(/table\\-\\w+/);\r\n\t\treturn (m) ? m[0] : \"\";\r\n\t});\r\n\t$dlg.data(\"showing\", false);\r\n\t$dlg.data(\"url\", null);\r\n\tif (args && args.reload)\r\n\t\twindow.location.reload(true);\r\n}\r\n\r\n/**\r\n * Show modal dialog\r\n *\r\n * @param {Object} args - Arguments\r\n * @param {HTMLFormElement} args.f - Form of List page\r\n * @param {HTMLElement} args.lnk - Anchor element\r\n * @param {string} args.url - URL of the form\r\n * @param {string|null} args.btn - Button phrase ID\r\n * @param {string} args.caption - Caption in dialog header\r\n * @param {boolean} args.reload - Reload page after hiding dialog or not\r\n * @param {string} args.size - Size of the dialog 'modal-sm'|''|modal-lg'|'modal-xl'(default)\r\n * @returns false\r\n */\r\nexport function modalDialogShow(args) {\r\n\t$(args.lnk).tooltip(\"hide\");\r\n\tvar f = args.f;\r\n\tif (f && !keySelected(f)) {\r\n\t\t_prompt(\"<p class=\\\"text-danger\\\">\" + ew.language.phrase(\"NoRecordSelected\") + \"</p>\");\r\n\t\treturn false;\r\n\t}\r\n\r\n\tvar $dlg = ew.modalDialog || $(\"#ew-modal-dialog\").on(\"hidden.bs.modal\", modalDialogHide); // div#ew-modal-dialog always exists\r\n\tif ($dlg.data(\"showing\") && $dlg.data(\"url\") == args.url)\r\n\t\treturn false;\r\n\t$dlg.data({ showing: true, url: args.url });\r\n\targs.reload = false;\r\n\r\n\t// size\r\n\tif (args.size === \"modal-sm\") { // 300px\r\n\t\t$dlg.find(\".modal-dialog\").toggleClass(\"modal-sm\", true).toggleClass(\"modal-lg modal-xl\", false);\r\n\t} else if (args.size === \"\") { // 500px\r\n\t\t$dlg.find(\".modal-dialog\").toggleClass(\"modal-sm modal-lg modal-xl\", false);\r\n\t} else if (args.size === \"modal-lg\") { // 800px\r\n\t\t$dlg.find(\".modal-dialog\").toggleClass(\"modal-lg\", true).toggleClass(\"modal-sm modal-xl\", false);\r\n\t} else { // Default = 1140px\r\n\t\t$dlg.find(\".modal-dialog\").toggleClass(\"modal-xl\", true).toggleClass(\"modal-sm modal-lg\", false);\r\n\t}\r\n\r\n\t// caption\r\n\tvar _caption = function() {\r\n\t\tvar args = $dlg.data(\"args\");\r\n\t\tvar $lnk = $(args.lnk);\r\n\t\treturn args.caption || $lnk.data(\"caption\") || $lnk.data(\"original-title\") || \"\";\r\n\t};\r\n\r\n\t// button text\r\n\tvar _button = function() {\r\n\t\tvar args = $dlg.data(\"args\");\r\n\t\tif ($.isNull(args.btn))\r\n\t\t\treturn \"\";\r\n\t\telse if (args.btn && args.btn != \"\")\r\n\t\t\treturn ew.language.phrase(args.btn);\r\n\t\telse\r\n\t\t\treturn _caption();\r\n\t};\r\n\r\n\t// fail\r\n\tvar _fail = function(o) {\r\n\t\t$dlg.modal(\"hide\");\r\n\t\tif (o.status)\r\n\t\t\t_alert(\"Server Error \" + o.status + \": \" + o.statusText);\r\n\t}\r\n\r\n\t// always\r\n\tvar _always = function(o) {\r\n\t\t$body.css(\"cursor\", \"default\");\r\n\t}\r\n\r\n\t// check if current page\r\n\tvar _current = function(url) {\r\n\t\tvar a = $(\"<a>\", { href: url })[0];\r\n\t\treturn window.location.pathname.endsWith(a.pathname);\r\n\t}\r\n\r\n\t// submit success\r\n\tvar _submitSuccess = function(data) {\r\n\t\tvar result = parseJson(data);\r\n\t\tif ($.isObject(result)) {\r\n\t\t\tvar url = result.url;\r\n\t\t\tif (result.modal && !_current(url)) {\r\n\t\t\t\tvar args = $dlg.data(\"args\");\r\n\t\t\t\targs.reload = true;\r\n\t\t\t\tif (result.caption)\r\n\t\t\t\t\targs.caption = result.caption;\r\n\t\t\t\targs.btn = result.view ? null : \"\";\r\n\t\t\t\t$dlg.data(\"args\", args);\r\n\t\t\t\turl += (url.split(\"?\").length > 1 ? \"&\" : \"?\") + \"modal=1&rnd=\" + random();\r\n\t\t\t\t$body.css(\"cursor\", \"wait\");\r\n\t\t\t\t$.ajax(url).done(success).fail(_fail).always(_always);\r\n\t\t\t} else {\r\n\t\t\t\t$dlg.modal(\"hide\");\r\n\t\t\t\twindow.location = url;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar body = getContent(data);\r\n\t\t\tvar $bd = $dlg.find(\".modal-body\").html(body);\r\n\t\t\tvar footer = \"\";\r\n\t\t\tvar cf = $bd.find(\"#confirm\");\r\n\t\t\tvar ct = $bd.find(\"#conflict\");\r\n\t\t\tif (ct && ct.val() == \"1\") { // Conflict page\r\n\t\t\t\tfooter += \"<button type=\\\"button\\\" id=\\\"btn-overwrite\\\" class=\\\"btn btn-primary ew-btn\\\">\" + ew.language.phrase(\"OverwriteBtn\") + \"</button>\";\r\n\t\t\t\tfooter += \"<button type=\\\"button\\\" id=\\\"btn-reload\\\" class=\\\"btn btn-default ew-btn\\\">\" + ew.language.phrase(\"ReloadBtn\") + \"</button>\";\r\n\t\t\t\tfooter += \"<button type=\\\"button\\\" class=\\\"btn btn-default ew-btn\\\" data-dismiss=\\\"modal\\\">\" + ew.language.phrase(\"CancelBtn\") + \"</button>\";\r\n\t\t\t\t$dlg.find(\".modal-footer\").html(footer);\r\n\t\t\t\t$dlg.find(\".modal-footer #btn-overwrite\").on('click', {action: 'overwrite'}, _submit);\r\n\t\t\t\t$dlg.find(\".modal-footer #btn-reload\").on('click', {action: 'show'}, _submit);\r\n\t\t\t} else if (cf && cf.val() == \"confirm\") { // Confirm page\r\n\t\t\t\tfooter += \"<button type=\\\"button\\\" class=\\\"btn btn-primary ew-btn\\\">\" + ew.language.phrase(\"ConfirmBtn\") + \"</button>\";\r\n\t\t\t\tfooter += \"<button type=\\\"button\\\" class=\\\"btn btn-default ew-btn\\\">\" + ew.language.phrase(\"CancelBtn\") + \"</button>\";\r\n\t\t\t\t$dlg.find(\".modal-footer\").html(footer);\r\n\t\t\t\t$dlg.find(\".modal-footer .btn-primary\").click(_submit).focus();\r\n\t\t\t\t$dlg.find(\".modal-footer .btn-default\").on(\"click\", {action: \"cancel\"}, _submit);\r\n\t\t\t} else { // Normal page\r\n\t\t\t\tvar btn = _button();\r\n\t\t\t\tif (btn)\r\n\t\t\t\t\tfooter += \"<button type=\\\"button\\\" class=\\\"btn btn-primary ew-btn\\\">\" + btn + \"</button>\";\r\n\t\t\t\tfooter += \"<button type=\\\"button\\\" class=\\\"btn btn-default ew-btn\\\" data-dismiss=\\\"modal\\\">\" + ew.language.phrase(\"CancelBtn\") + \"</button>\";\r\n\t\t\t\t$dlg.find(\".modal-footer\").html(footer);\r\n\t\t\t\t$dlg.find(\".modal-footer .btn-primary\").addClass(\"ew-submit\").click(_submit).focus();\r\n\t\t\t}\r\n\t\t\texecuteScript(data, \"ModalDialog\");\r\n\t\t\t$dlg.trigger(\"load.ew\"); // Trigger load event for, e.g. Use JavaScript popup message\r\n\t\t}\r\n\t}\r\n\r\n\t// submit\r\n\tvar _submit = function(e) {\r\n\t\tvar form = $dlg.find(\".modal-body form\")[0], $form = $(form);\r\n\t\tvar frm = _forms[form.id];\r\n\t\tvar action = e && e.data ? e.data.action : null;\r\n\t\tvar btn = e ? e.target : null;\r\n\t\tif (btn) {\r\n\t\t\tfrm.enableForm = function() {\r\n\t\t\t\t$(btn).prop(\"disabled\", false).removeClass(\"disabled\");\r\n\t\t\t};\r\n\t\t\tfrm.disableForm = function() {\r\n\t\t\t\t$(btn).prop(\"disabled\", true).addClass(\"disabled\");\r\n\t\t\t};\r\n\t\t}\r\n\t\tvar input = form.elements[\"action\"];\r\n\t\tif (action && input)\r\n\t\t\tinput.value = action; // Update action\r\n\t\tif (action == \"cancel\") { // Cancel\r\n\t\t\t$.post($form.attr(\"action\"), $form.serialize(), success).fail(_fail).always(_always);\r\n\t\t} else if (frm.canSubmit()) {\r\n\t\t\t$.post($form.attr(\"action\"), $form.serialize(), _submitSuccess).fail(_fail);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t$dlg.modal(\"hide\");\r\n\t$dlg.data(\"args\", args);\r\n\r\n\tvar success = function(data) {\r\n\t\tvar result = parseJson(data);\r\n\t\tif ($.isObject(result)) {\r\n\t\t\tif (result.error)\r\n\t\t\t\t_alert(result.error);\r\n\t\t} else {\r\n\t\t\tvar args = $dlg.data(\"args\");\r\n\t\t\tvar $data = $(data), $lnk = $(args.lnk);\r\n\t\t\t$dlg.find(\".modal-title\").html(_caption());\r\n\t\t\tvar footer = \"\";\r\n\t\t\tvar btn = _button();\r\n\t\t\tif (btn)\r\n\t\t\t\tfooter += \"<button type=\\\"button\\\" class=\\\"btn btn-primary ew-btn\\\">\" + btn + \"</button>\";\r\n\t\t\tif (footer != \"\")\r\n\t\t\t\tfooter += \"<button type=\\\"button\\\" class=\\\"btn btn-default ew-btn\\\" data-dismiss=\\\"modal\\\">\" + ew.language.phrase(\"CancelBtn\") + \"</button>\";\r\n\t\t\telse\r\n\t\t\t\tfooter = \"<button type=\\\"button\\\" class=\\\"btn btn-default ew-btn\\\" data-dismiss=\\\"modal\\\">\" + ew.language.phrase(\"CloseBtn\") + \"</button>\";\r\n\t\t\t$dlg.find(\".modal-footer\").html(footer);\r\n\t\t\tvar body = getContent(data);\r\n\t\t\t$dlg.find(\".modal-body\").html(body);\r\n\t\t\t$dlg.find(\".modal-body form\").keypress(function(e) {\r\n\t\t\t\tif (e.which == 13 && e.target.nodeName != \"TEXTAREA\")\r\n\t\t\t\t\treturn _submit();\r\n\t\t\t});\r\n\t\t\tew.modalDialog = $dlg.modal(\"show\");\r\n\t\t\t$dlg.find(\".modal-dialog\").addClass(\"table-\" + $lnk.data(\"table\"));\r\n\t\t\t$dlg.find(\".modal-footer .btn-primary\").addClass(\"ew-submit\").click(_submit).focus();\r\n\t\t\texecuteScript(data, \"ModalDialog\");\r\n\t\t\t$dlg.trigger(\"load.ew\"); // Trigger load event for, e.g. YouTube videos, ReCAPTCHA and Google maps\r\n\t\t}\r\n\t};\r\n\r\n\t$body.css(\"cursor\", \"wait\");\r\n\r\n\tvar url = args.url;\r\n\tif (f) { // Post form\r\n\t\tvar $f = $(f);\r\n\t\tif (!f.elements.modal)\r\n\t\t\t$(\"<input>\").attr({type: \"hidden\", name: \"modal\", value: \"1\"}).appendTo($f);\r\n\t\t$.post(url, $f.serialize(), success).fail(_fail).always(_always);\r\n\t} else {\r\n\t\turl += (url.split(\"?\").length > 1 ? \"&\" : \"?\") + \"modal=1&rnd=\" + random();\r\n\t\t$.get(url, success).fail(_fail).always(_always);\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\n// Show Modal Lookup\r\nexport function modalLookupShow(args) {\r\n\tvar el = args.el, f = getForm(args.lnk);\r\n\tif (!f || !el)\r\n\t\treturn;\r\n\r\n\tvar $dlg = ew.modalLookupDialog || $(\"#ew-modal-lookup-dialog\").on(\"hidden.bs.modal\", modalDialogHide);\r\n\tif (!$dlg[0]) {\r\n\t\t_alert(\"DIV #ew-modal-lookup-dialog not found.\");\r\n\t\treturn;\r\n\t}\r\n\tif ($dlg.data(\"showing\"))\r\n\t\treturn;\r\n\t$dlg.data(\"showing\", true);\r\n\r\n\tvar id = getId(el, true),\r\n\t\t$f = $(f),\r\n\t\t$input = $f.find(\"[id='\" + el + \"']\"), // id may contains \"[]\"\r\n\t\t$bd = $dlg.find(\".modal-body\"),\r\n\t\t$lnk = $(args.lnk),\r\n\t\t$lu = $lnk.closest(\".ew-lookup-list\").find(\".ew-lookup-text\").focus(),\r\n\t\toid = getId(el, false),\r\n\t\tm = oid.match(/^([xy])(\\d*)_/),\r\n\t\tprefix = (m) ? m[1] : \"\",\r\n\t\trowindex = (m) ? m[2] : \"\",\r\n\t\tnid = oid.replace(/^([xy])(\\d*)_/, \"x_\"),\r\n\t\tlist = _forms[f.id].lists(nid);\r\n\r\n\t// Format data\r\n\tvar _format = function(data) {\r\n\t\tif (data.result == \"OK\" && $.isArray(data.records)) {\r\n\t\t\tdata.records.forEach(function(ar, index) {\r\n\t\t\t\tvar item;\r\n\t\t\t\tif ($.isArray(ar))\r\n\t\t\t\t\titem = { \"lf\": ar[0], \"df1\": ar[1], \"df2\": ar[2], \"df3\": ar[3], \"df4\": ar[4] };\r\n\t\t\t\telse if ($.isObject(ar))\r\n\t\t\t\t\titem = { lf: ar.lf, df1: ar.df, df2: ar.df2, df3: ar.df3, df4: ar.df4 };\r\n\t\t\t\tvar txt = displayValue(ar, $input);\r\n\t\t\t\tif (list.template) {\r\n\t\t\t\t\titem[\"df\"] = list.template.render(item, ew.jsRenderHelpers);\r\n\t\t\t\t} else {\r\n\t\t\t\t\titem[\"df\"] = txt;\r\n\t\t\t\t}\r\n\t\t\t\titem[\"txt\"] = txt;\r\n\t\t\t\tdata.records[index] = item;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn data;\r\n\t}\r\n\r\n\t// Set AutoSuggest\r\n\tvar setAutoSuggest = function(value, text) {\r\n\t\tif (!isAutoSuggest($input))\r\n\t\t\treturn;\r\n\t\tvar o = getAutoSuggest($input[0]);\r\n\t\to._options.push({\"val\": value, \"lbl\": text});\r\n\t\to.input.value = text;\r\n\t}\r\n\r\n\t// Add option\r\n\tvar addOpt = function(ar) {\r\n\t\t// Check if selected records are in the current page\r\n\t\tvar vals = [], html = [], opts = [], txts = [], useText = !args.m && args.srch;\r\n\t\t$bd.ewjtable(\"selectedRows\").each(function() {\r\n\t\t\tvar record = $(this).data(\"record\");\r\n\t\t\tvals.push(record.lf);\r\n\t\t\thtml.push(record.df);\r\n\t\t\topts.push(record.df);\r\n\t\t\ttxts.push(record.txt); // Text for Auto-Suggest\r\n\t\t});\r\n\t\tif (ar.sort().join() === vals.sort().join()) { // All selected records are from the current page\r\n\t\t\t$lu.html(optionsHtml(opts, $input.data(\"maxcount\")));\r\n\t\t\tsetAutoSuggest(vals.join(), txts.join(\", \"));\r\n\t\t\t$input.val(useText ? html.join(\", \") : vals.join()).change();\r\n\t\t} else { // Get selected records from server\r\n\t\t\tvar data = Object.assign({ page: list.page, field: list.field, ajax: \"modal\", keys: ar }, getUserParams('#p_' + oid, f));\r\n\t\t\t$body.css(\"cursor\", \"wait\");\r\n\t\t\t$.ajax(getApiUrl(ew.API_LOOKUP_ACTION), {\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdataType: \"json\",\r\n\t\t\t\tdata: data\r\n\t\t\t}).done(_format).then(function(data) {\r\n\t\t\t\tif (data.result == \"OK\" && $.isArray(data.records)) {\r\n\t\t\t\t\tvar vals = [], html = [], opts = [], txts = [], results = data.records;\r\n\t\t\t\t\tfor (var i = 0, cnt = results.length; i < cnt; i++) {\r\n\t\t\t\t\t\tvar result = results[i];\r\n\t\t\t\t\t\tvals.push(result.lf);\r\n\t\t\t\t\t\thtml.push(result.df)\r\n\t\t\t\t\t\topts.push(result.df);\r\n\t\t\t\t\t\ttxts.push(result.txt); // Text for Auto-Suggest\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$lu.html(optionsHtml(opts, $input.data(\"maxcount\")));\r\n\t\t\t\t\tsetAutoSuggest(vals.join(), txts.join(\", \"));\r\n\t\t\t\t\t$input.val(useText ? html.join(\", \") : vals.join()).change();\r\n\t\t\t\t}\r\n\t\t\t}).always(function() {\r\n\t\t\t\t$body.css(\"cursor\", \"default\");\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t// Submit\r\n\tvar _submit = function() {\r\n\t\taddOpt(arLinkValue);\r\n\t\t$dlg.modal(\"hide\");\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Hide\r\n\t$dlg.modal(\"hide\");\r\n\t$dlg.data(\"args\", args);\r\n\tvar _timer, $search;\r\n\r\n\t// Success\r\n\tvar success = function(data) {\r\n\t\tif (data.result == \"OK\") {\r\n\t\t\t$dlg.find(\".modal-title\").html($lnk.attr(\"title\") || $lnk.data(\"original-title\"));\r\n\t\t\t$dlg.find(\".modal-footer\").html('<button type=\"button\" id=\"btn-select\" class=\"btn btn-primary ew-btn\">' + ew.language.phrase(\"SelectBtn\") + '</button>' +\r\n\t\t\t\t'<button type=\"button\" class=\"btn btn-default ew-btn\" data-dismiss=\"modal\">' + ew.language.phrase(\"CancelBtn\") + '</button>');\r\n\t\t\t$search = $('<input type=\"search\" name=\"sv\" class=\"form-control mb-2\" placeholder=\"' + ew.language.phrase(\"Search\") + '\">')\r\n\t\t\t\t.prependTo($bd).on(\"keyup\", function(e) {\r\n\t\t\t\t\tif (_timer)\r\n\t\t\t\t\t\t_timer.cancel();\r\n\t\t\t\t\t_timer = $.later(ew.LOOKUP_DELAY, null, function() {\r\n\t\t\t\t\t\t$bd.ewjtable(\"load\", { \"sv\": $search.val() });\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t$dlg.find(\".modal-footer #btn-select\").click(_submit); // Select\r\n\t\t\tew.modalLookupDialog = $dlg.modal(\"show\");\r\n\t\t\t$dlg.find(\"[name=sv]\").focus();\r\n\t\t} else {\r\n\t\t\t_alert(data.message);\r\n\t\t}\r\n\t};\r\n\r\n\tvar arp = [];\r\n\tvar linkValue = $input.val(); // Link values\r\n\tvar arLinkValue = (linkValue !== \"\") ? linkValue.split(ew.MULTIPLE_OPTION_SEPARATOR) : [];\r\n\tvar data = Object.assign({ page: list.page, field: list.field }, getUserParams('#p_' + oid, f));\r\n\r\n\t// Add parent field values\r\n\tvar parentId = list.parentFields.slice(); // Clone\r\n\tif (rowindex != \"\") {\r\n\t\tfor (var i = 0, len = parentId.length; i < len; i++) {\r\n\t\t\tvar ar = parentId[i].split(\" \");\r\n\t\t\tif (ar.length == 1) // Parent field in the same table, add row index\r\n\t\t\t\tparentId[i] = parentId[i].replace(/^x_/, \"x\" + rowindex + \"_\");\r\n\t\t}\r\n\t}\r\n\tif (parentId.length > 0) {\r\n\t\tfor (var i = 0, len = parentId.length; i < len; i++)\r\n\t\t\tarp.push(getOptionValues(parentId[i], f));\r\n\t}\r\n\tfor (var i = 0, cnt = arp.length; i < cnt; i++) // Filter by parent fields\r\n\t\tdata[\"v\" + (i + 1)] = arp[i].join(ew.MULTIPLE_OPTION_SEPARATOR);\r\n\r\n\t$body.css(\"cursor\", \"wait\");\r\n\t$bd.ewjtable({\r\n\t\tpaging: true,\r\n\t\tpageSize: args.n,\r\n\t\tpageSizes: [],\r\n\t\tpageSizeChangeArea: false,\r\n\t\tpageList: \"minimal\",\r\n\t\tselecting: true,\r\n\t\tselectingCheckboxes: true,\r\n\t\tmultiselect: !!args.m,\r\n\t\tactions: {\r\n\t\t\t\"listAction\": function(postData, jtParams) {\r\n\t\t\t\tvar _data = Object.assign({}, data, {\r\n\t\t\t\t\tajax: \"modal\",\r\n\t\t\t\t\tstart: jtParams.start,\r\n\t\t\t\t\trecperpage: jtParams.recperpage\r\n\t\t\t\t});\r\n\t\t\t\tif ($.isObject(postData)) // Search\r\n\t\t\t\t\tObject.assign(_data, postData);\r\n\t\t\t\treturn $.ajax(getApiUrl(ew.API_LOOKUP_ACTION), {\r\n\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\tdataType: \"json\",\r\n\t\t\t\t\t\tdata: _data\r\n\t\t\t\t\t}).done(_format).always(function() {\r\n\t\t\t\t\t\t$body.css(\"cursor\", \"default\");\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tmessages: {\r\n\t\t\tserverCommunicationError: ew.language.phrase(\"ServerCommunicationError\"),\r\n\t\t\tloadingMessage: '<div class=\"' + ew.spinnerClass + ' m-3 ew-loading\" role=\"status\"><span class=\"sr-only\">' + ew.language.phrase(\"Loading\") + '</span></div>',\r\n\t\t\tnoDataAvailable: ew.language.phrase(\"NoRecord\"),\r\n\t\t\tclose: ew.language.phrase(\"CloseBtn\"),\r\n\t\t\tpagingInfo: ew.language.phrase(\"Record\") + \" {0}-{1} \" + ew.language.phrase(\"Of\") + \" {2}\",\r\n\t\t\tpageSizeChangeLabel: ew.language.phrase(\"RecordsPerPage\"),\r\n\t\t\tgotoPageLabel: ew.language.phrase(\"Page\")\r\n\t\t},\r\n\t\tfields: {\r\n\t\t\t\"lf\": { key: true, list: false},\r\n\t\t\t\"df\": {}\r\n\t\t},\r\n\t\trecordsLoaded: function(e, data) {\r\n\t\t\tvar selectedRows = $(e.target).find(\".ewjtable-data-row\").filter(function() {\r\n\t\t\t\treturn arLinkValue.includes(String($(this).data(\"record-key\")));\r\n\t\t\t});\r\n\t\t\t$(e.target).ewjtable(\"selectRows\", selectedRows);\r\n\t\t},\r\n\t\tselectionChanged: function(e, data) {\r\n\t\t\tvar $rows = data.rows;\r\n\t\t\tif ($rows) {\r\n\t\t\t\tif (!args.m)\r\n\t\t\t\t\tarLinkValue = [];\r\n\t\t\t\t$rows.each(function() {\r\n\t\t\t\t\tvar $row = $(this);\r\n\t\t\t\t\tvar key = String($row.data(\"record-key\"));\r\n\t\t\t\t\tvar index = arLinkValue.indexOf(key);\r\n\t\t\t\t\tvar selected = $row.hasClass(\"ewjtable-row-selected\");\r\n\t\t\t\t\tif (selected && index == -1)\r\n\t\t\t\t\t\tarLinkValue.push(key);\r\n\t\t\t\t\telse if (!selected && index > -1)\r\n\t\t\t\t\t\tarLinkValue.splice(index, 1);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}).ewjtable(\"load\", null, success);\r\n}\r\n\r\n/**\r\n * Show dialog for import\r\n *\r\n * @param {Object} args - Arguments\r\n * @param {string} args.hdr - Dialog header\r\n * @param {HTMLElement} args.lnk - Anchor element\r\n * @returns\r\n */\r\nexport function importDialogShow(args) {\r\n\t$(args.lnk).tooltip(\"hide\");\r\n\tvar $dlg = ew.importDialog || $(\"#ew-import-dialog\");\r\n\tif (!$dlg[0]) {\r\n\t\t_alert(\"DIV #ew-import-dialog not found.\");\r\n\t\treturn false;\r\n\t}\r\n\r\n\tvar $input = $dlg.find(\"#importfiles\"),\r\n\t\t$bd = $dlg.find(\".modal-body\"),\r\n\t\t$data = $bd.find(\":input[id!=importfiles]\"),\r\n\t\t$message = $bd.find(\".message\"),\r\n\t\t$progress = $bd.find(\".progress\"),\r\n\t\ttimer;\r\n\r\n\t// Disable buttons\r\n\tvar disableButtons = function() {\r\n\t\t$dlg.find(\".modal-footer .btn\").prop(\"disabled\", true);\r\n\t}\r\n\r\n\t// Enable buttons\r\n\tvar enableButtons = function() {\r\n\t\t$dlg.find(\".modal-footer .btn\").prop(\"disabled\", false);\r\n\t}\r\n\r\n\t// Show message\r\n\tvar showMessage = function(msg, classname) {\r\n\t\t$msg = $(\"<div>\" + msg + \"</div>\");\r\n\t\tif (classname)\r\n\t\t\t$msg.addClass(classname);\r\n\t\t$message.removeClass(\"d-none\").html($msg);\r\n\t\tif (classname == \"text-danger\")\r\n\t\t\tenableButtons();\r\n\t}\r\n\r\n\t// Hide message\r\n\tvar hideMessage = function() {\r\n\t\t$message.addClass(\"d-none\").html(\"\");\r\n\t}\r\n\r\n\t// Show progress\r\n\tvar showProgress = function(pc, classname) {\r\n\t\t$progress.removeClass(\"d-none\").find(\".progress-bar\").removeClass(\"bg-success bg-info\").addClass(classname || \"bg-success\")\r\n\t\t\t.attr(\"aria-valuenow\", pc).css(\"width\", pc + \"%\").html(pc + \"%\");\r\n\t}\r\n\r\n\t// Hide progress\r\n\tvar hideProgress = function() {\r\n\t\t$progress.addClass(\"d-none\").find(\".progress-bar\").attr(\"aria-valuenow\", 0).css(\"width\", \"0%\").html(\"0%\");\r\n\t}\r\n\r\n\t// Upload progress\r\n\tvar uploadProgress = function(data) {\r\n\t\tvar pc = parseInt(100 * data.loaded / data.total);\r\n\t\tshowProgress(pc, \"bg-info\");\r\n\t\tif (pc === 100) {\r\n\t\t\tshowMessage(ew.language.phrase(\"ImportMessageUploadComplete\"), \"text-info\");\r\n\t\t} else {\r\n\t\t\tshowMessage(ew.language.phrase(\"ImportMessageUploadProgress\").replace(\"%p\", pc), \"text-info\");\r\n\t\t}\r\n\t}\r\n\r\n\t// Update progress (import)\r\n\tvar updateProgress = function(result) {\r\n\t\ttry {\r\n\t\t\tvar cnt = parseInt(result.count), tcnt = parseInt(result.totalCount), filename = result.file;\r\n\t\t\tif (tcnt > 0 && $dlg.find(\".modal-footer .ew-close-btn\").data(\"import-progress\")) { // Show progress\r\n\t\t\t\tvar pc = parseInt(100 * cnt / tcnt);\r\n\t\t\t\tshowProgress(pc);\r\n\t\t\t\tshowMessage(ew.language.phrase(\"ImportMessageProgress\").replace(\"%t\", tcnt).replace(\"%c\", cnt).replace(\"%f\", filename), \"text-info\");\r\n\t\t\t}\r\n\t\t} catch(e) {}\r\n\t}\r\n\r\n\t// Import progress\r\n\tvar importProgress = function() {\r\n\t\tvar url = getApiUrl(ew.API_PROGRESS_ACTION), data = { \"rnd\": random() };\r\n\t\tdata[ew.API_FILE_TOKEN_NAME] = $input.data(ew.API_FILE_TOKEN_NAME);\r\n\t\t$.get(url, data, updateProgress, \"json\");\r\n\t}\r\n\r\n\t// Import complete\r\n\tvar importComplete = function(result) {\r\n\t\tvar maxErrorCount = 5;\r\n\t\tvar msg = \"\";\r\n\t\tshowProgress(100);\r\n\t\tvar fileResults = result.files;\r\n\t\t$dlg.find(\".modal-footer .ew-close-btn\").data(\"import-progress\", false); // Stop import progress\r\n\t\tif ($.isArray(fileResults)) {\r\n\t\t\tfor (var i = 0, len = fileResults.length; i < len; i++) {\r\n\t\t\t\tvar fileResult = fileResults[i],\r\n\t\t\t\t\ttcnt = fileResult.totalCount || 0,\r\n\t\t\t\t\tcnt = fileResult.count || 0,\r\n\t\t\t\t\tscnt = fileResult.successCount || 0,\r\n\t\t\t\t\tfcnt = fileResult.failCount || 0;\r\n\t\t\t\tif (msg != \"\")\r\n\t\t\t\t\tmsg += \"<br>\";\r\n\t\t\t\tif (fileResult.success) {\r\n\t\t\t\t\tmsg += ew.language.phrase(\"ImportMessageSuccess\").replace(\"%t\", tcnt).replace(\"%c\", cnt).replace(\"%f\", fileResult.file);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmsg += ew.language.phrase(\"ImportMessageError1\").replace(\"%t\", tcnt).replace(\"%c\", cnt).replace(\"%f\", fileResult.file).replace(\"%s\", scnt).replace(\"%e\", fcnt);\r\n\t\t\t\t\tif (fileResult.error)\r\n\t\t\t\t\t\tmsg += ew.language.phrase(\"ImportMessageError2\").replace(\"%e\", fileResult.error);\r\n\t\t\t\t\tvar showLog = true;\r\n\t\t\t\t\tif (fileResult.failList) {\r\n\t\t\t\t\t\tvar ecnt = 0;\r\n\t\t\t\t\t\tfor (var i = 1; i <= cnt; i++) {\r\n\t\t\t\t\t\t\tif (fileResult.failList[\"row\" + i]) {\r\n\t\t\t\t\t\t\t\tecnt += 1;\r\n\t\t\t\t\t\t\t\tmsg += \"<br>\" + ew.language.phrase(\"ImportMessageError3\").replace(\"%i\", i).replace(\"%d\", fileResult.failList[\"row\" + i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (ecnt >= maxErrorCount)\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (fcnt > maxErrorCount)\r\n\t\t\t\t\t\t\tmsg += \"<br>\" + ew.language.phrase(\"ImportMessageMore\").replace(\"%s\", fcnt - maxErrorCount);\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tshowLog = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (fileResult.log && showLog)\r\n\t\t\t\t\t\tmsg += \"<br>\" + ew.language.phrase(\"ImportMessageError4\").replace(\"%l\", fileResult.log);\r\n\t\t\t\t\tshowMessage(msg, \"text-danger\"); // Show error message\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (result.success) {\r\n\t\t\tshowMessage(msg, \"text-success\");\r\n\t\t\t$dlg.find(\".modal-footer .ew-close-btn\").data(\"imported\", true);\r\n\t\t} else {\r\n\t\t\tif (result.error)\r\n\t\t\t\tmsg = result.error;\r\n\t\t\tshowMessage(msg, \"text-danger\"); // Show error message\r\n\t\t}\r\n\t\thideProgress();\r\n\t}\r\n\r\n\t// Import fail\r\n\tvar importFail = function(o) {\r\n\t\t$dlg.find(\".modal-footer .ew-close-btn\").data(\"import-progress\", false); // Stop import progress\r\n\t\tshowMessage(ew.language.phrase(\"ImportMessageServerError\").replace(\"%s\", o.status).replace(\"%t\", o.statusText), \"text-danger\");\r\n\t}\r\n\r\n\t// Import file\r\n\tvar importFiles = function(filetoken) {\r\n\t\t$body.css(\"cursor\", \"wait\");\r\n\t\t$input.data(ew.API_FILE_TOKEN_NAME, filetoken);\r\n\t\t$dlg.find(\".modal-footer .ew-close-btn\").data(\"import-progress\", true); // Show import progress\r\n\t\tvar data = ew.API_ACTION_NAME + \"=import&\" + ew.API_FILE_TOKEN_NAME + \"=\" + encodeURIComponent(filetoken);\r\n\t\tif ($data.length)\r\n\t\t\tdata += \"&\" + $data.serialize();\r\n\t\t$.ajax(currentPage(), {\r\n\t\t\t\"data\": data,\r\n\t\t\t\"method\": \"POST\",\r\n\t\t\t\"dataType\": \"json\",\r\n\t\t\t\"beforeSend\": function(xhr, settings) {\r\n\t\t\t\ttimer = $.later(100, null, importProgress, null, true); // Use time to show progress periodically\r\n\t\t\t}\r\n\t\t}).done(importComplete).fail(importFail).always(function() {\r\n\t\t\t$body.css(\"cursor\", \"default\");\r\n\t\t\tif (timer)\r\n\t\t\t\ttimer.cancel(); // Clear timer\r\n\t\t});\r\n\t}\r\n\r\n\tvar formData = { session: ew.SESSION_ID };\r\n\t//***formData[ew.TOKEN_NAME] = ew.ANTIFORGERY_TOKEN; // Add token for $.ajax() sent by jQuery File Upload (not by ajaxSend)\r\n\tformData[ew.TOKEN_NAME_KEY] = ew.TOKEN_NAME; // Add token name for $.ajax() sent by jQuery File Upload (not by ajaxSend) //*** PHP\r\n\tformData[ew.ANTIFORGERY_TOKEN_KEY] = ew.ANTIFORGERY_TOKEN; // Add antiforgery token for $.ajax() sent by jQuery File Upload (not by ajaxSend) //*** PHP\r\n\tvar options = ew.importUploadOptions;\r\n\tif (!options.acceptFileTypes)\r\n\t\toptions.acceptFileTypes = new RegExp('\\\\.(' + ew.IMPORT_FILE_ALLOWED_EXT.replace(/,/g, '|') + ')$', 'i');\r\n\r\n\tif (!$input.data(\"blueimpFileupload\")) {\r\n\t\t$input.fileupload(Object.assign({\r\n\t\t\t\turl: getApiUrl(ew.API_UPLOAD_ACTION),\r\n\t\t\t\tdataType: \"json\",\r\n\t\t\t\tautoUpload: true,\r\n\t\t\t\tformData: formData,\r\n\t\t\t\tsingleFileUploads: false,\r\n\t\t\t\tmessages: {\r\n\t\t\t\t\tacceptFileTypes: ew.language.phrase(\"UploadErrMsgAcceptFileTypes\"),\r\n\t\t\t\t\tmaxFileSize: ew.language.phrase(\"UploadErrMsgMaxFileSize\"),\r\n\t\t\t\t\tmaxNumberOfFiles: ew.language.phrase(\"UploadErrMsgMaxNumberOfFiles\"),\r\n\t\t\t\t\tminFileSize: ew.language.phrase(\"UploadErrMsgMinFileSize\")\r\n\t\t\t\t},\r\n\t\t\t\tdone: function(e, data) {\r\n\t\t\t\t\tif (data.result && data.result.files && $.isArray(data.result.files.importfiles)) {\r\n\t\t\t\t\t\tvar ok = true;\r\n\t\t\t\t\t\tdata.result.files.importfiles.forEach(function(file, index) {\r\n\t\t\t\t\t\t\tif (file.error) {\r\n\t\t\t\t\t\t\t\tshowMessage(ew.language.phrase(\"ImportMessageUploadError\").replace(\"%f\", file.name).replace(\"%s\", file.error), \"text-danger\");\r\n\t\t\t\t\t\t\t\tok = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}); // Show upload errors for each file\r\n\t\t\t\t\t\tif (ok)\r\n\t\t\t\t\t\t\timportFiles(data.result[ew.API_FILE_TOKEN_NAME]); // Import uploaded files\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tchange: function(e, data) {\r\n\t\t\t\t\thideMessage();\r\n\t\t\t\t},\r\n\t\t\t\tprocessfail: function(e, data) {\r\n\t\t\t\t\tdata.files.forEach(function(file, index) {\r\n\t\t\t\t\t\tif (file.error)\r\n\t\t\t\t\t\t\tshowMessage(ew.language.phrase(\"ImportMessageUploadError\").replace(\"%f\", file.name).replace(\"%s\", file.error), \"text-danger\");\r\n\t\t\t\t\t}); // Show process errors for each file\r\n\t\t\t\t},\r\n\t\t\t\tfail: function(e, data) {\r\n\t\t\t\t\tshowMessage(ew.language.phrase(\"ImportMessageServerError\").replace(\"%s\", data.textStatus).replace(\"%t\", data.errorThrown), \"text-danger\");\r\n\t\t\t\t},\r\n\t\t\t\tprogressall: function(e, data) {\r\n\t\t\t\t\tuploadProgress(data);\r\n\t\t\t\t}\r\n\t\t}, options));\r\n\t}\r\n\r\n\t$dlg.modal(\"hide\").find(\".modal-title\").html(args.hdr);\r\n\t$dlg.find(\".modal-footer .ew-close-btn\").off(\"click.ew\").on(\"click.ew\", function() {\r\n\t\tvar $this = $(this);\r\n\t\tif ($this.data(\"imported\")) {\r\n\t\t\t$this.data(\"imported\", false);\r\n\t\t\twindow.location.reload(true);\r\n\t\t}\r\n\t});\r\n\thideMessage();\r\n\tew.importDialog = $dlg.modal(\"show\");\r\n\treturn false;\r\n}\r\n\r\n// Auto-fill\r\nexport function autoFill(el) {\r\n\tvar f = forms(el).$element[0];\r\n\tif (!f)\r\n\t\treturn;\r\n\tvar ar = getOptionValues(el),\r\n\t\tid = getId(el),\r\n\t\tm = id.match(/^([xy])(\\d*)_/),\r\n\t\tprefix = (m) ? m[1] : \"\",\r\n\t\trowindex = (m) ? m[2] : \"\",\r\n\t\tnid = id.replace(/^([xy])(\\d*)_/, \"x_\"),\r\n\t\tlist = forms(el).lists[nid],\r\n\t\tdest_array = list.autoFillTargetFields;\r\n\tvar success = function(data) {\r\n\t\tvar results = data && data.records || \"\";\r\n\t\tvar result = (results) ? results[0] : [];\r\n\t\tfor (var j = 0; j < dest_array.length; j++) {\r\n\t\t\tvar destEl = getElements(dest_array[j].replace(/^x_/, \"x\" + rowindex + \"_\"), f);\r\n\t\t\tif (destEl) {\r\n\t\t\t\tvar val = ($.isValue(result[\"af\" + j])) ? result[\"af\" + j] : \"\";\r\n\t\t\t\tvar args = {results: results, result: result, data: val, form: f, name: id, target: dest_array[j], cancel: false, trigger: true};\r\n\t\t\t\t$(el).trigger(\"autofill\", [args]); // Fire event\r\n\t\t\t\tif (args.cancel)\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tval = args.data; // Process the value\r\n\t\t\t\tif (destEl.options || destEl.length && destEl[0].type == \"radio\") { // Selection/Radio list\r\n\t\t\t\t\tselectOption(destEl, val.split(\",\"));\r\n\t\t\t\t} else if (destEl.length && destEl[0].type == \"checkbox\") { // Checkbox list\r\n\t\t\t\t\tselectOption(destEl, val.split(\",\"));\r\n\t\t\t\t} else if (isAutoSuggest(destEl)) { // Auto-Suggest\r\n\t\t\t\t\tdestEl.value = val;\r\n\t\t\t\t\tgetAutoSuggest(destEl).input.value = val;\r\n\t\t\t\t\tupdateOptions.call(_forms[f.id], destEl);\r\n\t\t\t\t} else if (isModalLookup(destEl)) { // Modal-Lookup\r\n\t\t\t\t\tdestEl.value = val;\r\n\t\t\t\t\t//$(destEl).parent().find(\".ew-lookup-text\").html(val);\r\n\t\t\t\t\tupdateOptions.call(_forms[f.id], destEl);\r\n\t\t\t\t} else if (isHiddenTextArea(destEl)) { // HTML editor\r\n\t\t\t\t\tdestEl.value = val;\r\n\t\t\t\t\t$(destEl).data(\"editor\").set();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdestEl.value = val;\r\n\t\t\t\t}\r\n\t\t\t\tif (args.trigger)\r\n\t\t\t\t\t$(destEl).change();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t};\r\n\tif (ar.length > 0 && ar[0] != \"\") {\r\n\t\tvar data = Object.assign({\r\n\t\t\tpage: list.page,\r\n\t\t\tfield: list.field,\r\n\t\t\tajax: \"autofill\",\r\n\t\t\tv0: ar[0],\r\n\t\t\tlanguage: ew.LANGUAGE_ID\r\n\t\t}, getUserParams('#p_' + id, f));\r\n\t\t// Add parent field values\r\n\t\tvar parentId = list.parentFields.slice(); // Clone\r\n\t\tif (rowindex != \"\") {\r\n\t\t\tfor (var i = 0, len = parentId.length; i < len; i++) {\r\n\t\t\t\tvar ar = parentId[i].split(\" \");\r\n\t\t\t\tif (ar.length == 1) // Parent field in the same table, add row index\r\n\t\t\t\t\tparentId[i] = parentId[i].replace(/^x_/, \"x\" + rowindex + \"_\");\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar arp = parentId.map(function(pid) {\r\n\t\t\treturn getOptionValues(pid, f);\r\n\t\t});\r\n\t\tfor (var i = 0, cnt = arp.length; i < cnt; i++) // Filter by parent fields\r\n\t\t\tdata[\"v\" + (i + 1)] = arp[i].join(ew.MULTIPLE_OPTION_SEPARATOR);\r\n\t\treturn $.post(getApiUrl(ew.API_LOOKUP_ACTION), data, success, \"json\");\r\n\t}\r\n\treturn success();\r\n}\r\n\r\n// Setup tooltip links\r\nexport function tooltip(i, el) {\r\n\tvar $this = $(el), $tt = $(\"#\" + $this.data(\"tooltip-id\")),\r\n\t\ttrig = $this.data(\"trigger\") || \"hover\", dir = $this.data(\"placement\") || (ew.CSS_FLIP ? \"left\" : \"right\"); // dir = \"left|right\"\r\n\tif (!$tt[0] || $tt.text().trim() == \"\" && !$tt.find(\"img[src!='']\")[0])\r\n\t\treturn;\r\n\tif (!$this.data(\"bs.popover\")) {\r\n\t\t$this.popover({\r\n\t\t\thtml: true,\r\n\t\t\tplacement: dir,\r\n\t\t\ttrigger: trig,\r\n\t\t\tdelay: 100,\r\n\t\t\tcontainer: $(\"#ew-tooltip\")[0],\r\n\t\t\tcontent: $tt.html(),\r\n\t\t\tsanitizeFn: ew.sanitizeFn\r\n\t\t}).on(\"show.bs.popover\", function(e) {\r\n\t\t\tvar wd, $tip = $($this.data(\"bs.popover\").getTipElement()).css(\"z-index\", 9999); // Make z-index higher than modal dialog\r\n\t\t\tif (wd = $this.data(\"tooltip-width\")) // Set width before show\r\n\t\t\t\t$tip.css(\"max-width\", parseInt(wd, 10) + \"px\");\r\n\t\t});\r\n\t}\r\n}\r\n\r\n/**\r\n * Show dialog for email sending\r\n *\r\n * @param {Object} args - Arguments\r\n * @param {string} args.lnk - Email link ID\r\n * @param {string} args.hdr - Dialog header\r\n * @param {string} args.url - URL of the email content\r\n * @param {HTMLElement} args.f - Form\r\n * @param {Object} args.key - Key as object\r\n * @param {boolean} args.sel - Exported selected\r\n * @returns false\r\n */\r\nexport function emailDialogShow(args) {\r\n\tvar $dlg = ew.emailDialog || $(\"#ew-email-dialog\");\r\n\tif (!$dlg[0]) {\r\n\t\t_alert(\"DIV #ew-email-dialog not found.\");\r\n\t\treturn false;\r\n\t}\r\n\tif (args.sel && !keySelected(args.f)) {\r\n\t\t_alert(ew.language.phrase(\"NoRecordSelected\"));\r\n\t\treturn false;\r\n\t}\r\n\tvar $f = $dlg.find(\".modal-body form\"),\r\n\t\tfrm = $f.data(\"form\");\r\n\tif (!frm) {\r\n\t\tfrm = new Form($f.attr(\"id\"));\r\n\t\tfrm.validate = function() {\r\n\t\t\tvar elm, fobj = this.getForm();\r\n\t\t\telm = fobj.elements[\"sender\"];\r\n\t\t\tif (elm && !hasValue(elm))\r\n\t\t\t\treturn this.onError(elm, ew.language.phrase(\"EnterSenderEmail\"));\r\n\t\t\tif (elm && !checkEmails(elm.value, 1))\r\n\t\t\t\treturn this.onError(elm, ew.language.phrase(\"EnterProperSenderEmail\"));\r\n\t\t\telm = fobj.elements[\"recipient\"];\r\n\t\t\tif (elm && !hasValue(elm))\r\n\t\t\t\treturn this.onError(elm, ew.language.phrase(\"EnterRecipientEmail\"));\r\n\t\t\tif (elm && !checkEmails(elm.value, ew.MAX_EMAIL_RECIPIENT))\r\n\t\t\t\treturn this.onError(elm, ew.language.phrase(\"EnterProperRecipientEmail\"));\r\n\t\t\telm = fobj.elements[\"cc\"];\r\n\t\t\tif (elm && !checkEmails(elm.value, ew.MAX_EMAIL_RECIPIENT))\r\n\t\t\t\treturn this.onError(elm, ew.language.phrase(\"EnterProperCcEmail\"));\r\n\t\t\telm = fobj.elements[\"bcc\"];\r\n\t\t\tif (elm && !checkEmails(elm.value, ew.MAX_EMAIL_RECIPIENT))\r\n\t\t\t\treturn this.onError(elm, ew.language.phrase(\"EnterProperBccEmail\"));\r\n\t\t\telm = fobj.elements[\"subject\"];\r\n\t\t\tif (elm && !hasValue(elm))\r\n\t\t\t\treturn this.onError(elm, ew.language.phrase(\"EnterSubject\"));\r\n\t\t\treturn true;\r\n\t\t};\r\n\t\tfrm.submit = function() {\r\n\t\t\tif (!this.validate())\r\n\t\t\t\treturn false;\r\n\t\t\tvar qs = $f.serialize(), data = \"\";\r\n\t\t\tif (args.f && args.sel) // Export selected\r\n\t\t\t\tdata = $(args.f).find(\"input[type=checkbox][name='key_m[]']:checked\").serialize();\r\n\t\t\tif (args.key)\r\n\t\t\t\tqs += \"&\" + $.param(args.key);\r\n\t\t\tvar fobj = this.getForm();\r\n\t\t\tif (args.url) { // Custom Template\r\n\t\t\t\t$dlg.modal(\"hide\");\r\n\t\t\t\tif (args.exportid)\r\n\t\t\t\t\tew.exportWithCharts(args.el, args.url, args.exportid, fobj);\r\n\t\t\t\telse\r\n\t\t\t\t\t_export(args.f, args.url, \"email\", true, args.sel, fobj);\r\n\t\t\t} else {\r\n\t\t\t\t$.post($(args.f).attr(\"action\"), qs + \"&\" + data, function(result) {\r\n\t\t\t\t\tshowMessage(result);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t};\r\n\t\t$f.data(\"form\", frm);\r\n\t}\r\n\t$dlg.modal(\"hide\").find(\".modal-title\").html(args.hdr);\r\n\t$dlg.find(\".modal-footer .btn-primary\").unbind().click(function(e) {\r\n\t\te.preventDefault();\r\n\t\tif (frm.submit())\r\n\t\t\t$dlg.modal(\"hide\");\r\n\t});\r\n\tew.emailDialog = $dlg.modal(\"show\");\r\n\treturn false;\r\n}\r\n\r\n// Show drill down\r\nexport function showDrillDown(e, obj, url, id, hdr) {\r\n\tif (e && e.ctrlKey) {\r\n\t\tvar arUrl = url.split(\"?\"), params = new URLSearchParams(arUrl[1]);\r\n\t\tparams.set(\"d\", \"2\");  // Change d parameter to 2\r\n\t\tew.redirect(arUrl[0] + \"?\" + params.toString());\r\n\t\treturn false;\r\n\t}\r\n\tvar $obj = ($.isString(obj)) ? $(\"#\" + obj) : $(obj);\r\n\tvar pos = $obj.data(\"drilldown-placement\") || ($obj.hasClass(\"ew-chart-canvas\") ? (ew.CSS_FLIP ? \"left\" : \"right\") : \"bottom\");\r\n\t$obj.tooltip(\"hide\");\r\n\tvar args = {\"obj\": $obj[0], \"id\": id, \"url\": url, \"hdr\": hdr, \"placement\": pos};\r\n\t$document.trigger(\"drilldown\", [args]);\r\n\tvar ar = args.url.split(\"?\");\r\n\targs.file = ar[0] || \"\";\r\n\targs.data = ar[1] || \"\";\r\n\tif (!$obj.data(\"bs.popover\")) {\r\n\t\t$obj.popover({\r\n\t\t\thtml: true,\r\n\t\t\tplacement: args.placement,\r\n\t\t\ttrigger: \"manual\",\r\n\t\t\ttemplate: '<div class=\"popover\"><h3 class=\"popover-header d-none\" style=\"cursor: move;\"></h3><div class=\"popover-body\"></div></div>',\r\n\t\t\tcontent: '<div class=\"' + ew.spinnerClass + ' m-3 ew-loading\" role=\"status\"><span class=\"sr-only\">' + ew.language.phrase(\"Loading\") + '</span></div>',\r\n\t\t\tcontainer: $(\"#ew-drilldown-panel\"),\r\n\t\t\tsanitizeFn: ew.sanitizeFn,\r\n\t\t\tboundary: \"viewport\"\r\n\t\t}).on(\"show.bs.popover\", function(e) {\r\n\t\t\t$obj.attr(\"data-original-title\", \"\");\r\n\t\t}).on(\"shown.bs.popover\", function(e) {\r\n\t\t\tif (!$obj.data(\"args\"))\r\n\t\t\t\treturn;\r\n\t\t\tvar data = $obj.data(\"args\").data;\r\n\t\t\t//***data += (data ? \"&\" : \"\") + ew.TOKEN_NAME + \"=\" + ew.ANTIFORGERY_TOKEN; // Add token\r\n\t\t\tdata += (data ? \"&\" : \"\") + ew.TOKEN_NAME_KEY + \"=\" + ew.TOKEN_NAME; // Add token name //*** PHP\r\n\t\t\tdata += (data ? \"&\" : \"\") + ew.ANTIFORGERY_TOKEN_KEY + \"=\" + ew.ANTIFORGERY_TOKEN; // Add antiforgery token //*** PHP\r\n\t\t\t$.ajax({\r\n\t\t\t\tcache: false,\r\n\t\t\t\tdataType: \"html\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdata: data,\r\n\t\t\t\turl: $obj.data(\"args\").file,\r\n\t\t\t\tsuccess: function(data) {\r\n\t\t\t\t\tvar $tip = $($obj.data(\"bs.popover\").getTipElement()).on(\"mousedown\", function(e) {\r\n\t\t\t\t\t\tvar $this = $(this).addClass(\"drag\"),\r\n\t\t\t\t\t\t\theight = $this.outerHeight(),\r\n\t\t\t\t\t\t\twidth = $this.outerWidth(),\r\n\t\t\t\t\t\t\typos = $this.offset().top + height - e.pageY,\r\n\t\t\t\t\t\t\txpos = $this.offset().left + width - e.pageX;\r\n\t\t\t\t\t\t$body.on(\"mousemove\", function(e) {\r\n\t\t\t\t\t\t\tvar top = e.pageY + ypos - height,\r\n\t\t\t\t\t\t\t\tleft = e.pageX + xpos - width;\r\n\t\t\t\t\t\t\tif ($this.hasClass(\"drag\"))\r\n\t\t\t\t\t\t\t\t$this.offset({top: top, left: left});\r\n\t\t\t\t\t\t}).on(\"mouseup\", function(e){\r\n\t\t\t\t\t\t\t$this.removeClass(\"drag\");\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (args.hdr)\r\n\t\t\t\t\t\t$tip.find(\".popover-header\").empty().removeClass(\"d-none\")\r\n\t\t\t\t\t\t\t.append('<button type=\"button\" class=\"close\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>' + args.hdr)\r\n\t\t\t\t\t\t\t.find(\".close\").click(function() {\r\n\t\t\t\t\t\t\t\t$obj.popover(\"hide\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\tvar m = data.match(/<body[^>]*>([\\s\\S]*?)<\\/body\\s*>/i); // Use HTML in document body only\r\n\t\t\t\t\tdata = m ? m[0] : data;\r\n\t\t\t\t\tvar html = ew.stripScript(data);\r\n\t\t\t\t\t$tip.find(\".popover-body\").html($(\"<div></div>\").html(html).find(\"#ew-report\")) // Insert the container table only\r\n\t\t\t\t\t\t.find(\".ew-table\").each(ew.setupTable);\r\n\t\t\t\t\tew.executeScript(data, id);\r\n\t\t\t\t\t$obj.popover(\"update\");\r\n\t\t\t\t},\r\n\t\t\t\terror: function(o) {\r\n\t\t\t\t\tif (o.responseText) {\r\n\t\t\t\t\t\tvar $tip = $($el.data(\"bs.popover\").getTipElement());\r\n\t\t\t\t\t\t$tip.find(\".popover-body\").empty().append('<p class=\"text-danger\">' + o.responseText + '</p>');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}).on(\"hidden.bs.popover\", function(e) {\r\n\t\t\t$.each(ew.drillDownCharts, function(key, cht) { // Dispose charts\r\n\t\t\t\tcht.dispose();\r\n\t\t\t});\r\n\t\t\tew.drillDownCharts = {};\r\n\t\t\tew.removeScript(id);\r\n\t\t});\r\n\t}\r\n\t$obj.data(\"args\", args).popover(\"show\");\r\n}\r\n\r\n/**\r\n * Ajax query\r\n * @param {Object} data - object to passed to API\r\n * @param {callback} callback - Callback function for async request (see http://api.jquery.com/jQuery.post/), empty for sync request\r\n * @returns {string|string[]}\r\n */\r\nexport function ajax(data, callback) {\r\n\tif (!$.isObject(data))\r\n\t\treturn undefined;\r\n\tvar action = data.action;\r\n\tif (!action)\r\n\t\treturn undefined;\r\n\tdelete data.action;\r\n\tvar obj = Object.assign({}, data);\r\n\tvar _convert = function(response) {\r\n\t\tif ($.isObject(response) && response.result == \"OK\") {\r\n\t\t\tvar results = response.records;\r\n\t\t\tif ($.isArray(results) && results.length == 1) { // Single row\r\n\t\t\t\tresults = results[0];\r\n\t\t\t\tif ($.isArray(results) && results.length == 1) // Single column\r\n\t\t\t\t\treturn results[0]; // Return a value\r\n\t\t\t\telse\r\n\t\t\t\t\treturn results; // Return a row\r\n\t\t\t}\r\n\t\t\treturn results;\r\n\t\t}\r\n\t\treturn response;\r\n\t};\r\n\tvar url = getApiUrl(action); // URL\r\n\tobj.type = obj.type || \"POST\";\r\n\tif ($.isFunction(callback)) { // Async\r\n\t\tobj.url = url;\r\n\t\tobj.dataType = \"json\";\r\n\t\tobj.success = function(response) {\r\n\t\t\tcallback(_convert(response));\r\n\t\t};\r\n\t\t$.ajax(obj);\r\n\t} else { // Sync\r\n\t\tvar type = obj.type;\r\n\t\tdelete obj.type;\r\n\t\tvar response = $.ajax({ url: url, async: false, type: type, data: obj }).responseText;\r\n\t\tresponse = parseJson(response);\r\n\t\treturn _convert(response);\r\n\t}\r\n}\r\n\r\n// Get URL of current page\r\nexport function currentPage() {\r\n\treturn location.href.split(\"#\")[0].split(\"?\")[0];\r\n}\r\n\r\n// Toggle search operator\r\nexport function toggleSearchOperator(id, value) {\r\n\tvar el = this.form.elements[id];\r\n\tif (!el)\r\n\t\treturn;\r\n\tel.value = (el.value != value) ? value : \"=\";\r\n}\r\n\r\n// Validators\r\n// Check US Date format (mm/dd/yyyy)\r\nexport function checkUSDate(object_value) {\r\n\treturn checkDateEx(object_value, \"us\", ew.DATE_SEPARATOR);\r\n}\r\n\r\n// Check US Date format (mm/dd/yy)\r\nexport function checkShortUSDate(object_value) {\r\n\treturn checkDateEx(object_value, \"usshort\", ew.DATE_SEPARATOR);\r\n}\r\n\r\n// Check Date format (yyyy/mm/dd)\r\nexport function checkDate(object_value) {\r\n\treturn checkDateEx(object_value, \"std\", ew.DATE_SEPARATOR);\r\n}\r\n\r\n// Check Date format (yy/mm/dd)\r\nexport function checkShortDate(object_value) {\r\n\treturn checkDateEx(object_value, \"stdshort\", ew.DATE_SEPARATOR);\r\n}\r\n\r\n// Check Euro Date format (dd/mm/yyyy)\r\nexport function checkEuroDate(object_value) {\r\n\treturn checkDateEx(object_value, \"euro\", ew.DATE_SEPARATOR);\r\n}\r\n\r\n// Check Euro Date format (dd/mm/yy)\r\nexport function checkShortEuroDate(object_value) {\r\n\treturn checkDateEx(object_value, \"euroshort\", ew.DATE_SEPARATOR);\r\n}\r\n\r\n// Check default date format\r\nexport function checkDateDef(object_value) {\r\n\tif (ew.DATE_FORMAT.match(/^yyyy/))\r\n\t\treturn checkDate(object_value);\r\n\telse if (ew.DATE_FORMAT.match(/^yy/))\r\n\t\treturn checkShortDate(object_value);\r\n\telse if (ew.DATE_FORMAT.match(/^m/) && ew.DATE_FORMAT.match(/yyyy$/))\r\n\t\treturn checkUSDate(object_value);\r\n\telse if (ew.DATE_FORMAT.match(/^m/) && ew.DATE_FORMAT.match(/yy$/))\r\n\t\treturn checkShortUSDate(object_value);\r\n\telse if (ew.DATE_FORMAT.match(/^d/) && ew.DATE_FORMAT.match(/yyyy$/))\r\n\t\treturn checkEuroDate(object_value);\r\n\telse if (ew.DATE_FORMAT.match(/^d/) && ew.DATE_FORMAT.match(/yy$/))\r\n\t\treturn checkShortEuroDate(object_value);\r\n\treturn false;\r\n}\r\n\r\n// Check date format\r\n// format: std/stdshort/us/usshort/euro/euroshort\r\nexport function checkDateEx(value, format, sep) {\r\n\tif (!value || value.length == \"\")\r\n\t\treturn true;\r\n\tvalue = value.replace(/ +/g, \" \").trim();\r\n\tvar arDT = value.split(\" \");\r\n\tif (arDT.length > 0) {\r\n\t\tvar re, ar, sYear, sMonth, sDay;\r\n\t\tre = /^(\\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\\d|[3][0|1])$/;\r\n\t\tif (ar = re.exec(arDT[0])) {\r\n\t\t\tsYear = ar[1];\r\n\t\t\tsMonth = ar[2];\r\n\t\t\tsDay = ar[3];\r\n\t\t} else {\r\n\t\t\tvar wrksep = escapeRegExChars(sep);\r\n\t\t\tswitch (format) {\r\n\t\t\t\tcase \"std\":\r\n\t\t\t\t\tre = new RegExp(\"^(\\\\d{4})\" + wrksep + \"([0]?[1-9]|[1][0-2])\" + wrksep + \"([0]?[1-9]|[1|2]\\\\d|[3][0|1])$\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"stdshort\":\r\n\t\t\t\t\tre = new RegExp(\"^(\\\\d{2})\" + wrksep + \"([0]?[1-9]|[1][0-2])\" + wrksep + \"([0]?[1-9]|[1|2]\\\\d|[3][0|1])$\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"us\":\r\n\t\t\t\t\tre = new RegExp(\"^([0]?[1-9]|[1][0-2])\" + wrksep + \"([0]?[1-9]|[1|2]\\\\d|[3][0|1])\" + wrksep + \"(\\\\d{4})$\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"usshort\":\r\n\t\t\t\t\tre = new RegExp(\"^([0]?[1-9]|[1][0-2])\" + wrksep + \"([0]?[1-9]|[1|2]\\\\d|[3][0|1])\" + wrksep + \"(\\\\d{2})$\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"euro\":\r\n\t\t\t\t\tre = new RegExp(\"^([0]?[1-9]|[1|2]\\\\d|[3][0|1])\" + wrksep + \"([0]?[1-9]|[1][0-2])\" + wrksep + \"(\\\\d{4})$\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"euroshort\":\r\n\t\t\t\t\tre = new RegExp(\"^([0]?[1-9]|[1|2]\\\\d|[3][0|1])\" + wrksep + \"([0]?[1-9]|[1][0-2])\" + wrksep + \"(\\\\d{2})$\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (!re.test(arDT[0]))\r\n\t\t\t\treturn false;\r\n\t\t\tvar arD = arDT[0].split(sep);\r\n\t\t\tswitch (format) {\r\n\t\t\t\tcase \"std\":\r\n\t\t\t\tcase \"stdshort\":\r\n\t\t\t\t\tsYear = unformatYear(arD[0]);\r\n\t\t\t\t\tsMonth = arD[1];\r\n\t\t\t\t\tsDay = arD[2];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"us\":\r\n\t\t\t\tcase \"usshort\":\r\n\t\t\t\t\tsYear = unformatYear(arD[2]);\r\n\t\t\t\t\tsMonth = arD[0];\r\n\t\t\t\t\tsDay = arD[1];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"euro\":\r\n\t\t\t\tcase \"euroshort\":\r\n\t\t\t\t\tsYear = unformatYear(arD[2]);\r\n\t\t\t\t\tsMonth = arD[1];\r\n\t\t\t\t\tsDay = arD[0];\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!checkDay(sYear, sMonth, sDay))\r\n\t\t\treturn false;\r\n\t}\r\n\tif (arDT.length > 1 && !checkTime(arDT[1]))\r\n\t\treturn false;\r\n\treturn true;\r\n}\r\n\r\n// Unformat 2 digit year to 4 digit year\r\nexport function unformatYear(yr) {\r\n\tif (yr.length == 2)\r\n\t\treturn (yr > ew.UNFORMAT_YEAR) ? \"19\" + yr : \"20\" + yr;\r\n\treturn yr;\r\n}\r\n\r\n// Check day\r\nexport function checkDay(checkYear, checkMonth, checkDay) {\r\n\tcheckYear = parseInt(checkYear, 10);\r\n\tcheckMonth = parseInt(checkMonth, 10);\r\n\tcheckDay = parseInt(checkDay, 10);\r\n\tvar maxDay = [4, 6, 9, 11].includes(checkMonth) ? 30 : 31;\r\n\tif (checkMonth == 2)\r\n\t\tmaxDay = (checkYear % 4 > 0 || checkYear % 100 == 0 && checkYear % 400 > 0) ? 28 : 29;\r\n\treturn checkRange(checkDay, 1, maxDay);\r\n}\r\n\r\n// Check integer\r\nexport function checkInteger(object_value) {\r\n\tif (!object_value || object_value.length == 0)\r\n\t\treturn true;\r\n\tif (object_value.includes(ew.DECIMAL_POINT))\r\n\t\treturn false;\r\n\treturn checkNumber(object_value);\r\n}\r\n\r\n// Check number\r\nexport function checkNumber(object_value) {\r\n\tobject_value = String(object_value);\r\n\tif (!object_value || object_value.length == 0)\r\n\t\treturn true;\r\n\tobject_value = object_value.trim();\r\n\tvar ts = escapeRegExChars(ew.THOUSANDS_SEP), dp = escapeRegExChars(ew.DECIMAL_POINT),\r\n\t\tre = new RegExp(\"^[+-]?(\\\\d{1,3}(\" + (ts ? ts + \"?\" : \"\") + \"\\\\d{3})*(\" + dp + \"\\\\d+)?|\" + dp + \"\\\\d+)$\");\r\n\treturn re.test(object_value);\r\n}\r\n\r\n// Convert to float\r\nexport function stringToFloat(object_value) {\r\n\tobject_value = String(object_value);\r\n\tif (ew.THOUSANDS_SEP != \"\") {\r\n\t\tvar re = new RegExp(escapeRegExChars(ew.THOUSANDS_SEP), \"g\");\r\n\t\tobject_value = object_value.replace(re, \"\");\r\n\t}\r\n\tif (ew.DECIMAL_POINT != \"\")\r\n\t\tobject_value = object_value.replace(ew.DECIMAL_POINT, \".\");\r\n\treturn parseFloat(object_value);\r\n}\r\n\r\n// Convert string (yyyy-mm-dd hh:mm:ss) to date object\r\nexport function stringToDate(object_value) {\r\n\tvar re = /^(\\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\\d|[3][0|1]) (?:(0\\d|1\\d|2[0-3]):([0-5]\\d):([0-5]\\d))?$/;\r\n\tvar ar = object_value.replace(re, \"$1 $2 $3 $4 $5 $6\").split(\" \");\r\n\treturn new Date(ar[0], ar[1]-1, ar[2], ar[3], ar[4], ar[5]);\r\n}\r\n\r\n// Escape regular expression chars\r\nexport function escapeRegExChars(str) {\r\n\treturn str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\r\n}\r\n\r\n// Check range\r\nexport function checkRange(object_value, min_value, max_value) {\r\n\tif (!object_value || object_value.length == 0)\r\n\t\treturn true;\r\n\tif ($.isNumber(min_value) || $.isNumber(max_value)) { // Number\r\n\t\tif (checkNumber(object_value))\r\n\t\t\tobject_value = stringToFloat(object_value);\r\n\t}\r\n\tif (!$.isNull(min_value) && object_value < min_value)\r\n\t\treturn false;\r\n\tif (!$.isNull(max_value) && object_value > max_value)\r\n\t\treturn false;\r\n\treturn true;\r\n}\r\n\r\n// Check time\r\nexport function checkTime(object_value) {\r\n\tif (!object_value || object_value.length == 0)\r\n\t\treturn true;\r\n\tobject_value = object_value.trim();\r\n\tvar re = new RegExp('^(0\\\\d|1\\\\d|2[0-3])' + escapeRegExChars(ew.TIME_SEPARATOR) + '[0-5]\\\\d(( (' + escapeRegExChars(ew.language.phrase(\"AM\")) + '|' + escapeRegExChars(ew.language.phrase(\"PM\")) + '))|(' + escapeRegExChars(ew.TIME_SEPARATOR) + '[0-5]\\\\d(\\\\.\\\\d+)?)?)$', 'i');\r\n\treturn re.test(object_value);\r\n}\r\n\r\n// Check phone\r\nexport function checkPhone(object_value) {\r\n\tif (!object_value || object_value.length == 0)\r\n\t\treturn true;\r\n\treturn /^\\(\\d{3}\\) ?\\d{3}( |-)?\\d{4}|^\\d{3}( |-)?\\d{3}( |-)?\\d{4}$/.test(object_value.trim());\r\n}\r\n\r\n// Check zip\r\nexport function checkZip(object_value) {\r\n\tif (!object_value || object_value.length == 0)\r\n\t\treturn true;\r\n\treturn /^\\d{5}$|^\\d{5}-\\d{4}$/.test(object_value.trim());\r\n}\r\n\r\n// Check credit card\r\nexport function checkCreditCard(object_value) {\r\n\tif (!object_value || object_value.length == 0)\r\n\t\treturn true;\r\n\tvar creditcard_string = object_value.replace(/\\D/g, \"\");\r\n\tif (creditcard_string.length == 0)\r\n\t\treturn false;\r\n\tvar doubledigit = creditcard_string.length % 2 == 1 ? false : true;\r\n\tvar tempdigit, checkdigit = 0;\r\n\tfor (var i = 0, len = creditcard_string.length; i < len; i++) {\r\n\t\ttempdigit = parseInt(creditcard_string.charAt(i), 10);\r\n\t\tif (doubledigit) {\r\n\t\t\ttempdigit *= 2;\r\n\t\t\tcheckdigit += (tempdigit % 10);\r\n\t\t\tif (tempdigit / 10 >= 1.0)\r\n\t\t\t\tcheckdigit++;\r\n\t\t\tdoubledigit = false;\r\n\t\t}\telse {\r\n\t\t\tcheckdigit += tempdigit;\r\n\t\t\tdoubledigit = true;\r\n\t\t}\r\n\t}\r\n\treturn (checkdigit % 10 == 0);\r\n}\r\n\r\n// Check social security number\r\nexport function checkSsc(object_value) {\r\n\tif (!object_value || object_value.length == 0)\r\n\t\treturn true;\r\n\treturn /^(?!000)([0-6]\\d{2}|7([0-6]\\d|7[012]))([ -]?)(?!00)\\d\\d\\3(?!0000)\\d{4}$/.test(object_value.trim());\r\n}\r\n\r\n// Check emails\r\nexport function checkEmails(object_value, email_cnt) {\r\n\tif (!object_value || object_value.length == 0)\r\n\t\treturn true;\r\n\tvar arEmails = object_value.replace(/,/g, \";\").split(\";\");\r\n\tfor (var i = 0, len = arEmails.length; i < len; i++) {\r\n\t\tif (email_cnt > 0 && len > email_cnt)\r\n\t\t\treturn false;\r\n\t\tif (!checkEmail(arEmails[i]))\r\n\t\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n// Check email\r\nexport function checkEmail(object_value) {\r\n\tif (!object_value || object_value.length == 0)\r\n\t\treturn true;\r\n\treturn /^[\\w.%+-]+@[\\w.-]+\\.[A-Z]{2,18}$/i.test(object_value.trim());\r\n}\r\n\r\n// Check GUID {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}\r\nexport function checkGuid(object_value) {\r\n\tif (!object_value || object_value.length == 0)\r\n\t\treturn true;\r\n\treturn /^(\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}|\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12})$/.test(object_value.trim());\r\n}\r\n\r\n// Check by regular expression\r\nexport function checkByRegEx(object_value, pattern) {\r\n\tif (!object_value || object_value.length == 0)\r\n\t\treturn true;\r\n\treturn !!object_value.match(pattern);\r\n}\r\n\r\n/**\r\n * Show message dialog\r\n *\r\n * @param {Event|string} arg - Event or message\r\n * @returns\r\n */\r\nexport function showMessage(arg) {\r\n\tif (window.location != window.parent.location && parent.showMessage) // In iframe\r\n\t\treturn parent.showMessage(arg);\r\n\tvar p = (arg && arg.target) ? arg.target : document,\r\n\t\t$div = $(p).find(\"div.ew-message-dialog:hidden:first\"),\r\n\t\tmsg = $.isString(arg) ? arg.replace(/<[^>]*>/g, \"\") : ($div.length ? $div.text() : \"\"); // Text only\r\n\tif (msg.trim() == \"\")\r\n\t\treturn;\r\n\tif ($div.length) {\r\n\t\t[\"success\", \"info\", \"warning\", \"danger\"].forEach(function(value, index) {\r\n\t\t\tvar $alert = $div.find(\".alert-\" + value).toggleClass(\"alert-\" + value),\r\n\t\t\t\t$heading = $alert.find(\".alert-heading\").detach(),\r\n\t\t\t\t$content = $alert.children(\":not(.icon)\");\r\n\t\t\t$alert.find(\".icon\").remove();\r\n\t\t\tif ($alert[0]) {\r\n\t\t\t\tif (ew.IS_MOBILE) {\r\n\t\t\t\t\talert($alert.text());\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar $toast = $(ew.toastTemplate),\r\n\t\t\t\t\t\t$header = $toast.find(\".toast-header\").addClass(\"bg-\" + value);\r\n\t\t\t\t\tif ($heading[0])\r\n\t\t\t\t\t\t$header.find(\"strong\").html($heading.html());\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\t$header.find(\"strong\").html(ew.language.phrase(value));\r\n\t\t\t\t\tvar w = parseInt($content.css(\"width\"), 10); // Width specified\r\n\t\t\t\t\tif (w > 0) {\r\n\t\t\t\t\t\t$content.first().css(\"width\", \"auto\");\r\n\t\t\t\t\t\t$toast.css(\"max-width\", w); // Override bootstrap .toast max-width\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar msg = $alert.html();\r\n\t\t\t\t\t$toast.find(\".toast-body\").html(msg);\r\n\t\t\t\t\tvar options = {\r\n\t\t\t\t\t\tanimation: true,\r\n\t\t\t\t\t\tautohide: (value == \"success\") ? ew.autoHideSuccessMessage : false, // Autohide for success message\r\n\t\t\t\t\t\tdelay: (value == \"success\") ? ew.autoHideSuccessMessageDelay: 500\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif (!$(\"#toast-container\")[0])\r\n\t\t\t\t\t\t$body.append('<div id=\"toast-container\"></div>');\r\n\t\t\t\t\tvar $container = $(\"#toast-container\").append($toast);\r\n\t\t\t\t\t$toast.toast(options).toast(\"show\").on(\"hidden.bs.toast\", function() {\r\n\t\t\t\t\t\tif ($container[0] && !$container.find(\".toast.show\")[0])\r\n\t\t\t\t\t\t\t$container.remove();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t} else { // Fallback to message box\r\n\t\tif (ew.IS_MOBILE) {\r\n\t\t\talert(msg);\r\n\t\t} else {\r\n\t\t\tvar $dlg = $(\"#ew-message-box\");\r\n\t\t\t$dlg.find(\".modal-body\").html(msg);\r\n\t\t\t$dlg.modal(\"show\");\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// Random number\r\nexport function random() {\r\n\treturn Math.floor(Math.random() * 100001) + 100000;\r\n}\r\n\r\n// File upload\r\nexport function upload(input) {\r\n\tvar $input = $(input);\r\n\tif ($input.data(\"blueimpFileupload\"))\r\n\t\treturn;\r\n\tvar id = $input.attr(\"name\"), nid = id.replace(/\\$/g, \"\\\\$\"), tbl = $input.data(\"table\"),\r\n\t\tmultiple = $input.is(\"[multiple]\"), $p = $input.closest(\".form-group, [id^='el']\"),\r\n\t\treadonly = $input.prop(\"disabled\") || $input.closest(\"form\").find(\"#confirm\").val() == \"confirm\",\r\n\t\t$ft = $p.find(\"#ft_\" + nid), $fn = $p.find(\"#fn_\" + nid), $fa = $p.find(\"#fa_\" + nid), $fs = $p.find(\"#fs_\" + nid),\r\n\t\t$exts = $p.find(\"#fx_\" + nid), $maxsize = $p.find(\"#fm_\" + nid), $maxfilecount = $p.find(\"#fc_\" + nid),\r\n\t\t$label = $p.find(\".custom-file-label\"), label = $label.html();\r\n\tvar _done = function(e, data) {\r\n\t\tif (data.result.files[0].error)\r\n\t\t\treturn;\r\n\t\tvar name = data.result.files[0].name;\r\n\t\tvar ar = (multiple) ? ($fn.val() ? $fn.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR) : []) : [];\r\n\t\tar.push(name);\r\n\t\t$fn.val(ar.join(ew.MULTIPLE_UPLOAD_SEPARATOR));\r\n\t\t$fa.val(\"0\");\r\n\t\tif (!multiple) // Remove other entries if not multiple upload\r\n\t\t\t$ft.find(\"tr:not(:last)\").remove();\r\n\t};\r\n\tvar _deleted = function(e, data) {\r\n\t\tvar url = $(e.originalEvent.target).data(\"url\"),\r\n\t\t\tparam = new URLSearchParams(url.split(\"?\")[1]),\r\n\t\t\tfid = param.get(\"id\"),\r\n\t\t\tname = param.get(fid);\r\n\t\tif (name) {\r\n\t\t\tvar ar = $fn.val() ? $fn.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR) : [];\r\n\t\t\tvar index = ar.indexOf(name);\r\n\t\t\tif (index > -1)\r\n\t\t\t\tar.splice(index, 1);\r\n\t\t\t$fn.val(ar.join(ew.MULTIPLE_UPLOAD_SEPARATOR));\r\n\t\t\t$fa.val(\"0\");\r\n\t\t}\r\n\t};\r\n\tvar _change = function(e, data) {\r\n\t\tvar ar = $fn.val() ? $fn.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR) : [];\r\n\t\tfor (var i = 0; i < data.files.length; i++)\r\n\t\t\tar.push(data.files[i].name);\r\n\t\tvar cnt = parseInt($maxfilecount.val(), 10);\r\n\t\tif ($.isNumber(cnt) && cnt > 0 && ar.length > cnt) {\r\n\t\t\t_alert(ew.language.phrase(\"UploadErrMsgMaxNumberOfFiles\"));\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar l = parseInt($fs.val(), 10);\r\n\t\tif ($.isNumber(l) && l > 0 && ar.join(ew.MULTIPLE_UPLOAD_SEPARATOR).length > l) {\r\n\t\t\t_alert(ew.language.phrase(\"UploadErrMsgMaxFileLength\"));\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n\tvar _confirmDelete = function(e) {\r\n\t\tif (!multiple && $fn.val()) {\r\n\t\t\tif (!confirm(ew.language.phrase(\"UploadOverwrite\"))) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tvar _changed = function() {\r\n\t\t$ft.css(\"margin-top\", ($ft.find(\"tr\")[0] && !readonly) ? \"10px\" : \"0\");\r\n\t\tvar ar = $fn.val() ? $fn.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR) : [];\r\n\t\t$label.html(ar.join(\", \") || label);\r\n\t};\r\n\tvar _clicked = function() {\r\n\t\t$input.closest(\"span.fileinput-button\").tooltip(\"hide\");\r\n\t};\r\n\tvar _processfail = function(e, data) {\r\n\t\tif (data.files && data.files.error)\r\n\t\t\t_alert(data.files[0].error);\r\n\t};\r\n\tvar _downloadTemplate = $.templates(\"#template-download\");\r\n\tvar _uploadTemplate = $.templates(\"#template-upload\");\r\n\tvar _completed = function(e, data) { // After download template rendered\r\n\t\tvar e = { target: data.context };\r\n\t\tinitLightboxes(e);\r\n\t\tinitPdfObjects(e);\r\n\t};\r\n\tvar _added = function(e, data) { // After upload template rendered\r\n\t\tdata.context.find(\".start\").click(_confirmDelete);\r\n\t};\r\n\t// Hide input button if readonly\r\n\tvar form = getForm(input), $form = $(form);\r\n\tvar readonly = $form.find(\"#confirm\").val() == \"confirm\";\r\n\tif (readonly)\r\n\t\t$form.find(\"span.fileinput-button\").hide();\r\n\tvar cnt = parseInt($maxfilecount.val(), 10);\r\n\tvar uploadUrl = getApiUrl(ew.API_JQUERY_UPLOAD_ACTION);\r\n\tvar formData = {\r\n\t\tid: id,\r\n\t\ttable: tbl,\r\n\t\tsession: ew.SESSION_ID,\r\n\t\treplace: (multiple ? \"0\" : \"1\"),\r\n\t\texts: $exts.val(),\r\n\t\tmaxsize: $maxsize.val(),\r\n\t\tmaxfilecount: $maxfilecount.val()\r\n\t};\r\n\t$input.fileupload({\r\n\t\turl: uploadUrl,\r\n\t\ttype: \"POST\",\r\n\t\tmultipart: true,\r\n\t\tautoUpload: true, // Comment out to disable auto upload\r\n\t\tloadImageFileTypes: /^image\\/(gif|jpe?g|png)$/i,\r\n\t\tloadVideoFileTypes: /^video\\/mp4$/i,\r\n\t\tloadAudioFileTypes: /^audio\\/(mpeg|mp3)$/i,\r\n\t\tacceptFileTypes: ($exts.val()) ? new RegExp('\\\\.(' + $exts.val().replace(/,/g, '|') + ')$', 'i') : null,\r\n\t\tmaxFileSize: parseInt($maxsize.val(), 10),\r\n\t\tmaxNumberOfFiles: (cnt > 1) ? cnt : null,\r\n\t\tfilesContainer: $ft,\r\n\t\tformData: formData,\r\n\t\tuploadTemplateId: null,\r\n\t\tdownloadTemplateId: null,\r\n\t\tuploadTemplate: _uploadTemplate.render.bind(_uploadTemplate),\r\n\t\tdownloadTemplate: _downloadTemplate.render.bind(_downloadTemplate),\r\n\t\tpreviewMaxWidth: ew.UPLOAD_THUMBNAIL_WIDTH,\r\n\t\tpreviewMaxHeight: ew.UPLOAD_THUMBNAIL_HEIGHT,\r\n\t\tdropZone: $p,\r\n\t\tpasteZone: $p,\r\n\t\tmessages: {\r\n\t\t\tacceptFileTypes: ew.language.phrase(\"UploadErrMsgAcceptFileTypes\"),\r\n\t\t\tmaxFileSize: ew.language.phrase(\"UploadErrMsgMaxFileSize\"),\r\n\t\t\tmaxNumberOfFiles: ew.language.phrase(\"UploadErrMsgMaxNumberOfFiles\"),\r\n\t\t\tminFileSize: ew.language.phrase(\"UploadErrMsgMinFileSize\")\r\n\t\t},\r\n\t\treadOnly: readonly // Custom\r\n\t}).on(\"fileuploaddone\", _done)\r\n\t\t.on(\"fileuploaddestroy\", _deleted)\r\n\t\t.on(\"fileuploadchange\", _change)\r\n\t\t.on(\"fileuploadadded fileuploadfinished fileuploaddestroyed\", _changed)\r\n\t\t.on(\"fileuploadprocessfail\", _processfail)\r\n\t\t.on('fileuploadadded', _added)\r\n\t\t.on('fileuploadcompleted', _completed)\r\n\t\t.click(_clicked);\r\n\tif ($fn.val()) {\r\n\t\t$.ajax({\r\n\t\t\turl: uploadUrl,\r\n\t\t\tdata: { id: id, table: tbl, session: ew.SESSION_ID },\r\n\t\t\tdataType: \"json\",\r\n\t\t\tcontext: this,\r\n\t\t\tsuccess: function(result) {\r\n\t\t\t\tif (result && result[id]) {\r\n\t\t\t\t\tvar done = $input.fileupload(\"option\", \"done\");\r\n\t\t\t\t\tif (done)\r\n\t\t\t\t\t\tdone.call(input, $.Event(), { result: { files: result[id] } }); // Use \"files\"\r\n\t\t\t\t}\r\n\t\t\t\tif (readonly) // Hide delete button if readonly\r\n\t\t\t\t\t$ft.find(\"td.delete\").hide();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\n/**\r\n * Convert data to number\r\n *\r\n * @param {*} data - Data being converted\r\n * @param {Object} [config] - Configuration\r\n * @param {string} config.decimalSeparator - Decimal separator\r\n * @param {string} config.thousandsSeparator - Thousands separator\r\n * @returns {(number|null)}\r\n */\r\nexport function parseNumber(data, config) {\r\n\tif ($.isString(data)) {\r\n\t\tconfig = config || {\"thousandsSeparator\": ew.THOUSANDS_SEP, \"decimalSeparator\": ew.DECIMAL_POINT};\r\n\t\tvar regexBits = [], regex, separator = config.thousandsSeparator, decimal = config.decimalSeparator;\r\n\t\tif (separator)\r\n\t\t\tregexBits.push(escapeRegExChars(separator) + \"(?=\\\\d)\");\r\n\t\tregex = new RegExp(\"(?:\" + regexBits.join(\"|\") + \")\", \"g\");\r\n\t\tif (decimal === \".\")\r\n\t\t\tdecimal = null;\r\n\t\tdata = data.replace(regex, \"\");\r\n\t\tdata = (decimal) ? data.replace(decimal, \".\") : data;\r\n\t}\r\n\tif ($.isString(data) && data.trim() !== \"\")\r\n\t\tdata = +data;\r\n\tif (!$.isNumber || !isFinite(data)) // Catch NaN and Infinity\r\n\t\tdata = null;\r\n\treturn data;\r\n}\r\n\r\n/**\r\n * Format a Number to string for display\r\n *\r\n * @param {*} data - Data being converted\r\n * @param {Object} [config] - Configuration\r\n * @param {number} config.decimalPlaces - Number of decimal places to round. Must be a number 0 to 20.\r\n * @param {string} config.decimalSeparator - Decimal separator\r\n * @param {string} config.thousandsSeparator - Thousands separator\r\n * @returns {string} Note: null, undefined, NaN and \"\" returns as \"\".\r\n */\r\nexport function formatNumber(data, config) {\r\n\tif ($.isNumber(data)) {\r\n\t\tconfig = config || {\"thousandsSeparator\": ew.THOUSANDS_SEP, \"decimalSeparator\": ew.DECIMAL_POINT};\r\n\t\tvar isNeg = (data < 0), output = data + \"\", decPlaces = config.decimalPlaces,\r\n\t\t\tdecSep = config.decimalSeparator || \".\", thouSep = config.thousandsSeparator,\r\n\t\t\tdecIndex, newOutput, count, i;\r\n\t\tif ($.isNumber(decPlaces) && (decPlaces >= 0) && (decPlaces <= 20)) // Decimal precision\r\n\t\t\toutput = data.toFixed(decPlaces);\r\n\t\tif (decSep !== \".\") // Decimal separator\r\n\t\t\toutput = output.replace(\".\", decSep);\r\n\t\tif (thouSep) { // Add the thousands separator\r\n\t\t\tdecIndex = output.lastIndexOf(decSep); // Find the dot or where it would be\r\n\t\t\tdecIndex = (decIndex > -1) ? decIndex : output.length;\r\n\t\t\tnewOutput = output.substring(decIndex); // Start with the dot and everything to the right\r\n\t\t\tfor (count = 0, i = decIndex; i > 0; i--) { // Working left, every third time add a separator, every time add a digit\r\n\t\t\t\tif (count%3 === 0 && i !== decIndex && (!isNeg || i > 1))\r\n\t\t\t\t\tnewOutput = thouSep + newOutput;\r\n\t\t\t\tnewOutput = output.charAt(i-1) + newOutput;\r\n\t\t\t\tcount++;\r\n\t\t\t}\r\n\t\t\toutput = newOutput;\r\n\t\t}\r\n\t\treturn output;\r\n\t} else { // Not a Number, return as string\r\n\t\treturn ($.isValue(data) && data.toString) ? data.toString() : \"\";\r\n\t}\r\n}\r\n\r\n/**\r\n * Convert data to Moment object (see http://momentjs.com/docs/)\r\n *\r\n * @param {*} data - Data being converted\r\n * @param {number} format - Date format matching server side FormatDateTime()\r\n * @returns {Moment}\r\n */\r\nexport function parseDate(data, format) {\r\n\tvar args = $.makeArray(arguments);\r\n\tif ($.isNumber(format) && format >=0 && format <= 17) {\r\n\t\tvar f, def = ew.DATE_FORMAT.toUpperCase(), sep = ew.DATE_SEPARATOR, timesep = ew.TIME_SEPARATOR;\r\n\t\tswitch (format) {\r\n\t\t\tcase 0: case 1: case 2: case 8: f = def + \" HH\" + timesep + \"mm\" + timesep + \"ss\"; break; // ew.DATE_FORMAT + \" %H:%M:%S\"\r\n\t\t\tcase 3: f = \"hh:mm:ss A\"; break; // \"%I:%M:%S %p\"\r\n\t\t\tcase 4: f = \"HH:mm:ss\"; break; // \"%H:%M:%S\"\r\n\t\t\tcase 5: f = \"YYYY\" + sep + \"MM\" + sep + \"DD\"; break; // \"%Y\" + sep + \"%m\" + sep + \"%d\"\r\n\t\t\tcase 6: f = \"MM\" + sep + \"DD\" + sep + \"YYYY\"; break; // \"%m\" + sep + \"%d\" + sep + \"%Y\"\r\n\t\t\tcase 7: f = \"DD\" + sep + \"MM\" + sep + \"YYYY\"; break; // \"%d\" + sep + \"%m\" + sep + \"%Y\"\r\n\t\t\tcase 9: f = \"YYYY\" + sep + \"MM\" + sep + \"DD HH\" + timesep + \"mm\" + timesep + \"ss\"; break; // \"%Y\" + sep + \"%m\" + sep + \"%d %H:%M:%S\"\r\n\t\t\tcase 10: f = \"MM\" + sep + \"DD\" + sep + \"YYYY HH\" + timesep + \"mm\" + timesep + \"ss\"; break; // \"%m\" + sep + \"%d\" + sep + \"%Y %H:%M:%S\"\r\n\t\t\tcase 11: f = \"DD\" + sep + \"MM\" + sep + \"YYYY HH\" + timesep + \"mm\" + timesep + \"ss\"; break; // \"%d\" + sep + \"%m\" + sep + \"%Y %H:%M:%S\"\r\n\t\t\tcase 12: f = \"YY\" + sep + \"MM\" + sep + \"DD\"; break; // \"%y\" + sep + \"%m\" + sep + \"%d\"\r\n\t\t\tcase 13: f = \"MM\" + sep + \"DD\" + sep + \"YY\"; break; // \"%m\" + sep + \"%d\" + sep + \"%y\"\r\n\t\t\tcase 14: f = \"DD\" + sep + \"MM\" + sep + \"YY\"; break; // \"%d\" + sep + \"%m\" + sep + \"%y\"\r\n\t\t\tcase 15: f = \"YY\" + sep + \"MM\" + sep + \"DD HH\" + timesep + \"mm\" + timesep + \"ss\"; break; // \"%y\" + sep + \"%m\" + sep + \"%d %H:%M:%S\"\r\n\t\t\tcase 16: f = \"MM\" + sep + \"DD\" + sep + \"YY HH\" + timesep + \"mm\" + timesep + \"ss\"; break; // \"%m\" + sep + \"%d\" + sep + \"%y %H:%M:%S\"\r\n\t\t\tcase 17: f = \"DD\" + sep + \"MM\" + sep + \"YY HH\" + timesep + \"mm\" + timesep + \"ss\"; break; // \"%d\" + sep + \"%m\" + sep + \"%y %H:%M:%S\"\r\n\t\t}\r\n\t\targs[1] = [f, \"YYYY-MM-DD HH\" + timesep + \"mm\" + timesep + \"ss\"];\r\n\t}\r\n\treturn moment.apply(this, args);\r\n}\r\n\r\n/**\r\n * Format date time\r\n *\r\n * @param {*} data - Date being formatted\r\n * @param {string} format - Date format (see http://momentjs.com/docs/#/displaying/format/)\r\n * @returns {string}\r\n */\r\nexport function formatDate(data, format) {\r\n\treturn moment(data).format(format || ew.DATE_FORMAT.toUpperCase());\r\n}\r\n\r\n/**\r\n * Init page\r\n *\r\n * @param {Event|undefined} e - Event\r\n */\r\nexport function initPage(e) {\r\n\tvar el = (e && e.target) ? e.target : document,\r\n\t\t$el = $(el),\r\n\t\t$tables = $el.find(\"table.ew-table:not(.ew-export-table)\");\r\n\tArray.prototype.forEach.call(el.querySelectorAll(\".ew-grid-upper-panel, .ew-grid-lower-panel\"), ew.initGridPanel); // Init grid panels\r\n\tew.renderJsTemplates(e);\r\n\tinitForms(e);\r\n\tinitTooltips(e);\r\n\tinitPasswordOptions(e);\r\n\tinitIcons(e);\r\n\tinitLightboxes(e);\r\n\tinitPdfObjects(e);\r\n\t$el.find(\"[data-widget='treeview']\").each(function() {\r\n\t\tadminlte.Treeview._jQueryInterface.call($(this), \"init\");\r\n\t});\r\n\t$tables.each(setupTable); // Init tables\r\n\t$el.find(\".ew-btn-dropdown\").on(\"shown.bs.dropdown\", function() {\r\n\t\tvar $this = $(this).removeClass(\"dropup\"),\r\n\t\t\t$window = $(window),\r\n\t\t\t$menu = $this.find(\"> .dropdown-menu\");\r\n\t\t$this.toggleClass(\"dropup\", $menu.offset().top + $menu.height() > $window.scrollTop() + $window.height());\r\n\t});\r\n\t$el.find(\"input[name=pageno]\").keypress(function(e) {\r\n\t\tif (e.which == 13) {\r\n\t\t\tcurrentUrl.searchParams.append(this.name, parseInt(this.value));\r\n\t\t\twindow.location = currentUrl.toString();\r\n\t\t\treturn false;\r\n\t\t}\r\n\t});\r\n\tif (!ew.IS_SCREEN_SM_MIN) {\r\n\t\t$el.find(\".\" + ew.RESPONSIVE_TABLE_CLASS + \" [data-toggle='dropdown']\").parent().on(\"shown.bs.dropdown\", function() {\r\n\t\t\tvar $this = $(this),\r\n\t\t\t\t$menu = $this.find(\".dropdown-menu\"),\r\n\t\t\t\tdiv = $this.closest(\".\" + ew.RESPONSIVE_TABLE_CLASS)[0];\r\n\t\t\tif (div.scrollHeight - div.clientHeight) {\r\n\t\t\t\tvar d = $menu.offset().top + $menu.outerHeight() - $(div).offset().top - div.clientHeight;\r\n\t\t\t\tif (d > 0)\r\n\t\t\t\t\t$menu.css(ew.CSS_FLIP ? \"right\" : \"left\", \"100%\").css(\"top\", parseFloat($menu.css(\"top\")) - d);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tlazyLoad(e);\r\n\tinitExportLinks(e);\r\n\tinitMultiSelectCheckboxes(e);\r\n\r\n\t// Report\r\n\tvar $rpt = $el.find(\".ew-report\");\r\n\tif ($rpt[0]) {\r\n\t\t$rpt.find(\".card\").on(\"collapsed.lte.widget\", function() { // Fix min-height when .lte.widget is collapsed\r\n\t\t\tvar $card = $(this), $div = $card.closest(\"[class^='col-']\"), mh = $div.css(\"min-height\");\r\n\t\t\tif (mh)\r\n\t\t\t\t$div.data(\"min-height\", mh);\r\n\t\t\t$div.css(\"min-height\", 0);\r\n\t\t}).on(\"expanded.lte.widget\", function() { // Fix min-height when .lte.widget is expanded\r\n\t\t\tvar $card = $(this), $div = $card.closest(\"[class^='col-']\"), mh = $div.css(\"min-height\");\r\n\t\t\tif (mh)\r\n\t\t\t\t$div.css(\"min-height\", mh); // Restore min-height\r\n\t\t});\r\n\t\t// Group expand/collapse button\r\n\t\t$rpt.find(\"span.ew-group-toggle\").on(\"click\", function() {\r\n\t\t\tew.toggleGroup(this);\r\n\t\t});\r\n\t}\r\n\r\n\t// Show message\r\n\tif (typeof ew.USE_JAVASCRIPT_MESSAGE != \"undefined\" && ew.USE_JAVASCRIPT_MESSAGE)\r\n\t\tshowMessage(e);\r\n}\r\n\r\n// Redirect by HTTP GET or POST\r\nexport function redirect(url, f, method) {\r\n\tvar ar = url.split(\"?\"),\r\n\t\tparams = new URLSearchParams(ar[1]);\r\n\t//***params.set(ew.TOKEN_NAME, ew.ANTIFORGERY_TOKEN);\r\n\tparams.set(ew.TOKEN_NAME_KEY, ew.TOKEN_NAME); //*** PHP\r\n\tparams.set(ew.ANTIFORGERY_TOKEN_KEY, ew.ANTIFORGERY_TOKEN); //*** PHP\r\n\tif (sameText(method, \"post\")) { // POST\r\n\t\tvar $form = (f) ? $(f) : $(\"<form></form>\").appendTo(\"body\");\r\n\t\t$form.attr({ action: ar[0], method: \"post\" });\r\n\t\tparams.forEach(function(value, key) {\r\n\t\t\t$('<input type=\"hidden\">').attr({ name: key, value: sanitize(value) }).appendTo($form);\r\n\t\t});\r\n\t\t$form.submit();\r\n\t} else { // GET\r\n\t\tvar search = params.toString();\r\n\t\twindow.location = ar[0] + (search ? \"?\" + search : \"\");\r\n\t}\r\n}\r\n\r\n// Show/Hide password\r\nexport function togglePassword(e) {\r\n\tvar $btn = $(e.currentTarget), $input = $btn.closest(\".input-group\").find(\"input\"), $i = $btn.find(\"i\");\r\n\tif ($input.attr(\"type\") == \"text\") {\r\n\t\t$input.attr(\"type\", \"password\");\r\n\t\t$i.toggleClass(\"fa-eye-slash fa-eye\");\r\n\t} else if($input.attr(\"type\") == \"password\"){\r\n\t\t$input.attr(\"type\", \"text\");\r\n\t\t$i.toggleClass(\"fa-eye-slash fa-eye\");\r\n\t}\r\n}\r\n\r\n// Export with charts\r\nexport function exportWithCharts(e, url, exportId, f) {\r\n\tvar el = e.target;\r\n\texportId += \"_\" + Date.now();\r\n\turl += (url.split(\"?\").length > 1 ? \"&\" : \"?\") + \"exportid=\" + exportId;\r\n\tvar p = currentPage(), rootPath = p.substring(0, p.lastIndexOf(\"/\") + 1);\r\n\turl = rootPath + url; // Use full URL\r\n\r\n\tvar $el = $(el), method = (f) ? \"post\" : \"get\";\r\n\tif ($el.is(\".dropdown-menu a\"))\r\n\t\t$el = $el.closest(\".btn-group\");\r\n\r\n\tvar _export = function() {\r\n\t\tvar exportUrl = url.replace(/&amp;/g, \"&\"),\r\n\t\t\tobj = new URL(exportUrl),\r\n\t\t\tparams = obj.searchParams,\r\n\t\t\tcustom = params.get(\"custom\") == \"1\";\r\n\t\tif (f && !custom) { // Not custom\r\n\t\t\tvar data = $(f).serialize(); // Add token\r\n\t\t\t$.post(exportUrl, data, function(result) {\r\n\t\t\t\tew.showMessage(result);\r\n\t\t\t});\r\n\t\t} else { // Custom\r\n\t\t\tvar exp = params.get(\"export\");\r\n\t\t\tif (custom && [\"word\", \"excel\", \"pdf\", \"email\"].includes(exp)) {\r\n\t\t\t\tif (exp == \"email\") {\r\n\t\t\t\t\tparams.delete(\"export\"); // Remove duplicate export=email (exists in form)\r\n\t\t\t\t\texportUrl = obj.toString() + \"&\" + $(f).serialize();\r\n\t\t\t\t}\r\n\t\t\t\t$(\"iframe.ew-export\").remove();\r\n\t\t\t\t$(\"<iframe></iframe>\").addClass(\"ew-export d-none\").attr(\"src\", exportUrl).appendTo($body.css(\"cursor\", \"wait\"));\r\n\t\t\t\tsetTimeout(function() { $body.css(\"cursor\", \"default\"); }, 5000);\r\n\t\t\t} else if (exp == \"print\") {\r\n\t\t\t\tew.redirect(exportUrl, f, method);\r\n\t\t\t} else {\r\n\t\t\t\tew.fileDownload(exportUrl, null);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\r\n\tvar keys = Object.keys(window.exportCharts);\r\n\tif (keys.length == 0) // No charts, just submit the form\r\n\t\treturn _export();\r\n\r\n\t// Success callback\r\n\tvar success = function(result) {\r\n\t\tif ($.isString(result))\r\n\t\t\tresult = parseJson(result);\r\n\t\tif (result.success) {\r\n\t\t\t_export();\r\n\t\t} else {\r\n\t\t\tew.alert(result.error);\r\n\t\t}\r\n\t};\r\n\r\n\t// Failure callback\r\n\tvar fail = function(xhr, status, error) {\r\n\t\tew.alert(error + \": \" + xhr.responseText); // Show detailed export error message\r\n\t};\r\n\r\n\t// Export charts\r\n\t$body.css(\"cursor\", \"wait\");\r\n\tvar charts = [];\r\n\tfor (var i = 0; i < keys.length; i++) {\r\n\t\tvar id = keys[i], o = window.exportCharts[id],\r\n\t\t\tparams = \"exportfilename=\" + exportId + \"_\" + id + \".png|exportformat=png|exportaction=download|exportparameters=undefined\";\r\n\t\tif (o && o.toBase64Image) // Chart.js chart\r\n\t\t\tcharts.push({ \"chart_engine\": \"Chart.js\", \"stream_type\": \"base64\", \"stream\": o.toBase64Image(), \"parameters\": params });\r\n\t}\r\n\t$.ajax({\r\n\t\t\"url\": getApiUrl(ew.API_EXPORT_CHART_ACTION),\r\n\t\t\"data\": { \"charts\": JSON.stringify(charts) },\r\n\t\t\"cache\": false,\r\n\t\t\"type\": \"POST\"\r\n\t}).done(success).fail(fail).always(function() {\r\n\t\t$(\"#ew-message-box\").find(\".modal-footer button\").prop(\"disabled\", false); // Enable the button disabled by fileDownload()\r\n\t\t$body.css(\"cursor\", \"default\");\r\n\t});\r\n\treturn false;\r\n}\r\n\r\n// Layout\r\nvar _fixLayoutHeightTimer;\r\n\r\n// Fix layout height\r\nexport function fixLayoutHeight() {\r\n\tif (_fixLayoutHeightTimer)\r\n\t\t_fixLayoutHeightTimer.cancel(); // Clear timer\r\n\t_fixLayoutHeightTimer = $.later(50, null, function () {\r\n\t\tvar layout = $body.data(\"lte.layout\");\r\n\t\tif (layout)\r\n\t\t\tlayout.fixLayoutHeight();\r\n\t});\r\n}","import Form from \"./form\";\r\n\r\nexport default class HttpForm extends Form {\r\n\r\n\tconstructor(id, pageId) {\r\n\t\tsuper(id, pageId);\r\n\t}\r\n\r\n\ttest() {\r\n\t\treturn \"\";\r\n\t}\r\n}","import $ from 'jquery';\r\nimport MultiPage from \"./multipage\";\r\nimport * as functions from './functions';\r\nimport HttpForm from \"./httpform\";\r\n\r\new.IS_SCREEN_SM_MIN = window.matchMedia(\"(min-width: 768px)\").matches; // Should matches $screen-sm-min\r\new.MOBILE_DETECT = new MobileDetect(window.navigator.userAgent);\r\new.IS_MOBILE = !!ew.MOBILE_DETECT.mobile();\r\new.IS_IE = ew.MOBILE_DETECT.version(\"MSIE\") > 0;\r\new.SHOW_EXPORT_DIALOG = !ew.IS_IE;\r\n\r\n// Charts\r\nwindow.exportCharts = {}; // Per window\r\nwindow.drillDownCharts = {}; // Per window\r\n\r\n// Init spinner\r\new.addSpinner();\r\n\r\n// Extend\r\nObject.assign(ew, { MultiPage, HttpForm }, functions);\r\n\r\nvar $document = $(document);\r\n\r\n// Init document\r\nloadjs.ready(\"load\", function () {\r\n\t$.views.settings.debugMode(ew.DEBUG);\r\n\tew.setSessionTimer();\r\n\tew.initPage();\r\n\t$(\"#ew-modal-dialog\").on(\"load.ew\", ew.initPage);\r\n\t$(\"#ew-add-opt-dialog\").on(\"load.ew\", ew.initPage);\r\n\tvar hash = ew.currentUrl.searchParams.get(\"hash\");\r\n\tif (hash)\r\n\t\t$(\"html, body\").animate({ scrollTop: $(\"#\" + hash).offset().top }, 800);\r\n\tew.removeSpinner();\r\n\t$document.trigger(\"load\");\r\n});\r\n\r\n// Default \"addoption\" event (fired before adding new option to selection list)\r\n$document.on(\"addoption\", function (e, args) {\r\n\tvar row = args.data; // New row to be validated\r\n\tvar arp = args.parents; // Parent field values\r\n\tfor (var i = 0, cnt = arp.length; i < cnt; i++) { // Iterate parent values\r\n\t\tvar p = arp[i];\r\n\t\tif (!p.length) // Empty parent\r\n\t\t\t//continue; // Allow\r\n\t\t\treturn args.valid = false; // Disallow\r\n\t\tvar val = row[\"ff\" + ((i > 0) ? i + 1 : \"\")]; // Filter fields start from the 6th field\r\n\t\tif (!$.isUndefined(val) && !p.includes(String(val))) // Filter field value not in parent field values\r\n\t\t\treturn args.valid = false; // Returns false if invalid\r\n\t}\r\n});\r\n\r\n// Fix z-index of multiple modals\r\n$document.on(\"show.bs.modal\", \".modal\", function () {\r\n\tvar zIndex = 1040 + $(\".modal:visible\").length;\r\n\t$(this).css(\"z-index\", zIndex);\r\n\tsetTimeout(function () {\r\n\t\t$(\".modal-backdrop\").not(\".modal-stack\").css(\"z-index\", zIndex - 1).addClass(\"modal-stack\");\r\n\t}, 0);\r\n});\r\n\r\n// Fix scrolling of multiple modals\r\n$document.on(\"hidden.bs.modal\", \".modal\", function () {\r\n\t$(\".modal:visible\").length && $(\"body\").addClass(\"modal-open\");\r\n});","import $ from \"jquery\";\r\n\r\nexport default function MultiPage(formid) {\r\n\tvar self = this;\r\n\tthis.$form = null;\r\n\tthis.formID = formid;\r\n\tthis.pageIndex = 1;\r\n\tthis.maxPageIndex = 0;\r\n\tthis.minPageIndex = 0;\r\n\tthis.pageIndexes = [];\r\n\tthis.$pages = null;\r\n\tthis.$collapses = null;\r\n\tthis.isTab = false; // Is tabs\r\n\tthis.isCollapse = false; // Is collapses (accordion)\r\n\tthis.lastPageSubmit = false; // Enable submit button for the last page only\r\n\tthis.hideDisabledButton = false; // Hide disabled submit button\r\n\tthis.hideInactivePages = false; // Hide inactive pages\r\n\tthis.lockTabs = false; // Set inactive tabs as disabled\r\n\tthis.hideTabs = false; // Hide all tabs\r\n\tthis.showPagerTop = false; // Show pager at top\r\n\tthis.showPagerBottom = false; // Show pager at bottom\r\n\tthis.pagerTemplate = '<nav><ul class=\"pagination\"><li class=\"page-item previous ew-prev\"><a href=\"#\" class=\"page-link\"><span class=\"icon-prev\"></span> {Prev}</a></li><li class=\"page-item next ew-next\"><a href=\"#\" class=\"page-link\">{Next} <span class=\"icon-next\"></span></a></li></ul></nav>'; // Pager template\r\n\r\n\t// \"show\" handler (for disabled tabs)\r\n\tvar _show = function(e) {\r\n\t\te.preventDefault();\r\n\t};\r\n\r\n\t// Set properties\r\n\tvar _properties = [\"lastPageSubmit\", \"hideDisabledButton\", \"hideInactivePages\", \"lockTabs\",\r\n\t\t\"hideTabs\", \"showPagerTop\", \"showPagerBottom\", \"pagerTemplate\"];\r\n\r\n\tthis.set = function() {\r\n\t\tif (arguments.length == 1 && $.isObject(arguments[0])) {\r\n\t\t\tvar obj = arguments[0];\r\n\t\t\tfor (var i in obj) {\r\n\t\t\t\tvar p = i[0].toLowerCase() + i.substr(1); // Camel case\r\n\t\t\t\tif (_properties.includes(p))\r\n\t\t\t\t\tthis[p] = obj[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// DOM loaded\r\n\tthis.init = function() {\r\n\t\tvar tpl = this.pagerTemplate.replace(/\\{prev\\}/i, ew.language.phrase(\"Prev\")).replace(/\\{next\\}/i, ew.language.phrase(\"Next\"));\r\n\t\tif (this.isTab) {\r\n\t\t\tif (this.showPagerTop)\r\n\t\t\t\tthis.$pages.closest(\".tabbable, .ew-nav-tabs\").before(tpl);\r\n\t\t\tif (this.showPagerBottom)\r\n\t\t\t\tthis.$pages.closest(\".tabbable, .ew-nav-tabs\").after(tpl);\r\n\t\t\tthis.$form.find(\".ew-prev\").click(function(e) {\r\n\t\t\t\tself.$pages.off(\"show.bs.tab\", _show).filter(\".active\").parent()\r\n\t\t\t\t\t.prev(\":has([data-toggle=tab]:not(.ew-hidden):not(.ew-disabled))\")\r\n\t\t\t\t\t.find(\"[data-toggle=tab]\").toggleClass(\"disabled d-none\", false).click();\r\n\t\t\t\treturn false;\r\n\t\t\t});\r\n\t\t\tthis.$form.find(\".ew-next\").click(function(e) {\r\n\t\t\t\tself.$pages.off(\"show.bs.tab\", _show).filter(\".active\").parent()\r\n\t\t\t\t\t.next(\":has([data-toggle=tab]:not(.ew-hidden):not(.ew-disabled))\")\r\n\t\t\t\t\t.find(\"[data-toggle=tab]\").toggleClass(\"disabled d-none\", false).click();\r\n\t\t\t\treturn false;\r\n\t\t\t});\r\n\t\t\tif (this.hideTabs)\r\n\t\t\t\tthis.$form.find(\".ew-multi-page > .tabbable > .nav-tabs, .ew-multi-page > .ew-nav-tabs > .nav-tabs\").hide();\r\n\t\t} else if (this.isCollapse) {\r\n\t\t\tif (this.showPagerTop)\r\n\t\t\t\tthis.$collapses.closest(\".ew-accordion\").before(tpl);\r\n\t\t\tif (this.showPagerBottom)\r\n\t\t\t\tthis.$collapses.closest(\".ew-accordion\").after(tpl);\r\n\t\t\tthis.$form.find(\".ew-prev\").click(function(e) {\r\n\t\t\t\tself.$pages.closest(\".card\").filter(\":has(.collapse.show)\")\r\n\t\t\t\t\t.prev(\":has([data-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))\")\r\n\t\t\t\t\t.toggleClass(\"disabled d-none\", false)\r\n\t\t\t\t\t.find(\"[data-toggle=collapse]\").click();\r\n\t\t\t\treturn false;\r\n\t\t\t});\r\n\t\t\tthis.$form.find(\".ew-next\").click(function(e) {\r\n\t\t\t\tself.$pages.closest(\".card\").filter(\":has(.collapse.show)\")\r\n\t\t\t\t\t.next(\":has([data-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))\")\r\n\t\t\t\t\t.toggleClass(\"disabled d-none\", false)\r\n\t\t\t\t\t.find(\"[data-toggle=collapse]\").click();\r\n\t\t\t\treturn false;\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.pageShow();\r\n\t}\r\n\r\n\t// Page show\r\n\tthis.pageShow = function() {\r\n\t\tif (this.isTab) {\r\n\t\t\tif (this.lockTabs)\r\n\t\t\t\tthis.$pages.on(\"show.bs.tab\", _show);\r\n\t\t\tthis.$pages.each(function() {\r\n\t\t\t\tvar $this = $(this);\r\n\t\t\t\tif (self.hideInactivePages)\r\n\t\t\t\t\t$this.toggleClass(\"d-none\", !$this.hasClass(\"active\"));\r\n\t\t\t\tif (self.lockTabs)\r\n\t\t\t\t\t$this.toggleClass(\"disabled\", !$this.hasClass(\"active\"));\r\n\t\t\t});\r\n\t\t} else if (this.isCollapse) {\r\n\t\t\tthis.$pages.closest(\".card\").each(function() {\r\n\t\t\t\tvar $this = $(this);\r\n\t\t\t\tif (self.hideInactivePages)\r\n\t\t\t\t\t$this.toggleClass(\"d-none\", !$this.find(\".collapse.show\")[0]);\r\n\t\t\t});\r\n\t\t}\r\n\t\tvar disabled = this.lastPageSubmit && this.pageIndex != this.maxPageIndex;\r\n\t\tvar $btn = this.$form.closest(\".content, .modal-content\").find(\"#btn-action, button.ew-submit\").prop(\"disabled\", disabled).toggle(!this.hideDisabledButton || !disabled);\r\n\t\t$(\".ew-captcha\").toggle($btn.is(\":visible:not(:disabled)\")); // Re-captcha uses class \"disabled\", not \"disabled\" property.\r\n\t\tdisabled = this.pageIndex <= this.minPageIndex;\r\n\t\tthis.$form.find(\".ew-prev\").toggleClass(\"disabled\", disabled);\r\n\t\tdisabled = this.pageIndex >= this.maxPageIndex;\r\n\t\tthis.$form.find(\".ew-next\").toggleClass(\"disabled\", disabled);\r\n\t}\r\n\r\n\t// Go to page by index\r\n\tthis.gotoPage = function(i) {\r\n\t\tif (i <= 0 || i < this.minPageIndex || i > this.maxPageIndex)\r\n\t\t\treturn;\r\n\t\tif (this.pageIndex != i) {\r\n\t\t\tvar $page = this.$pages.eq(i - 1);\r\n\t\t\tif (this.isTab) {\r\n\t\t\t\tif ($page.is(\":not(.d-none):not(.disabled)\"))\r\n\t\t\t\t\t$page.click();\r\n\t\t\t\telse\r\n\t\t\t\t\t$page.parent().next(\":has([data-toggle=tab]):not(.d-none):not(.disabled)\")\r\n\t\t\t\t\t\t.find(\"[data-toggle=tab]\").toggleClass(\"disabled\", false).click();\r\n\t\t\t} else if (this.isCollapse) {\r\n\t\t\t\tvar $p = $page.closest(\".card\");\r\n\t\t\t\tif ($p.is(\":not(.d-none)\"))\r\n\t\t\t\t\t$page.click();\r\n\t\t\t\telse\r\n\t\t\t\t\t$p.next(\":has([data-toggle=collapse]):not(.d-none)\").find(\"[data-toggle=collapse]\").click();\r\n\t\t\t}\r\n\t\t\tthis.pageIndex = i;\r\n\t\t}\r\n\t}\r\n\r\n\tthis.gotoPageByIndex = this.gotoPage;\r\n\r\n\t// Go to page by element\r\n\tthis.gotoPageByElement = function(el) {\r\n\t\tthis.gotoPage(parseInt($(el).data(\"page\"), 10) || -1);\r\n\t}\r\n\r\n\t// Go to page by element's id or name or data-field attribute\r\n\tthis.gotoPageByElementId = function(id) {\r\n\t\tvar $el = this.$form.find(\"[data-page]\").filter(\"[id='\" + id + \"'],[name='\" + id + \"'],[data-field='\" + id + \"']\");\r\n\t\tthis.gotoPageByElement($el);\r\n\t}\r\n\r\n\t// Toggle page\r\n\tthis.togglePage = function(i, show) {\r\n\t\tif (this.isTab) {\r\n\t\t\tthis.$pages.eq(i - 1).toggleClass(\"d-none\", !show);\r\n\t\t} else if (this.isCollapse) {\r\n\t\t\tthis.$pages.eq(i - 1).closest(\".card\").toggle(\"d-none\", !show);\r\n\t\t}\r\n\t}\r\n\r\n\t// Render\r\n\tthis.render = function() {\r\n\t\tthis.$form = $(\"#\" + formid);\r\n\t\tthis.pageIndexes = this.$form.find(\"[data-page]\").map(function() {\r\n\t\t\tvar index = parseInt($(this).data(\"page\"), 10);\r\n\t\t\treturn (index > 0) ? index : null;\r\n\t\t}).get();\r\n\t\tthis.pageIndexes.sort(function(a, b) {\r\n\t\t\treturn a - b;\r\n\t\t});\r\n\t\tthis.minPageIndex = this.pageIndexes[0];\r\n\t\tthis.maxPageIndex = this.pageIndexes[this.pageIndexes.length - 1];\r\n\t\tvar $tabs = this.$form.find(\"[data-toggle=tab]\");\r\n\t\tif ($tabs[0]) {\r\n\t\t\tthis.$pages = $tabs;\r\n\t\t\tthis.isTab = true;\r\n\t\t\t$tabs.on(\"shown.bs.tab\", function(e) {\r\n\t\t\t\tself.pageIndex = $tabs.index(e.target) + 1;\r\n\t\t\t\tself.pageShow();\r\n\t\t\t\t$($(this).attr(\"href\")).find(\".ew-google-map\").each(function() {\r\n\t\t\t\t\tvar m = ew.googleMaps[this.id];\r\n\t\t\t\t\tif (m && m[\"map\"]) {\r\n\t\t\t\t\t\tgoogle.maps.event.trigger(m[\"map\"], \"resize\");\r\n\t\t\t\t\t\tm[\"map\"].setCenter(m[\"latlng\"]);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tthis.pageIndex = $tabs.index($tabs.parent(\".active\")) + 1;\r\n\t\t} else {\r\n\t\t\tthis.$collapses = this.$form.find(\"[data-toggle=collapse]\");\r\n\t\t\tif (this.$collapses[0]) {\r\n\t\t\t\tthis.$pages = this.$collapses;\r\n\t\t\t\tthis.isCollapse = true;\r\n\t\t\t\tvar $bodies = this.$collapses.closest(\".card-header\").next();\r\n\t\t\t\t$bodies.on(\"shown.bs.collapse\", function(e) {\r\n\t\t\t\t\tself.pageIndex = $bodies.index(e.target) + 1;\r\n\t\t\t\t\tself.pageShow();\r\n\t\t\t\t\t$(this).find(\".ew-google-map\").each(function() {\r\n\t\t\t\t\t\tvar m = ew.googleMaps[this.id];\r\n\t\t\t\t\t\tif (m && m[\"map\"]) {\r\n\t\t\t\t\t\t\tgoogle.maps.event.trigger(m[\"map\"], \"resize\");\r\n\t\t\t\t\t\t\tm[\"map\"].setCenter(m[\"latlng\"]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tthis.pageIndex = $bodies.index($bodies.hasClass(\"show\")) + 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\t$(function() {\r\n\t\t\tself.init();\r\n\t\t});\r\n\t}\r\n}","import jQuery from 'jquery';\r\n\r\n// Extend jQuery\r\njQuery.extend({\r\n\tisBoolean: function(o) {\r\n\t\treturn typeof o === 'boolean';\r\n\t},\r\n\tisNull: function(o) {\r\n\t\treturn o === null;\r\n\t},\r\n\tisNumber: function(o) {\r\n\t\treturn typeof o === 'number' && isFinite(o);\r\n\t},\r\n\tisObject: function(o) {\r\n\t\treturn (o && (typeof o === 'object' || this.isFunction(o))) || false;\r\n\t},\r\n\tisString: function(o) {\r\n\t\treturn typeof o === 'string';\r\n\t},\r\n\tisUndefined: function(o) {\r\n\t\treturn typeof o === 'undefined';\r\n\t},\r\n\tisValue: function(o) {\r\n\t\treturn (this.isObject(o) || this.isString(o) || this.isNumber(o) || this.isBoolean(o));\r\n\t},\r\n\tisDate: function(o) {\r\n\t\treturn this.type(o) === 'date' && o.toString() !== 'Invalid Date' && !isNaN(o);\r\n\t},\r\n\tlater: function(when, o, fn, data, periodic) {\r\n\t\twhen = when || 0;\r\n\t\to = o || {};\r\n\t\tvar m = fn, d = data, f, r;\r\n\t\tif (this.isString(fn))\r\n\t\t\tm = o[fn];\r\n\t\tif (!m)\r\n\t\t\treturn;\r\n\t\tif (!this.isUndefined(data) && !this.isArray(d))\r\n\t\t\td = [data];\r\n\t\tf = function() {\r\n\t\t\tm.apply(o, d || []);\r\n\t\t};\r\n\t\tr = (periodic) ? setInterval(f, when) : setTimeout(f, when);\r\n\t\treturn {\r\n\t\t\tinterval: periodic,\r\n\t\t\tcancel: function() {\r\n\t\t\t\tif (this.interval) {\r\n\t\t\t\t\tclearInterval(r);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tclearTimeout(r);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n});","import $ from 'jquery';\r\n\r\n/**\r\n * jQuery.fields() plugin\r\n *\r\n * @param {string|undefined} fldvar - Field variable name or undefined\r\n *  If field variable name, returns jQuery object of the specified field element(s).\r\n *  If unspecified, returns object of jQuery objects of all fields.\r\n * @returns jQuery object\r\n */\r\n$.fn.fields = function(fldvar) { // Note: fldvar has NO \"x_\" prefix\r\n\tvar rec = {},\r\n\t\tid = this.attr(\"id\"),\r\n\t\tobj = this[0],\r\n\t\tm = id.match(/^[xy](\\d*)_/),\r\n\t\tf, tbl, infix;\r\n\tif (m) { // \"this\" is input element\r\n\t\tf = ew.getForm(obj); // form\r\n\t\ttbl = this.data(\"table\"); // table var\r\n\t\tinfix = m[1]; // row index\r\n\t} else if (obj && obj._form) { // \"this\" is form\r\n\t\tf = obj.$element; // form\r\n\t\ttbl = obj.id.replace(new RegExp(\"^f|\" + obj.pageId + \"$\", \"g\"), \"\"); // table var\r\n\t\tinfix = $(obj._form).data(\"rowindex\"); // row index\r\n\t}\r\n\tvar selector = \"[data-table=\" + tbl + \"][data-field\" + ((fldvar) ? \"=x_\" + fldvar : \"\") + \"]\";\r\n\tif ($.isValue(infix))\r\n\t\tselector += \"[name^=x\" + infix + \"_]\";\r\n\tif (f && selector) {\r\n\t\t$(f).find(selector).each(function() {\r\n\t\t\tvar key = this.getAttribute(\"data-field\").substr(2), name = this.getAttribute(\"name\");\r\n\t\t\tkey = (/^y_/.test(name)) ? \"y_\" + key : key; // Use \"y_fldvar\" as key for 2nd search input\r\n\t\t\trec[key] = (rec[key]) ? rec[key].add(this) : $(this); // Create jQuery object for each field\r\n\t\t});\r\n\t}\r\n\treturn (fldvar) ? rec[fldvar] : rec;\r\n};\r\n$.fn.extend({\r\n\t// Get jQuery object of the row (<div> or <tr>)\r\n\trow: function() {\r\n\t\tvar $row = this.closest(\"#r_\" + this.data(\"field\").substr(2));\r\n\t\tif (!$row[0])\r\n\t\t\t$row = this.closest(\".ew-table > tbody > tr\"); // Grid page\r\n\t\treturn $row;\r\n\t},\r\n\t// Show/Hide field\r\n\tvisible: function(v) {\r\n\t\tvar $el = this.closest(\"#r_\" + this.data(\"field\").substr(2)); // Find the row\r\n\t\tif (!$el[0]) // If not found, find the <span>\r\n\t\t\t$el = this.closest(\"[id^=el]\");\r\n\t\tif (typeof(v) != \"undefined\") {\r\n\t\t\t$el.toggle(v);\r\n\t\t\treturn this;\r\n\t\t} else {\r\n\t\t\treturn $el.is(\":visible\");\r\n\t\t}\r\n\t},\r\n\t// Get/Set field \"readonly\" attribute\r\n\t// Note: This attribute is ignored if the value of the type attribute is hidden, range, color, checkbox, radio, file, or a button type\r\n\treadonly: function(v) {\r\n\t\tif (typeof(v) != \"undefined\") {\r\n\t\t\tthis.prop(\"readOnly\", v);\r\n\t\t\treturn this;\r\n\t\t} else {\r\n\t\t\treturn this.prop(\"readOnly\");\r\n\t\t}\r\n\t},\r\n\t// Get/Set field \"disabled\" attribute\r\n\t// Note: A disabled control's value isn't submitted with the form\r\n\tdisabled: function(v) {\r\n\t\tif (typeof(v) != \"undefined\") {\r\n\t\t\tthis.prop(\"disabled\", v);\r\n\t\t\treturn this;\r\n\t\t} else {\r\n\t\t\treturn this.prop(\"disabled\");\r\n\t\t}\r\n\t},\r\n\t// Get/Set field value(s)\r\n\t// Note: Return array if select-multiple\r\n\tvalue: function(v) {\r\n\t\tvar type = this.attr(\"type\");\r\n\t\tif (typeof(v) != \"undefined\") {\r\n\t\t\tif (!$.isArray(v))\r\n\t\t\t\tv = [v];\r\n\t\t\tvar type = this.attr(\"type\");\r\n\t\t\tvar el = (type == \"radio\" || type == \"checkbox\") ? this.get() : this[0];\r\n\t\t\tif (ew.isHiddenTextArea(this))\r\n\t\t\t\tthis.val(v).data(\"editor\").save();\r\n\t\t\telse\r\n\t\t\t\tew.selectOption(el, v);\r\n\t\t\treturn this;\r\n\t\t} else {\r\n\t\t\tif (type == \"checkbox\") {\r\n\t\t\t\treturn ew.getOptionValues(this.get());\r\n\t\t\t} else if (type == \"radio\") {\r\n\t\t\t\treturn ew.getOptionValues(this.get()).join();\r\n\t\t\t} else if (ew.isHiddenTextArea(this)) {\r\n\t\t\t\tthis.data(\"editor\").save();\r\n\t\t\t\treturn this.val();\r\n\t\t\t} else {\r\n\t\t\t\treturn this.val();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t// Get field value as number\r\n\ttoNumber: function() {\r\n\t\treturn ew.parseNumber(this.value());\r\n\t},\r\n\t// Get field value as moment object\r\n\ttoDate: function() {\r\n\t\treturn ew.parseDate(this.value(), this.data(\"format\"));\r\n\t},\r\n\t// Get field value as native Date object\r\n\ttoJsDate: function() {\r\n\t\treturn ew.parseDate(this.value(), this.data(\"format\")).toDate();\r\n\t}\r\n});","import $ from 'jquery';\r\n\r\n// Init Treeview later\r\n$(window).off(\"load.lte.treeview\");\r\n\r\n// Treeview\r\nvar Treeview = adminlte.Treeview;\r\nTreeview.prototype._toggle = Treeview.prototype.toggle;\r\nTreeview.prototype.toggle = function toggle(event) {\r\n\tvar $relativeTarget = $(event.currentTarget), treeviewMenu = $relativeTarget.next(),\r\n\t\thref = $relativeTarget.attr(\"href\"), $text = $(event.target).closest(\".menu-item-text\");\r\n\tif (!treeviewMenu.is(\".nav-treeview\") || $text[0] && href && href != \"#\" && href != \"javascript:void(0);\") // Menu text with href\r\n\t\treturn;\r\n\tthis._toggle(event);\r\n};\r\n\r\n// Dropdown menu parent item with href // Override AdminLTE\r\n$(\"ul.dropdown-menu [data-toggle=dropdown]\").on(\"click\", function(e) {\r\n\tvar href = $(this).attr(\"href\");\r\n\tif (href && href != \"#\" && e.target.nodeName == \"SPAN\")\r\n\t\twindow.location = href;\r\n});"]}